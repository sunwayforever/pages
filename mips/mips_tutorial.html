<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-01-14 五 12:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mips Tutorial</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wei Sun (孙伟)" />
<link rel="stylesheet" type="text/css" href="../stylesheets/main.css" media="screen" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Mips Tutorial</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org878bbeb">1. Mips Tutorial</a>
<ul>
<li><a href="#org5cff41e">1.1. 指令格式</a></li>
<li><a href="#orgb1da028">1.2. 伪指令与 $at</a></li>
<li><a href="#org11f9625">1.3. 寄存器</a></li>
<li><a href="#org01b42c8">1.4. 函数调用</a>
<ul>
<li><a href="#org21e38c6">1.4.1. Overview</a></li>
<li><a href="#orge0de94a">1.4.2. a0, v0</a></li>
<li><a href="#org2d313c0">1.4.3. ra</a></li>
<li><a href="#org050a640">1.4.4. fp, sp</a></li>
<li><a href="#org4aeeb06">1.4.5. callee saved register</a></li>
</ul>
</li>
<li><a href="#org8b5f9b4">1.5. 汇编代码的基本结构</a></li>
<li><a href="#org68e89a3">1.6. 关于 gp</a></li>
<li><a href="#org49f8a9d">1.7. 关于 delay slot</a></li>
<li><a href="#orge1e6c67">1.8. 常用汇编指令</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org878bbeb" class="outline-2">
<h2 id="org878bbeb"><span class="section-number-2">1</span> Mips Tutorial</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://courses.cs.vt.edu/cs2506/Fall2014/">https://courses.cs.vt.edu/cs2506/Fall2014/</a>
<a href="http://ellard.org/dan/www/Courses/cs50-asm.pdf">http://ellard.org/dan/www/Courses/cs50-asm.pdf</a>
</p>
</div>

<div id="outline-container-org5cff41e" class="outline-3">
<h3 id="org5cff41e"><span class="section-number-3">1.1</span> 指令格式</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<a href="http://max.cs.kzoo.edu/cs230/Resources/MIPS/MachineXL/InstructionFormats.html">http://max.cs.kzoo.edu/cs230/Resources/MIPS/MachineXL/InstructionFormats.html</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">6bit</td>
<td class="org-left">5bit</td>
<td class="org-left">5bit</td>
<td class="org-left">5bit</td>
<td class="org-left">5bit</td>
<td class="org-left">6bit</td>
</tr>

<tr>
<td class="org-left">R(egister)</td>
<td class="org-left">op(0)</td>
<td class="org-left">reg</td>
<td class="org-left">reg</td>
<td class="org-left">dest</td>
<td class="org-left">shift</td>
<td class="org-left">funct</td>
</tr>

<tr>
<td class="org-left">I(mmediate)</td>
<td class="org-left">op</td>
<td class="org-left">reg</td>
<td class="org-left">reg</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
</tr>

<tr>
<td class="org-left">J(ump)</td>
<td class="org-left">op</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
<td class="org-left">constant</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>由于 reg 为 5 bit, 所以共支持 32 个寄存器</li>

<li><p>
R 类指令的 op 为 0, 但使用后 6 bit 标识不同的 R 指令, 例如, funct 为 32时为 add, funct 为 34 时为 sub
</p>

<p>
R 指令主要用于仅仅操作寄存器的算法运行 (shift 类指令例外, 它们可以使用一个额外的 5bit shift)
</p></li>

<li>J 指令使用 op 标识不同的指令, 例如 op 2 是 J 指令的 j, op 3 是 J 指令的 jal</li>

<li><p>
I 指令也使用 op 标识不同的指令, 例如 op 4 是 I 指令的 beq, op 5 是 I 指令的
bne
</p>

<p>
所有需要操作立即数的指令, 除了少数属于 jump 相关的指令 (j, jal.., 属于 J) 和
shift 相关的指令 (sll,sra&#x2026;, 属于 R), 其它的都属于 I, 主要是包括:
</p>

<ol class="org-ol">
<li>需要使用 address 的指令, b label, b offset(reg), lw, sw</li>

<li>一些直接操作立即数算术指令,如 addi</li>
</ol></li>

<li><p>
内存寻址
</p>

<p>
内存寻址主要用在 branch 和 load/store, MIPS 只有一种寻址方式:
offset($base_reg)
</p>

<p>
根据 offset 和 base_reg 的不同, 可以写成以下格式:
</p>

<ol class="org-ol">
<li>label, 例如 b hello (即 base_reg 为 $0)</li>

<li>const, 例如 lw $t1, 0x1234</li>

<li>const(reg), 例如 b 2($t1)</li>

<li>label+const(reg), 例如 lw $t1, hello+2($t2)</li>
</ol></li>
</ul>
</div>
</div>

<div id="outline-container-orgb1da028" class="outline-3">
<h3 id="orgb1da028"><span class="section-number-3">1.2</span> 伪指令与 $at</h3>
<div class="outline-text-3" id="text-1-2">
<p>
mips 的 assembler 提供了许多伪指令, 例如:
</p>

<ol class="org-ol">
<li>支持的指令数有限的情况下 (6 bit op 和 6 bit funct), 使用已有的指令完成新的功能, 方便使用.

<ul class="org-ul">
<li>sne, set not equal, 实际上可用 xor 来实现</li>

<li><p>
bge $t1, $t2, target =&gt; slt $at $t1 $t2; beqz $at target
</p>

<p>
在实现伪指令时, assembler 可以使用 $at 寄存器, 它是保留给 assembler 使用的
</p></li>
</ul></li>

<li>涉及 32bit 立即数的操作, 需要被分为多条指令, 因为这个立即数无法编码在一条指令中

<ul class="org-ul">
<li><p>
la, 由于一条指令无法表示 32bit 的数, 所以操作被分成两部分被赋值
</p>

<p>
la $t1, 0x4000d0 =&gt; lui $t1, 0x40; addiu $t1, $t1, 0xd0
</p></li>

<li><p>
lw
</p>

<p>
lw $t1, 0x004000f0 =&gt; lui	t1,0x40; lw	t1,240(t1)
</p></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org11f9625" class="outline-3">
<h3 id="org11f9625"><span class="section-number-3">1.3</span> 寄存器</h3>
<div class="outline-text-3" id="text-1-3">
<p>
mips 共 32 个通用寄存器, 使用 $0&#x2026;$31 表示, 同时也可以使用相应的别名, 表示约定的用法.
</p>

<ul class="org-ul">
<li>$0 的值固定为零</li>
<li>$t0..$t9, 用作临时变量</li>
<li>$s0..$s7, 用作 callee saved register</li>
<li>$a0..$a3, 函数调用时传递前四个参数</li>
<li>$v0, $v1, 函数返回值</li>
<li>$at, assembler 实现伪指令时使用</li>
<li>$sp, $fp</li>
<li>$gp, 引用 .sdata section 的变量时使用</li>
<li>$ra, return address, ral 跳转时会把返回地址保存在 $ra 再跳转</li>
</ul>
</div>
</div>

<div id="outline-container-org01b42c8" class="outline-3">
<h3 id="org01b42c8"><span class="section-number-3">1.4</span> 函数调用</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org21e38c6" class="outline-4">
<h4 id="org21e38c6"><span class="section-number-4">1.4.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-4-1">
<div class="org-src-container">
<pre class="src src-mips"><span style="color: #268bd2;">fib:</span>
    <span style="color: #586e75;"># &#20445;&#23384;&#19978;&#19979;&#25991;</span>
    <span style="color: #859900;">sub</span>     <span style="color: #b58900;">$sp</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">32</span>
    <span style="color: #859900;">sw</span>      <span style="color: #b58900;">$ra</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">28</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">sw</span>      <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">24</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">sw</span>      <span style="color: #b58900;">$s2</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">20</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #586e75;"># &#20351;&#29992; callee saved register</span>
    <span style="color: #586e75;"># a0 &#20445;&#23384;&#30528;&#21442;&#25968;</span>
    <span style="color: #859900;">move</span>    <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$a0</span>
    <span style="color: #859900;">blt</span>     <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">2</span><span style="color: #757575;">,</span> fib_base

    <span style="color: #859900;">sub</span>     <span style="color: #b58900;">$a0</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">1</span>
    <span style="color: #859900;">bal</span>     fib
    <span style="color: #586e75;"># v0 &#20445;&#23384;&#30528;&#36820;&#22238;&#20540;</span>
    <span style="color: #859900;">move</span>    <span style="color: #b58900;">$s2</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$v0</span>

    <span style="color: #859900;">sub</span>     <span style="color: #b58900;">$a0</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">2</span>
    <span style="color: #859900;">bal</span>     fib
    <span style="color: #859900;">add</span>     <span style="color: #b58900;">$v0</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$s2</span>
    <span style="color: #859900;">b</span>       fib_return

<span style="color: #268bd2;">fib_base:</span>
    <span style="color: #859900;">li</span>      <span style="color: #b58900;">$v0</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">1</span>

<span style="color: #268bd2;">fib_return:</span>
    <span style="color: #586e75;"># &#24674;&#22797;&#19978;&#19979;&#25991;</span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$ra</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">28</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$s1</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">24</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$s2</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">20</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">add</span>     <span style="color: #b58900;">$sp</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">32</span>
    <span style="color: #586e75;"># &#20989;&#25968;&#36820;&#22238;</span>
    <span style="color: #859900;">jr</span>      <span style="color: #b58900;">$ra</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orge0de94a" class="outline-4">
<h4 id="orge0de94a"><span class="section-number-4">1.4.2</span> a0, v0</h4>
<div class="outline-text-4" id="text-1-4-2">
<ul class="org-ul">
<li>a0..a3 保存前四个参数</li>
<li>v0,v1 保存返回值</li>
</ul>
</div>
</div>

<div id="outline-container-org2d313c0" class="outline-4">
<h4 id="org2d313c0"><span class="section-number-4">1.4.3</span> ra</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
bal func 时, 返回地址被赋值给 ra, callee 通过 br $ra 返回
</p>

<p>
需要注意的是返回地址为 pc + 8 (而不是 pc + 4), 例如:
</p>

<pre class="example" id="org955577c">
__start:
    bal hello
    addi $t1, 1
    addi $t2, 2
hello:
    addi $t1, 1

##############
(gdb) disass
Dump of assembler code for function _ftext:
=&gt; 0x004000d0 &lt;+0&gt;:	bal	0x4000e0 &lt;hello&gt;
   0x004000d4 &lt;+4&gt;:	nop
   0x004000d8 &lt;+8&gt;:	addi	t1,t1,1
   0x004000dc &lt;+12&gt;:	addi	t2,t2,2
End of assembler dump.
(gdb) ni
6	    addi $t1, 1
(gdb) p /x $ra
$2 = 0x4000d8
</pre>

<p>
$ra 跳转后赋值为 d8, 而非 d4, 同时代码 bal 之后被 assembler 插入一条 nop
</p>

<p>
这么做的原因是 delay slot <a href="https://en.wikipedia.org/wiki/Delay_slot">https://en.wikipedia.org/wiki/Delay_slot</a>
</p>

<p>
assembler 可以通过调整指令的顺序避免生成一个无用的 nop:
</p>

<pre class="example" id="org337080c">
__start:
    move    $t1, $t2
    move    $t2, $t3
    bal     hello
    addi    $t2, 2
hello:
    addi    $t1, 1
####################
(gdb) disass
=&gt; 0x004000d0 &lt;+0&gt;:	move	t1,t2
   0x004000d4 &lt;+4&gt;:	bal	0x4000e0 &lt;hello&gt;
   0x004000d8 &lt;+8&gt;:	move	t2,t3
   0x004000dc &lt;+12&gt;:	addi	t2,t2,2
End of assembler dump.
</pre>

<p>
第二条 move 被放在 bal 之后做为 delay slot, 但执行起来与原来的顺序是一致的
</p>

<p>
ps. 实践中发现, 在编译时使用了 -g 参数后会禁止 assembler 的这个行为
</p>
</div>
</div>

<div id="outline-container-org050a640" class="outline-4">
<h4 id="org050a640"><span class="section-number-4">1.4.4</span> fp, sp</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
fp 主要作用:
</p>

<ol class="org-ol">
<li>保存上一下 frame 的 sp (或者叫当前 frame 的基址)</li>
<li>做为基址访问当前 frame 的数据</li>
<li>debugger 可以通过 fp 快速的进行 backtrack</li>
</ol>

<p>
对于 1/2, 若 stack frame 大小在编译时是确定的, 则不需要 fp, 直接使用 sp 也可以恢复上一个 frame 以及通过 sp 访问当前 frame 的数据, 如 Overview 中的例子所示
</p>

<p>
对于 3, 使用 DWARF 也可以代替 fp 的作用
</p>

<p>
所以必须使用 fp 的场合可能只有一种: 使用了 alloca 调用的代码, 在编译时无法确定
stack frame 的大小
</p>
</div>
</div>

<div id="outline-container-org4aeeb06" class="outline-4">
<h4 id="org4aeeb06"><span class="section-number-4">1.4.5</span> callee saved register</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
s0..s7 是 callee saved register:
</p>

<ul class="org-ul">
<li>caller 可以自由使用这个寄存器, 不需要担心被其它函数覆盖</li>
<li>callee 需要负责保存和恢复它们</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org8b5f9b4" class="outline-3">
<h3 id="org8b5f9b4"><span class="section-number-3">1.5</span> 汇编代码的基本结构</h3>
<div class="outline-text-3" id="text-1-5">
<div class="org-src-container">
<pre class="src src-mips">    <span style="color: #268bd2;">.text</span>
    .global __start

<span style="color: #268bd2;">__start:</span>
    <span style="color: #859900;">la</span>      <span style="color: #b58900;">$gp</span><span style="color: #757575;">,</span> _gp

    <span style="color: #859900;">la</span>      <span style="color: #b58900;">$a0</span><span style="color: #757575;">,</span> a
    <span style="color: #859900;">bal</span>     hello
    <span style="color: #859900;">move</span>    <span style="color: #b58900;">$t1</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$v0</span>

<span style="color: #268bd2;">hello:</span>
    <span style="color: #859900;">sub</span>     <span style="color: #b58900;">$sp</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">32</span>
    <span style="color: #859900;">sw</span>      <span style="color: #b58900;">$ra</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">28</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>

    <span style="color: #859900;">li</span>      <span style="color: #b58900;">$v0</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">1</span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$ra</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">28</span><span style="color: #757575;">(</span><span style="color: #b58900;">$sp</span><span style="color: #757575;">)</span>
    <span style="color: #859900;">add</span>     <span style="color: #b58900;">$sp</span><span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">32</span>
    <span style="color: #859900;">jr</span>      <span style="color: #b58900;">$ra</span>

    <span style="color: #268bd2;">.data</span>
<span style="color: #268bd2;">a:</span>  <span style="color: #268bd2;">.ascii</span>  <span style="color: #2aa198;">"hello"</span>
<span style="color: #268bd2;">b:</span>  <span style="color: #268bd2;">.asciiz</span> <span style="color: #2aa198;">"hello"</span>
<span style="color: #268bd2;">c:</span>  <span style="color: #268bd2;">.word</span>   0xf0f0f0f0
<span style="color: #268bd2;">d:</span>  <span style="color: #268bd2;">.byte</span>   0xf0
    <span style="color: #268bd2;">.byte</span>   0xf0
    <span style="color: #268bd2;">.byte</span>   0xf0
    <span style="color: #268bd2;">.byte</span>   0xf0

    .sdata
<span style="color: #268bd2;">sa:</span> <span style="color: #268bd2;">.word</span>   0x1234
</pre>
</div>
</div>
</div>

<div id="outline-container-org68e89a3" class="outline-3">
<h3 id="org68e89a3"><span class="section-number-3">1.6</span> 关于 gp</h3>
<div class="outline-text-3" id="text-1-6">
<p>
gp 用来指示 .sdata 的基址, assembler 针对 .sdata 中数据的访问会生成以 gp 为基址的指令, 例如:
</p>

<div class="org-src-container">
<pre class="src src-mips"><span style="color: #268bd2;">__start:</span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$t1</span><span style="color: #757575;">,</span> a
    .sdata
<span style="color: #268bd2;">a:</span>  <span style="color: #268bd2;">.word</span>   <span style="color: #268bd2; font-weight: bold;">1</span>
<span style="color: #586e75;">##################</span>
<span style="color: #757575;">(</span>gdg<span style="color: #757575;">)</span> disass  
Dump    of assembler code for function <span style="color: #268bd2;">_ftext:</span>
<span style="color: #839496;">=&gt;</span> 0x004000f0 &lt;+0&gt;<span style="color: #268bd2;">:</span> <span style="color: #859900;">lw</span>  t1<span style="color: #757575;">,</span><span style="color: #268bd2; font-weight: bold;">-32752</span><span style="color: #757575;">(</span>gp<span style="color: #757575;">)</span>
   0x004000f4 &lt;+4&gt;<span style="color: #268bd2;">:</span> <span style="color: #859900;">nop</span>
   0x004000f8 &lt;+8&gt;<span style="color: #268bd2;">:</span> <span style="color: #859900;">nop</span>
   0x004000fc &lt;+12&gt;<span style="color: #268bd2;">:</span>    <span style="color: #859900;">nop</span>
</pre>
</div>

<p>
ld 会负责分配 .sdata 并用 _gp 这个符号指向它的基址.
</p>

<pre class="example" id="org6201f6c">
(gdb) p &amp;_gp
$1 = (&lt;data variable, no debug info&gt; *) 0x418120
</pre>

<p>
所以 asm 需要自己用 la $gp, _gp 来初始化 gp.
</p>

<p>
使用 gp 可以加快访存指令的速度, 因为普通的 lw 伪指令需要两条指令:
</p>

<ol class="org-ol">
<li>lui $t1, &lt;high&gt;</li>
<li>lw  $t1, &lt;low&gt;($t1)</li>
</ol>

<p>
而使用 gp 只需要一条指令: lw $t1, &lt;addr&gt;($gp), 限制是只能访问 gp 为基址的 64K 地址
</p>
</div>
</div>

<div id="outline-container-org49f8a9d" class="outline-3">
<h3 id="org49f8a9d"><span class="section-number-3">1.7</span> 关于 delay slot</h3>
<div class="outline-text-3" id="text-1-7">
<p>
函数函数时的 bal 需要 delay slot, 实际上, 凡是导致流水线不能持续的指令都需要
delay slot, 比如:
</p>

<ul class="org-ul">
<li><p>
访问内存无法在一个周期内返回结果
</p>

<div class="org-src-container">
<pre class="src src-mips"><span style="color: #586e75;"># &#21407;&#25351;&#20196; </span>
    <span style="color: #859900;">lw</span>      <span style="color: #b58900;">$t1</span><span style="color: #757575;">,</span> __start
    <span style="color: #859900;">move</span>    <span style="color: #b58900;">$t2</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$t1</span>
<span style="color: #586e75;"># &#23454;&#38469;&#25351;&#20196; </span>
    <span style="color: #859900;">lui</span>     t1<span style="color: #757575;">,</span>0x40
    <span style="color: #859900;">lw</span>      t1<span style="color: #757575;">,</span><span style="color: #268bd2; font-weight: bold;">240</span><span style="color: #757575;">(</span>t1<span style="color: #757575;">)</span>
    <span style="color: #859900;">nop</span>
    <span style="color: #859900;">move</span>    t2<span style="color: #757575;">,</span>t1
</pre>
</div></li>

<li><p>
mul 无法在一个周期内返回结果
</p>

<div class="org-src-container">
<pre class="src src-mips"><span style="color: #586e75;"># &#21407;&#25351;&#20196;</span>
    <span style="color: #859900;">mul</span>     <span style="color: #b58900;">$t1</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$t2</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$t3</span>
    <span style="color: #859900;">move</span>    <span style="color: #b58900;">$t2</span><span style="color: #757575;">,</span> <span style="color: #b58900;">$t1</span>
<span style="color: #586e75;"># &#23454;&#38469;&#25351;&#20196;</span>
    <span style="color: #859900;">multu</span>   t2<span style="color: #757575;">,</span>t3
    <span style="color: #859900;">mflo</span>    t1
    <span style="color: #859900;">nop</span>
    <span style="color: #859900;">nop</span>
    <span style="color: #859900;">move</span>    t2<span style="color: #757575;">,</span>t1    
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-orge1e6c67" class="outline-3">
<h3 id="orge1e6c67"><span class="section-number-3">1.8</span> 常用汇编指令</h3>
<div class="outline-text-3" id="text-1-8">
<ul class="org-ul">
<li>li</li>
<li>la</li>
<li>move</li>
<li>b</li>
<li>j</li>
<li>bal</li>
<li>jr</li>
<li>lw</li>
<li>sw</li>
<li>bgt</li>
<li>sgt</li>
<li>add</li>
<li>sub</li>
<li>mul</li>
<li>div</li>
<li>syscall</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
         var d = document, s = d.createElement('script');
         s.src = '//sunwayforever-github-io.disqus.com/embed.js';
         s.setAttribute('data-timestamp', +new Date());
         (d.head || d.body).appendChild(s);
         })();
</script>
</div>
</body>
</html>
