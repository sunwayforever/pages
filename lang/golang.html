<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-01-25 二 15:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Golang</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wei Sun (孙伟)" />
<link rel="stylesheet" type="text/css" href="/main.css" media="screen" />
<link rel = "icon" href = "/icon.png"  type = "image/x-icon">
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Golang</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9495a23">1. Golang</a>
<ul>
<li><a href="#org543b19d">1.1. 风格</a></li>
<li><a href="#orga7c910a">1.2. 变量</a></li>
<li><a href="#org4f78dbf">1.3. 表达式</a></li>
<li><a href="#orgfe34998">1.4. 函数</a></li>
<li><a href="#org3cb008f">1.5. 输入输出</a></li>
<li><a href="#orgfeec52b">1.6. 类型及转换</a></li>
<li><a href="#org678f0e9">1.7. 分配与释放</a></li>
<li><a href="#orgc9d38aa">1.8. string</a></li>
<li><a href="#org2a0becc">1.9. array 与 slice</a></li>
<li><a href="#orgb106b5b">1.10. map</a></li>
<li><a href="#orgcd0a408">1.11. 抽象数据类型</a></li>
<li><a href="#orgac13cca">1.12. 泛型</a></li>
<li><a href="#org03b7363">1.13. 控制结构</a></li>
<li><a href="#orgc7220e6">1.14. 排序</a></li>
<li><a href="#org21178a8">1.15. 最大堆</a></li>
<li><a href="#orgf1ec9a2">1.16. math</a></li>
<li><a href="#org8847373">1.17. random</a></li>
<li><a href="#orga1f334b">1.18. package</a></li>
<li><a href="#org1d6bb2d">1.19. 坑</a></li>
<li><a href="#orgc14de37">1.20. channel</a></li>
<li><a href="#org8f546c5">1.21. misc</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org9495a23" class="outline-2">
<h2 id="org9495a23"><span class="section-number-2">1</span> Golang</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org543b19d" class="outline-3">
<h3 id="org543b19d"><span class="section-number-3">1.1</span> 风格</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> helloworld

<span style="color: #859900;">type</span> <span style="color: #b58900;">HelloWorld</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
    privMem   <span style="color: #b58900;">int</span>
    PubMember <span style="color: #b58900;">int</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">this</span> <span style="color: #b58900;">HelloWorld</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">PubMethod</span><span style="color: #757575;">()</span>  <span style="color: #757575;">{}</span>
<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">this</span> <span style="color: #b58900;">HelloWorld</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">privMethod</span><span style="color: #757575;">()</span> <span style="color: #757575;">{}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">helloWorld</span> := <span style="color: #b58900;">HelloWorld</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga7c910a" class="outline-3">
<h3 id="orga7c910a"><span class="section-number-3">1.2</span> 变量</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>var x int</li>
<li>var x int = 10</li>
<li>x := 10</li>
<li>可以通过 var x int = 10 定义全局变量</li>
<li>const x = 10</li>
</ul>
</div>
</div>

<div id="outline-container-org4f78dbf" class="outline-3">
<h3 id="org4f78dbf"><span class="section-number-3">1.3</span> 表达式</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>bitwise
<ul class="org-ul">
<li>and &amp;</li>
<li>or |</li>
<li>not ^</li>
<li>xor ^</li>
<li>shift &lt;&lt;, &gt;&gt;, 其中 &gt;&gt; 和 c 一样区分算法与逻辑右移</li>
</ul></li>
<li>支持 +=, &amp;=, &gt;&gt;=,&#x2026;</li>
<li>支持 ++, &#x2013;,  是 stmt 而不是 expression</li>
<li>!expression</li>
<li>支持 a,b = b,a</li>
<li>if 与 switch 支持 initialization stmt: if x:=1+2; x&gt;3 {}</li>
<li>条件判断必须值为 bool 的表达式, if x:=1; x {} 不合法</li>
</ul>
</div>
</div>

<div id="outline-container-orgfe34998" class="outline-3">
<h3 id="orgfe34998"><span class="section-number-3">1.4</span> 函数</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>不支持 overloading</li>
<li>不支持默认参数</li>
<li>支持多个函数值</li>
<li>支持变长参数, 实际就是一个 slice</li>
</ul>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main
<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">echo</span> <span style="color: #757575;">(</span>i1<span style="color: #757575;">,</span> i2 <span style="color: #b58900;">int</span><span style="color: #757575;">,</span> i3 <span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #757575;">(</span><span style="color: #b58900;">int</span><span style="color: #757575;">,</span> <span style="color: #b58900;">int</span><span style="color: #757575;">,</span> <span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> i1<span style="color: #757575;">,</span> i2<span style="color: #757575;">,</span> i3
<span style="color: #757575;">}</span>

<span style="color: #586e75;">// </span><span style="color: #586e75;">&#21464;&#38271;&#21442;&#25968;</span>
<span style="color: #859900;">func</span> <span style="color: #268bd2;">echo2</span><span style="color: #757575;">(</span><span style="color: #268bd2;">x</span> ...<span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> x
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span> <span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #268bd2;">echo</span><span style="color: #757575;">(</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">))</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #268bd2;">echo2</span><span style="color: #757575;">(</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">))</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
1 2 3
[1 2 3]
</pre>
</div>
</div>

<div id="outline-container-org3cb008f" class="outline-3">
<h3 id="org3cb008f"><span class="section-number-3">1.5</span> 输入输出</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>fmt.Println</li>
<li>fmt.Printf</li>
<li>fmt.Scanln</li>
<li>fmt.Scanf</li>
</ul>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"%d,%s"</span><span style="color: #757575;">,</span> 1<span style="color: #757575;">,</span> <span style="color: #2aa198;">"abc"</span><span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">,</span> <span style="color: #2aa198;">"ab"</span><span style="color: #757575;">)</span>

    <span style="color: #268bd2;">i</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">j</span> := 0<span style="color: #757575;">,</span> 0
    <span style="color: #586e75;">// </span><span style="color: #586e75;">stdin &#20026; 1 2</span>
    fmt.<span style="color: #268bd2;">Scanln</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"%d %d"</span><span style="color: #757575;">,</span> &amp;i<span style="color: #757575;">,</span> &amp;j<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>i<span style="color: #757575;">,</span> j<span style="color: #757575;">)</span>           <span style="color: #586e75;">// </span><span style="color: #586e75;">1 2</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">stdin &#20026; 1 2\n3 4</span>
    <span style="color: #268bd2;">x</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">y</span> := 0<span style="color: #757575;">,</span> 0
    fmt.<span style="color: #268bd2;">Scanf</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"%d %d\n%d %d"</span><span style="color: #757575;">,</span> &amp;i<span style="color: #757575;">,</span> &amp;j<span style="color: #757575;">,</span> &amp;x<span style="color: #757575;">,</span> &amp;y<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>i<span style="color: #757575;">,</span> j<span style="color: #757575;">,</span> x<span style="color: #757575;">,</span> y<span style="color: #757575;">)</span>     <span style="color: #586e75;">// </span><span style="color: #586e75;">1 2 3 4</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfeec52b" class="outline-3">
<h3 id="orgfeec52b"><span class="section-number-3">1.6</span> 类型及转换</h3>
<div class="outline-text-3" id="text-1-6">
<ol class="org-ol">
<li>基本类型
<ul class="org-ul">
<li>int, int32, int64, int8, float32, float64</li>
<li>uint, uint32, uint64</li>
<li>bool</li>
<li>rune (即 int32), byte (即 int8)</li>
</ul></li>

<li>复杂类型
<ul class="org-ul">
<li>string</li>
<li>array</li>
<li>slice</li>
<li>map</li>
<li>不支持 tuple</li>
<li>interface{}</li>
</ul></li>
</ol>

<p>
其中 slice 与 map 是仅有的两种指针类型:
</p>

<ol class="org-ol">
<li>可以与 nil 比较</li>
<li>做为参数或返回值时自动使用的传引用的语义</li>
<li>作为 struct 成员时需要显示的分配, 否则成员为 nil</li>
</ol>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">x</span> <span style="color: #b58900;">int</span> = 1
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">y</span> <span style="color: #b58900;">int32</span> = 1
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">z</span> <span style="color: #b58900;">int64</span> = 1
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">a</span> <span style="color: #b58900;">byte</span> = <span style="color: #2aa198;">'a'</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">s</span> <span style="color: #b58900;">string</span> = <span style="color: #2aa198;">"abc"</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">z</span> <span style="color: #b58900;">rune</span> = <span style="color: #2aa198;">'a'</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">rune &#21363; int32, byte &#21363; int8, &#20851;&#20110; byte, rune, string, &#21442;&#32771; golang::string</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">b</span> <span style="color: #b58900;">bool</span> = <span style="color: #268bd2; font-weight: bold;">true</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">f</span> <span style="color: #b58900;">float32</span> = 1.0
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">d</span> <span style="color: #b58900;">float64</span> = 1.0
    x = <span style="color: #268bd2;">int</span><span style="color: #757575;">(</span>d<span style="color: #757575;">)</span>
    d = <span style="color: #268bd2;">float64</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org678f0e9" class="outline-3">
<h3 id="org678f0e9"><span class="section-number-3">1.7</span> 分配与释放</h3>
<div class="outline-text-3" id="text-1-7">
<ol class="org-ol">
<li>golang 并不存在`返回局部变量的引用`这种问题, 编译器会根据逃逸分析的结果确定是否需要分配在堆上</li>
<li>可以显式的通过 new 要求分配在堆上</li>
<li>对于指针类型: slice 和 map, 可以通过 make 以`空值`初始化</li>
<li>chan 只能通过 make 初始化</li>
<li>go 有 gc, 不需要手动释放</li>
</ol>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">type</span> <span style="color: #b58900;">Test</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
    a <span style="color: #b58900;">int</span>
    b <span style="color: #b58900;">int</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">getTest</span><span style="color: #757575;">()</span> *<span style="color: #b58900;">Test</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> &amp;<span style="color: #b58900;">Test</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">getTest2</span><span style="color: #757575;">()</span> *<span style="color: #b58900;">Test</span> <span style="color: #757575;">{</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#19981;&#25903;&#25345; new (Test{1,2}) &#36825;&#31181;&#20889;&#27861;</span>
    <span style="color: #268bd2;">t</span> := <span style="color: #839496;">new</span><span style="color: #757575;">(</span><span style="color: #b58900;">Test</span><span style="color: #757575;">)</span>
    t.a = 1
    t.b = 2
    <span style="color: #859900;">return</span> t
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">t</span> := <span style="color: #268bd2;">getTest</span><span style="color: #757575;">()</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>*t<span style="color: #757575;">)</span>
    t = <span style="color: #268bd2;">getTest2</span><span style="color: #757575;">()</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>*t<span style="color: #757575;">)</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">map init with make</span>
    <span style="color: #268bd2;">m</span> := <span style="color: #839496;">make</span><span style="color: #757575;">(</span><span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">int</span><span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>m == <span style="color: #268bd2; font-weight: bold;">nil</span><span style="color: #757575;">)</span>

    <span style="color: #859900;">var</span> <span style="color: #268bd2;">m2</span> <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">int</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>m2 == <span style="color: #268bd2; font-weight: bold;">nil</span><span style="color: #757575;">)</span>

    <span style="color: #268bd2;">m3</span> := <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">int</span><span style="color: #757575;">{}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>m3 == <span style="color: #268bd2; font-weight: bold;">nil</span><span style="color: #757575;">)</span>

    <span style="color: #859900;">var</span> <span style="color: #268bd2;">x</span> <span style="color: #b58900;">int</span>
    <span style="color: #268bd2;">x2</span> := 0
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>x == x2<span style="color: #757575;">)</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">slice init with make</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">make slice &#26159;&#21487;&#20197;&#25351;&#23450;&#19968;&#20010;&#38271;&#24230;</span>
    <span style="color: #268bd2;">s</span> := <span style="color: #839496;">make</span><span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">,</span> 5<span style="color: #757575;">)</span>
    <span style="color: #268bd2;">s2</span> := []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>0<span style="color: #757575;">,</span> 0<span style="color: #757575;">,</span> 0<span style="color: #757575;">,</span> 0<span style="color: #757575;">,</span> 0<span style="color: #757575;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>s<span style="color: #757575;">,</span> s2<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9d38aa" class="outline-3">
<h3 id="orgc9d38aa"><span class="section-number-3">1.8</span> string</h3>
<div class="outline-text-3" id="text-1-8">
<ul class="org-ul">
<li>string 不可变</li>
<li>可以通过 []rune(s) 把 s 变为 rune slice, 以及通过 string([]rune{}) 转换回 string</li>
<li>for k,v :=range (str) 返回的 v 类型是 rune, 即 utf16 编码</li>
<li>str[i] 返回的数据为 byte</li>
<li>len 返回长度</li>
<li>支持 "a"+"b"</li>
<li>支持像 slice 的 s[i:j] 操作</li>
<li>string 不是指针类型, 无法与 nil 比较</li>
<li>strings 库相关的函数
<ul class="org-ul">
<li>HasPrefix, HasSurfix</li>
<li>Split, Join</li>
<li>Replace</li>
<li>Repeat</li>
<li>Contains</li>
<li>Index, LastIndex</li>
</ul></li>
<li>strconv 库的 Atoi, Itoa</li>
</ul>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main
<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">s</span> := <span style="color: #2aa198;">"abc"</span>
    s += <span style="color: #2aa198;">"def"</span>
    <span style="color: #268bd2;">x</span> := <span style="color: #839496;">len</span><span style="color: #757575;">(</span>s<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
    s += <span style="color: #2aa198;">"&#22823;&#23478;&#22909;"</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">_</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">v</span> := <span style="color: #859900;">range</span> s <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Print</span><span style="color: #757575;">(</span>v<span style="color: #757575;">,</span><span style="color: #2aa198;">" "</span><span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">()</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">i</span> := 0; i &lt; <span style="color: #839496;">len</span><span style="color: #757575;">(</span>s<span style="color: #757575;">)</span>; i++ <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Print</span><span style="color: #757575;">(</span>s[i]<span style="color: #757575;">,</span><span style="color: #2aa198;">" "</span><span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">()</span>
    <span style="color: #268bd2;">v</span> := []<span style="color: #268bd2;">rune</span><span style="color: #757575;">(</span>s<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>v<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #268bd2;">string</span><span style="color: #757575;">(</span>v<span style="color: #757575;">))</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<p>
6
97 98 99 100 101 102 22823 23478 22909 
97 98 99 100 101 102 229 164 167 229 174 182 229 165 189 
[97 98 99 100 101 102 22823 23478 22909]
abcdef大家好
</p>
</div>
</div>

<div id="outline-container-org2a0becc" class="outline-3">
<h3 id="org2a0becc"><span class="section-number-3">1.9</span> array 与 slice</h3>
<div class="outline-text-3" id="text-1-9">
<ol class="org-ol">
<li>与 map 一样, slice 是一个指针, 如果是结构体成员, 需要显式的给它分配空间, 但 array 不需要</li>
<li>[3]int 与 [2]int 并不是相同的 array 类型</li>
<li>array 可以直接比较大小, 例如 [2]int{1,2} == [2]int{1,2} 为 true, 所以 array 可以做为 map 的 key, 但 slice 并不可以</li>
<li>大部分情况下 slice 用的更频繁</li>
<li>需要使用 make 来生成特定大小的 slice</li>
<li>多维的 slice, x:=make([][]int,m); for i:=0;i&lt;m;i++ {x[i]=make([]int,n)}</li>
<li>copy 可以用来复制 slice</li>
</ol>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">x</span> := [2]<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">}</span>           <span style="color: #586e75;">// </span><span style="color: #586e75;">x &#26159;&#19968;&#20010; array</span>
    <span style="color: #268bd2;">y</span> := []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">}</span>            <span style="color: #586e75;">// </span><span style="color: #586e75;">y &#26159;&#19968;&#20010; slice</span>
    <span style="color: #268bd2;">z</span> := x[:]                   <span style="color: #586e75;">// </span><span style="color: #586e75;">array &#36716;&#25442;&#20026; slice</span>
    <span style="color: #268bd2;">k</span> := [2]<span style="color: #b58900;">int</span><span style="color: #757575;">{}</span>
    <span style="color: #839496;">copy</span><span style="color: #757575;">(</span>k<span style="color: #757575;">,</span> z<span style="color: #757575;">)</span>                  <span style="color: #586e75;">// </span><span style="color: #586e75;">slice &#36716;&#25442;&#20026; array</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#20351;&#29992; copy &#26469;&#22797;&#21046; slice</span>
    <span style="color: #268bd2;">f</span> := []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">}</span>
    <span style="color: #268bd2;">t</span> := <span style="color: #839496;">make</span><span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">,</span> 2<span style="color: #757575;">)</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">t &#21464;&#20026; []int{1,2}, f &#30340;&#21069;&#20004;&#20010;&#20803;&#32032;&#34987;&#22797;&#21046;</span>
    <span style="color: #839496;">copy</span><span style="color: #757575;">(</span>t<span style="color: #757575;">,</span> f<span style="color: #757575;">)</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#20351;&#29992; append &#26469;&#22797;&#21046; slice</span>
    <span style="color: #268bd2;">t2</span> := <span style="color: #839496;">append</span><span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">{},</span> f...<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<p>
slice 最常用的操作:
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">append</span>
    <span style="color: #268bd2;">x</span> := []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">}</span>
    x = <span style="color: #839496;">append</span><span style="color: #757575;">(</span>x<span style="color: #757575;">,</span> 4<span style="color: #757575;">,</span> 5<span style="color: #757575;">)</span>
    x = <span style="color: #839496;">append</span><span style="color: #757575;">(</span>x<span style="color: #757575;">,</span> []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>6<span style="color: #757575;">,</span> 7<span style="color: #757575;">,</span> 8<span style="color: #757575;">}</span>...<span style="color: #757575;">)</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">slice</span>
    x = x[1:2]
    <span style="color: #586e75;">// </span><span style="color: #586e75;">remove</span>
    x = x[:<span style="color: #839496;">len</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span> - 1]          <span style="color: #586e75;">// </span><span style="color: #586e75;">&#27169;&#25311; stack &#30340; pop &#25805;&#20316;</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">len</span>
    <span style="color: #268bd2;">l</span> := <span style="color: #839496;">len</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">range</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">_</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">v</span> := <span style="color: #859900;">range</span> x <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>v<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">make</span>
    <span style="color: #268bd2;">y</span> := <span style="color: #839496;">make</span><span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">,</span> 10<span style="color: #757575;">)</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">10x5 &#30340;&#20108;&#32500; slice</span>
    <span style="color: #268bd2;">v</span> := <span style="color: #839496;">make</span><span style="color: #757575;">(</span>[][]<span style="color: #b58900;">int</span><span style="color: #757575;">,</span> 10<span style="color: #757575;">)</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">i</span> := 0; i &lt; 10; i++ <span style="color: #757575;">{</span>
        v[i] = <span style="color: #839496;">make</span><span style="color: #757575;">(</span>[]<span style="color: #b58900;">int</span><span style="color: #757575;">,</span> 5<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb106b5b" class="outline-3">
<h3 id="orgb106b5b"><span class="section-number-3">1.10</span> map</h3>
<div class="outline-text-3" id="text-1-10">
<ul class="org-ul">
<li>map 与 slice 一样是指针类型</li>
<li>对 map 中不存在的项取值时会返回默认值 (0, "", nil 等), 如果要确定
entry 是否存在, 需要使用 x, exist:=m[key] 后判断 exist 是否为 true</li>
<li>有一个 delete 关键字,只用来删除 map key</li>
<li>map 不支持 keys(), values(), items() 等方法</li>
<li>slice, map 无法做为 key, 其它基本类型例如 bool, int, [2]int, string, pointer,
channel 都可作为 key, 而且只包含这些类型的结构也可以作为 key</li>
<li>struct 无法通过定义类似 `eq` 来做为 key</li>
</ul>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">m</span> := <span style="color: #859900;">map</span>[<span style="color: #b58900;">string</span>]<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>
        <span style="color: #2aa198;">"abc"</span>: 1<span style="color: #757575;">,</span>
        <span style="color: #2aa198;">"bcd"</span>: 2<span style="color: #757575;">,</span>
    <span style="color: #757575;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>m[<span style="color: #2aa198;">"abc"</span>]<span style="color: #757575;">)</span>
    <span style="color: #859900;">if</span> <span style="color: #268bd2;">t</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">ok</span> := m[<span style="color: #2aa198;">"xxx"</span>]; ok <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>t<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    m[<span style="color: #2aa198;">"abc"</span>] = 3
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">k</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">v</span> := <span style="color: #859900;">range</span> m <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>k<span style="color: #757575;">,</span> v<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #839496;">delete</span><span style="color: #757575;">(</span>m<span style="color: #757575;">,</span> <span style="color: #2aa198;">"abc"</span><span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>m<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
1
abc 3
bcd 2
map[bcd:2]
</pre>
</div>
</div>

<div id="outline-container-orgcd0a408" class="outline-3">
<h3 id="orgcd0a408"><span class="section-number-3">1.11</span> 抽象数据类型</h3>
<div class="outline-text-3" id="text-1-11">
<ul class="org-ul">
<li>type xxx struct {}</li>
<li>struct 中的指针类型需要初始化</li>
<li>没有构造函数, 可以自己提供一个 NewXXX 函数</li>
<li>struct 中只有首字母大写的成员可以被其它 package 访问</li>
<li>struct 不支持继承, 没有成员函数, 相关的功能通过给 func 添加 receiver
完成</li>
<li>若函数需要修改 receiver, 需要提供指针类型作为 receiver</li>
</ul>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">type</span> <span style="color: #b58900;">Pair</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
    x <span style="color: #b58900;">int</span>
    y <span style="color: #b58900;">int</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">p</span> <span style="color: #b58900;">Pair</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Dump</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>p.x<span style="color: #757575;">,</span> p.y<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">this</span> *<span style="color: #b58900;">Pair</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Swap</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    this.x<span style="color: #757575;">,</span> this.y = this.y<span style="color: #757575;">,</span> this.x
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">NewPair</span><span style="color: #757575;">(</span><span style="color: #268bd2;">x</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">y</span> <span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #b58900;">Pair</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> <span style="color: #b58900;">Pair</span><span style="color: #757575;">{</span>x<span style="color: #757575;">,</span> y<span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">p</span> := <span style="color: #268bd2;">NewPair</span><span style="color: #757575;">(</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">)</span>
    p.<span style="color: #268bd2;">Dump</span><span style="color: #757575;">()</span>
    p.<span style="color: #268bd2;">Swap</span><span style="color: #757575;">()</span>
    p.<span style="color: #268bd2;">Dump</span><span style="color: #757575;">()</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
1 2
2 1
</pre>


<ul class="org-ul">
<li><p>
golang 通过 duck typing 的方式支持 interface
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">type</span> <span style="color: #b58900;">Animal</span> <span style="color: #859900;">interface</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">speak</span><span style="color: #757575;">()</span>
<span style="color: #757575;">}</span>
<span style="color: #859900;">type</span> <span style="color: #b58900;">Dog</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">dog</span> <span style="color: #b58900;">Dog</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">speak</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"bark"</span><span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">speak</span><span style="color: #757575;">(</span><span style="color: #268bd2;">x</span> <span style="color: #b58900;">Animal</span><span style="color: #757575;">)</span> <span style="color: #757575;">{</span>
    x.<span style="color: #268bd2;">speak</span><span style="color: #757575;">()</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">speak</span><span style="color: #757575;">(</span><span style="color: #b58900;">Dog</span><span style="color: #757575;">{})</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<p>
bark
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgac13cca" class="outline-3">
<h3 id="orgac13cca"><span class="section-number-3">1.12</span> 泛型</h3>
<div class="outline-text-3" id="text-1-12">
<p>
go 不支持泛型, 但有一些折衷的方法:
</p>
<ol class="org-ol">
<li>slice, map 本身算泛型容器</li>
<li><p>
通过空的 interface{}
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">func</span> <span style="color: #268bd2;">foo</span><span style="color: #757575;">(</span><span style="color: #268bd2;">v</span> <span style="color: #859900;">interface</span><span style="color: #757575;">{})</span> <span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">switch</span> v.<span style="color: #757575;">(</span><span style="color: #859900;">type</span><span style="color: #757575;">)</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">case</span> <span style="color: #b58900;">int</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>v.<span style="color: #757575;">(</span><span style="color: #b58900;">int</span><span style="color: #757575;">))</span>
    <span style="color: #859900;">default</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"unknow type"</span><span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>
</pre>
</div></li>
<li>通过实现 interface, 例如 sort.Sort() 的实现方法</li>
</ol>
</div>
</div>

<div id="outline-container-org03b7363" class="outline-3">
<h3 id="org03b7363"><span class="section-number-3">1.13</span> 控制结构</h3>
<div class="outline-text-3" id="text-1-13">
<ul class="org-ul">
<li>for
for 是唯一的循环结构, 没有 while, do</li>
<li>if
if 与 switch 支持 initialization stmt</li>
<li>switch
支持 switch {} 与 switch x {} 两种形式, 不支持 case fall throught,
但支持同一个 case 多个条件</li>
</ul>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #757575;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
<span style="color: #757575;">)</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">for 1</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">i</span> := 0; i &lt; 3; i++ <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>i<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">for range</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">i</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">v</span> := <span style="color: #859900;">range</span> []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">}</span> <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>i<span style="color: #757575;">,</span> v<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">for range in map</span>
    <span style="color: #859900;">for</span> <span style="color: #268bd2;">k</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">v</span> := <span style="color: #859900;">range</span> <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">int</span><span style="color: #757575;">{</span><span style="color: #268bd2; font-weight: bold;">1</span>: 1<span style="color: #757575;">,</span> <span style="color: #268bd2; font-weight: bold;">2</span>: 2<span style="color: #757575;">}</span> <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>k<span style="color: #757575;">,</span> v<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">while true</span>
    <span style="color: #859900;">for</span> <span style="color: #757575;">{</span>

    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">while ()</span>
    <span style="color: #859900;">for</span> i &lt; 1 <span style="color: #757575;">{</span>

    <span style="color: #757575;">}</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">if</span>
    <span style="color: #268bd2;">i</span> := 0
    <span style="color: #859900;">if</span> i == 0 <span style="color: #757575;">{</span>

    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">if with initialization stmt</span>
    <span style="color: #268bd2;">m</span> := <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">int</span><span style="color: #757575;">{</span><span style="color: #268bd2; font-weight: bold;">1</span>: 2<span style="color: #757575;">}</span>
    <span style="color: #859900;">if</span> <span style="color: #268bd2;">t</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">ok</span> := m[1]; ok <span style="color: #757575;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>t<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">switch x</span>
    <span style="color: #268bd2;">x</span> := 1
    <span style="color: #859900;">switch</span> x <span style="color: #757575;">{</span>
    <span style="color: #859900;">case</span> 1:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>1<span style="color: #757575;">)</span>
    <span style="color: #859900;">case</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">,</span> 4:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>2<span style="color: #757575;">,</span> 3<span style="color: #757575;">,</span> 4<span style="color: #757575;">)</span>
    <span style="color: #859900;">default</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"default"</span><span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">switch</span>
    <span style="color: #859900;">switch</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">case</span> x == 1:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>1<span style="color: #757575;">)</span>
    <span style="color: #859900;">case</span> x == 2 || x == 3 || x == 4:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>2<span style="color: #757575;">,</span> 3<span style="color: #757575;">,</span> 4<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">swith with initialization stmt</span>
    <span style="color: #859900;">switch</span> <span style="color: #268bd2;">t</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">_</span> := m[1]; t <span style="color: #757575;">{</span>
    <span style="color: #859900;">case</span> 1:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>1<span style="color: #757575;">)</span>
    <span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7220e6" class="outline-3">
<h3 id="orgc7220e6"><span class="section-number-3">1.14</span> 排序</h3>
<div class="outline-text-3" id="text-1-14">
<ul class="org-ul">
<li>sort.Ints</li>
<li>sort.Strings</li>
<li>sort.Slice</li>
<li>sort.Sort</li>
</ul>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #757575;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"sort"</span>
<span style="color: #757575;">)</span>

<span style="color: #859900;">type</span> <span style="color: #b58900;">Pair</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
    x<span style="color: #757575;">,</span> y <span style="color: #b58900;">int</span>
<span style="color: #757575;">}</span>
<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">x</span> := []<span style="color: #b58900;">int</span><span style="color: #757575;">{</span>4<span style="color: #757575;">,</span> 1<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 3<span style="color: #757575;">}</span>
    sort.<span style="color: #268bd2;">Ints</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
    <span style="color: #268bd2;">s</span> := []<span style="color: #b58900;">string</span><span style="color: #757575;">{</span><span style="color: #2aa198;">"c"</span><span style="color: #757575;">,</span> <span style="color: #2aa198;">"b"</span><span style="color: #757575;">,</span> <span style="color: #2aa198;">"a"</span><span style="color: #757575;">}</span>
    sort.<span style="color: #268bd2;">Strings</span><span style="color: #757575;">(</span>s<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>s<span style="color: #757575;">)</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">sort.Slice &#36866;&#29992;&#20110;&#23545;&#25152;&#26377; slice &#25490;&#24207;</span>
    <span style="color: #268bd2;">pairs</span> := []<span style="color: #b58900;">Pair</span><span style="color: #757575;">{{</span>3<span style="color: #757575;">,</span> 2<span style="color: #757575;">},</span> <span style="color: #757575;">{</span>2<span style="color: #757575;">,</span> 4<span style="color: #757575;">}}</span>
    sort.<span style="color: #268bd2;">Slice</span><span style="color: #757575;">(</span>pairs<span style="color: #757575;">,</span> <span style="color: #859900;">func</span><span style="color: #757575;">(</span><span style="color: #268bd2;">i</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">j</span> <span style="color: #b58900;">int</span><span style="color: #757575;">)</span>bool <span style="color: #757575;">{</span>
        <span style="color: #859900;">return</span> pairs[i].x &lt; pairs[j].x
    <span style="color: #757575;">})</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>pairs<span style="color: #757575;">)</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#26356;&#36890;&#29992;&#30340; sort.Sort, &#20854;&#20013; sort.Reverse, sort.IntSlice &#36820;&#22238;&#30340;</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#37117;&#26159;&#23454;&#38469;&#20102; sort.Interface &#30340;&#25509;&#21475;, &#20363;&#22914; IntSlice &#23454;&#38469;&#20026;:</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">type IntSlice []int</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">func (p IntSlice) Len() int           { return len(p) }</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">func (p IntSlice) Less(i, j int) bool { return p[i] &lt; p[j] }</span>
    <span style="color: #586e75;">// </span><span style="color: #586e75;">func (p IntSlice) Swap(i, j int)      { p[i], p[j] = p[j], p[i] }</span>

    <span style="color: #586e75;">// </span><span style="color: #586e75;">&#19968;&#33324;&#24773;&#20917;&#19979;&#19981;&#38656;&#35201;&#20351;&#29992; sort.Sort &#25509;&#21475;</span>
    sort.<span style="color: #268bd2;">Sort</span><span style="color: #757575;">(</span>sort.<span style="color: #268bd2;">Reverse</span><span style="color: #757575;">(</span>sort.<span style="color: #268bd2;">IntSlice</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)))</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>x<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
[1 2 3 4]
[a b c]
[{2 4} {3 2}]
[4 3 2 1]
</pre>
</div>
</div>

<div id="outline-container-org21178a8" class="outline-3">
<h3 id="org21178a8"><span class="section-number-3">1.15</span> 最大堆</h3>
<div class="outline-text-3" id="text-1-15">
<ul class="org-ul">
<li>container/heap 包实现了堆</li>
<li>struct 需要自己实现 Len,Less, Swap, Pop, Push 方法</li>
<li>由于 golang 不支持泛型, 需要注意 Push, Pop 方法使用了 interface{} 做为参数和返回值, 导致 Pop 时需要手动将 interface{} 转换为需要的类型</li>
</ul>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #757575;">(</span>
    <span style="color: #2aa198;">"container/heap"</span>
    <span style="color: #2aa198;">"fmt"</span>
<span style="color: #757575;">)</span>

<span style="color: #859900;">type</span> <span style="color: #b58900;">MinHeap</span> []<span style="color: #b58900;">int</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">h</span> <span style="color: #b58900;">MinHeap</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Len</span><span style="color: #757575;">()</span> <span style="color: #b58900;">int</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> <span style="color: #839496;">len</span><span style="color: #757575;">(</span>h<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">h</span> <span style="color: #b58900;">MinHeap</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Less</span><span style="color: #757575;">(</span><span style="color: #268bd2;">i</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">j</span> <span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #b58900;">bool</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">return</span> h[i] &lt; h[j]
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">h</span> <span style="color: #b58900;">MinHeap</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Swap</span><span style="color: #757575;">(</span><span style="color: #268bd2;">i</span><span style="color: #757575;">,</span> <span style="color: #268bd2;">j</span> <span style="color: #b58900;">int</span><span style="color: #757575;">)</span> <span style="color: #757575;">{</span>
    h[i]<span style="color: #757575;">,</span> h[j] = h[j]<span style="color: #757575;">,</span> h[i]
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">ph</span> *<span style="color: #b58900;">MinHeap</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Pop</span><span style="color: #757575;">()</span> <span style="color: #859900;">interface</span><span style="color: #757575;">{}</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">t</span> := <span style="color: #757575;">(</span>*ph<span style="color: #757575;">)</span>[<span style="color: #839496;">len</span><span style="color: #757575;">(</span>*ph<span style="color: #757575;">)</span>-1]
    *ph = <span style="color: #757575;">(</span>*ph<span style="color: #757575;">)</span>[:<span style="color: #839496;">len</span><span style="color: #757575;">(</span>*ph<span style="color: #757575;">)</span>-1]
    <span style="color: #859900;">return</span> t
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #757575;">(</span><span style="color: #268bd2;">ph</span> *<span style="color: #b58900;">MinHeap</span><span style="color: #757575;">)</span> <span style="color: #268bd2;">Push</span><span style="color: #757575;">(</span><span style="color: #268bd2;">x</span> <span style="color: #859900;">interface</span><span style="color: #757575;">{})</span> <span style="color: #757575;">{</span>
    *ph = <span style="color: #839496;">append</span><span style="color: #757575;">(</span>*ph<span style="color: #757575;">,</span> x.<span style="color: #757575;">(</span><span style="color: #b58900;">int</span><span style="color: #757575;">))</span>
<span style="color: #757575;">}</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">h</span> := <span style="color: #b58900;">MinHeap</span><span style="color: #757575;">{</span>p5<span style="color: #757575;">,</span> 4<span style="color: #757575;">,</span> 3<span style="color: #757575;">,</span> 2<span style="color: #757575;">,</span> 1<span style="color: #757575;">}</span>
    heap.<span style="color: #268bd2;">Init</span><span style="color: #757575;">(</span>&amp;h<span style="color: #757575;">)</span>
    heap.<span style="color: #268bd2;">Push</span><span style="color: #757575;">(</span>&amp;h<span style="color: #757575;">,</span> 10<span style="color: #757575;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>heap.<span style="color: #268bd2;">Pop</span><span style="color: #757575;">(</span>&amp;h<span style="color: #757575;">)</span>.<span style="color: #757575;">(</span><span style="color: #b58900;">int</span><span style="color: #757575;">))</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
1
</pre>
</div>
</div>

<div id="outline-container-orgf1ec9a2" class="outline-3">
<h3 id="orgf1ec9a2"><span class="section-number-3">1.16</span> math</h3>
<div class="outline-text-3" id="text-1-16">
<p>
由于 golang 不支持泛型, math 库中许多函数无法像其它语言一样方便的使用,
因为 math 库大部分函数要求 float64 类型
</p>

<ul class="org-ul">
<li>Abs, Floor, Ceil</li>
<li>MinInt32, MaxInt32</li>
<li>Pow</li>
</ul>
</div>
</div>

<div id="outline-container-org8847373" class="outline-3">
<h3 id="org8847373"><span class="section-number-3">1.17</span> random</h3>
<div class="outline-text-3" id="text-1-17">
<ul class="org-ul">
<li>rand.Intn(n)</li>
<li>rand.Seed</li>
</ul>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #757575;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"math/rand"</span>
    <span style="color: #2aa198;">"time"</span>
<span style="color: #757575;">)</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    rand.<span style="color: #268bd2;">Seed</span><span style="color: #757575;">(</span>time.<span style="color: #268bd2;">Now</span><span style="color: #757575;">()</span>.<span style="color: #268bd2;">Unix</span><span style="color: #757575;">())</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>rand.<span style="color: #268bd2;">Intn</span><span style="color: #757575;">(</span>10<span style="color: #757575;">))</span>
<span style="color: #757575;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga1f334b" class="outline-3">
<h3 id="orga1f334b"><span class="section-number-3">1.18</span> package</h3>
<div class="outline-text-3" id="text-1-18">
<ul class="org-ul">
<li>import "fmt"</li>
<li>import "container/heap"</li>
<li>import ()</li>
<li>import "../util/tree"</li>
<li>import . "util/tree"</li>
<li>import mytree "util/tree"</li>
<li>package 中首字母大写的符号才可以被其它 package 使用</li>
<li>package 是位于 $GOPATH 里指定的某个 {path} 的 src 目录下的目录名</li>
</ul>
</div>
</div>

<div id="outline-container-org1d6bb2d" class="outline-3">
<h3 id="org1d6bb2d"><span class="section-number-3">1.19</span> 坑</h3>
<div class="outline-text-3" id="text-1-19">
<ul class="org-ul">
<li>int 类似在 64bit 系统上为 int64, 而 c 一般是 int32</li>
<li>struct 中的指针类型: map, slice 需要单独初始化</li>
<li>slice 有时需要 copy, 防止别处与它共用</li>
<li>x.(Pair).a = 1 失败, 无法对 x.(Pair) 赋值, 需要使用 z:=x.(Pair); z.a=1</li>
<li><p>
lambda 函数递归定义时有问题
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #586e75;">// </span><span style="color: #586e75;">&#26080;&#27861;&#32534;&#35793;&#36890;&#36807;:</span>
<span style="color: #859900;">package</span> main

<span style="color: #859900;">func</span> <span style="color: #268bd2;">test</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #268bd2;">foo</span> := <span style="color: #859900;">func</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
        <span style="color: #268bd2;">foo</span><span style="color: #757575;">()</span>
    <span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>

<span style="color: #586e75;">// </span><span style="color: #586e75;">&#38656;&#35201;&#20462;&#25913;&#20026;:</span>
<span style="color: #859900;">func</span> <span style="color: #268bd2;">test</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    <span style="color: #859900;">var</span> <span style="color: #268bd2;">foo</span> <span style="color: #859900;">func</span><span style="color: #757575;">()</span>
    foo = <span style="color: #859900;">func</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
        <span style="color: #268bd2;">foo</span><span style="color: #757575;">()</span>
    <span style="color: #757575;">}</span>
<span style="color: #757575;">}</span>
</pre>
</div></li>
<li><p>
map 无法赋值
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

  <span style="color: #859900;">type</span> <span style="color: #b58900;">Pair</span> <span style="color: #859900;">struct</span> <span style="color: #757575;">{</span>
      a <span style="color: #b58900;">int</span>
      b <span style="color: #b58900;">int</span>
  <span style="color: #757575;">}</span>

  <span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
      <span style="color: #268bd2;">m</span> := <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]<span style="color: #b58900;">Pair</span><span style="color: #757575;">{}</span>
      m[0] = <span style="color: #b58900;">Pair</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 1<span style="color: #757575;">}</span>
      <span style="color: #586e75;">// </span><span style="color: #586e75;">&#32534;&#35793;&#38169;&#35823;: cannot assign to struct field m[0].a in map</span>
      m[0].a = 10
      <span style="color: #586e75;">// </span><span style="color: #586e75;">&#20462;&#25913;&#26041;&#27861; 1</span>
      <span style="color: #268bd2;">tmp</span> := m[0]
      tmp.a = 10
      m[0] = tmp
      <span style="color: #586e75;">// </span><span style="color: #586e75;">&#26041;&#27861; 2</span>
      <span style="color: #268bd2;">m2</span> := <span style="color: #859900;">map</span>[<span style="color: #b58900;">int</span>]*<span style="color: #b58900;">Pair</span><span style="color: #757575;">{}</span>
      m2[0] = &amp;<span style="color: #b58900;">Pair</span><span style="color: #757575;">{</span>1<span style="color: #757575;">,</span> 1<span style="color: #757575;">}</span>
      m2[0].a = 10

  <span style="color: #757575;">}</span>
</pre>
</div>

<p>
无法修改的原因据说是 m[0] 对应的 Pair 的地址并不是固定的, map 会根据需要重新安排它的位置
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgc14de37" class="outline-3">
<h3 id="orgc14de37"><span class="section-number-3">1.20</span> channel</h3>
<div class="outline-text-3" id="text-1-20">
<ul class="org-ul">
<li>c:=make(chan int, 10)</li>
<li>往 chan 写: c &lt;- 1</li>
<li>从 chan 读: v := &lt;-c</li>
<li><p>
select
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">select</span> <span style="color: #757575;">{</span>
<span style="color: #859900;">case</span> <span style="color: #268bd2;">msg</span> := &lt;- c1:
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"from c1"</span><span style="color: #757575;">)</span>
<span style="color: #859900;">case</span> <span style="color: #268bd2;">msg</span> := &lt;- c2:
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span><span style="color: #2aa198;">"from c2"</span><span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org8f546c5" class="outline-3">
<h3 id="org8f546c5"><span class="section-number-3">1.21</span> misc</h3>
<div class="outline-text-3" id="text-1-21">
<ul class="org-ul">
<li><p>
const, iota
</p>
<div class="org-src-container">
<pre class="src src-go"><span style="color: #859900;">package</span> main

<span style="color: #859900;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900;">const</span> <span style="color: #757575;">(</span>
    <span style="color: #268bd2; font-weight: bold;">FIRST</span> = <span style="color: #268bd2; font-weight: bold;">iota</span> + 1
    <span style="color: #268bd2; font-weight: bold;">SECOND</span>
    <span style="color: #268bd2; font-weight: bold;">THIRD</span>
<span style="color: #757575;">)</span>

<span style="color: #859900;">func</span> <span style="color: #268bd2;">main</span><span style="color: #757575;">()</span> <span style="color: #757575;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #757575;">(</span>FIRST<span style="color: #757575;">,</span> SECOND<span style="color: #757575;">,</span> THIRD<span style="color: #757575;">)</span>
<span style="color: #757575;">}</span>
</pre>
</div>

<pre class="example">
1 2 3
</pre></li>
<li>go build -gcflags -S xxx.go</li>
<li>go build -gcflags -m xxx.go</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<p class="author">Author: sunway (sunwayforever@gmail.com)<br />
Date: 2018-01-02 二 00:00<br />
Last updated: 2021-09-16 四 11:06</p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
<br />

<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
         var d = document, s = d.createElement('script');
         s.src = '//sunwayforever-github-io.disqus.com/embed.js';
         s.setAttribute('data-timestamp', +new Date());
         (d.head || d.body).appendChild(s);
         })();
</script>
</div>
</body>
</html>
