<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>leetcode</title>


<link rel="stylesheet" type="text/css" href="/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="./htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../htmlize.css"/>
<link rel="stylesheet" type="text/css" href="/readtheorg.css"/>
<link rel="stylesheet" type="text/css" href="./readtheorg.css"/>
<link rel="stylesheet" type="text/css" href="../readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
<link rel="stylesheet" type="text/css" href="/main.css" media="screen" />
<link rel="stylesheet" type="text/css" href="../main.css" media="screen" />
<link rel="stylesheet" type="text/css" href="./main.css" media="screen" />
<link rel = "icon" href = "/icon.png"  type = "image/x-icon">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">leetcode</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org00000e3">1. leetcode</a>
<ul>
<li><a href="#org0000006">1.1. Backtracking</a>
<ul>
<li><a href="#org0000000">1.1.1. N-Queens</a></li>
<li><a href="#org0000003">1.1.2. Permutations II</a></li>
</ul>
</li>
<li><a href="#org000001c">1.2. Binary Search</a>
<ul>
<li><a href="#org000000a">1.2.1. Search a 2D Matrix II</a></li>
<li><a href="#org000000d">1.2.2. Find Minimum in Rotated Sorted Array</a></li>
<li><a href="#org0000010">1.2.3. Search in Rotated Sorted Array</a></li>
<li><a href="#org0000013">1.2.4. Sqrt</a></li>
<li><a href="#org0000016">1.2.5. Minimize Maximum of Array</a></li>
<li><a href="#org0000019">1.2.6. Single Element in a Sorted Array</a></li>
</ul>
</li>
<li><a href="#org0000030">1.3. knapsack</a>
<ul>
<li><a href="#org0000020">1.3.1. Partition Equal Subset Sum</a></li>
<li><a href="#org0000024">1.3.2. Coin Change</a></li>
<li><a href="#org0000027">1.3.3. Coin Change II</a></li>
<li><a href="#org000002a">1.3.4. Combination Sum IV</a></li>
<li><a href="#org000002d">1.3.5. Word Break</a></li>
</ul>
</li>
<li><a href="#org0000040">1.4. DP</a>
<ul>
<li><a href="#org0000034">1.4.1. Stone Game</a></li>
<li><a href="#org0000037">1.4.2. Maximum Sum Circular Subarray</a></li>
<li><a href="#org000003a">1.4.3. Champagne Tower</a></li>
<li><a href="#org000003d">1.4.4. Maximum Alternating Subsequence Sum</a></li>
</ul>
</li>
<li><a href="#org0000052">1.5. Graph</a>
<ul>
<li><a href="#org0000043">1.5.1. Find the City With the Smallest Number of Neighbors at a Threshold Distance</a></li>
<li><a href="#org0000046">1.5.2. Cheapest Flights Within K Stops</a></li>
<li><a href="#org0000049">1.5.3. Course Schedule</a></li>
<li><a href="#org000004c">1.5.4. Surrounded Regions</a></li>
<li><a href="#org000004f">1.5.5. 01 Matrix</a></li>
</ul>
</li>
<li><a href="#org0000058">1.6. Hash Map</a>
<ul>
<li><a href="#org0000055">1.6.1. Two Sum</a></li>
</ul>
</li>
<li><a href="#org0000061">1.7. Heap</a>
<ul>
<li><a href="#org000005b">1.7.1. Find K Pairs with Smallest Sums</a></li>
<li><a href="#org000005e">1.7.2. Find Median from Data Stream</a></li>
</ul>
</li>
<li><a href="#org0000067">1.8. Interval</a>
<ul>
<li><a href="#org0000064">1.8.1. Insert Interval</a></li>
</ul>
</li>
<li><a href="#org0000070">1.9. Linked List</a>
<ul>
<li><a href="#org000006a">1.9.1. LRU Cache</a></li>
<li><a href="#org000006d">1.9.2. Rotate List</a></li>
</ul>
</li>
<li><a href="#org000007c">1.10. LIS</a>
<ul>
<li><a href="#org0000073">1.10.1. Longest Increasing Subsequence</a></li>
<li><a href="#org0000076">1.10.2. Longest Ideal Subsequence</a></li>
<li><a href="#org0000079">1.10.3. Flip String to Monotone Increasing</a></li>
</ul>
</li>
<li><a href="#org0000082">1.11. Matrix</a>
<ul>
<li><a href="#org000007f">1.11.1. Rotate Image</a></li>
</ul>
</li>
<li><a href="#org000008e">1.12. Monotonic Stack</a>
<ul>
<li><a href="#org0000085">1.12.1. Daily Temperatures</a></li>
<li><a href="#org0000088">1.12.2. Sum of Subarray Minimums</a></li>
<li><a href="#org000008b">1.12.3. 132 Pattern</a></li>
</ul>
</li>
<li><a href="#org0000094">1.13. Recursive</a>
<ul>
<li><a href="#org0000091">1.13.1. Minimum Cost For Tickets</a></li>
</ul>
</li>
<li><a href="#org00000a6">1.14. Sliding Window</a>
<ul>
<li><a href="#org0000097">1.14.1. Substring with Concatenation of All Words</a></li>
<li><a href="#org000009a">1.14.2. Longest Repeating Character Replacement</a></li>
<li><a href="#org000009d">1.14.3. Longest Substring with At Least K Repeating Characters</a></li>
<li><a href="#org00000a0">1.14.4. Longest Nice Subarray</a></li>
<li><a href="#org00000a3">1.14.5. Count Complete Subarrays in an Array</a></li>
</ul>
</li>
<li><a href="#org00000ad">1.15. Stack</a>
<ul>
<li><a href="#org00000aa">1.15.1. Basic Calculator</a></li>
</ul>
</li>
<li><a href="#org00000b9">1.16. Tree</a>
<ul>
<li><a href="#org00000b0">1.16.1. BST Iterator</a></li>
<li><a href="#org00000b3">1.16.2. Symmetric Tree</a></li>
<li><a href="#org00000b6">1.16.3. Validate BST</a></li>
</ul>
</li>
<li><a href="#org00000cb">1.17. Trick</a>
<ul>
<li><a href="#org00000bc">1.17.1. Pow</a></li>
<li><a href="#org00000bf">1.17.2. Roman To Integer</a></li>
<li><a href="#org00000c2">1.17.3. Minimize Maximum of Array</a></li>
<li><a href="#org00000c5">1.17.4. Count Negative Numbers in a Sorted Matrix</a></li>
<li><a href="#org00000c8">1.17.5. Count of Smaller Numbers After Self</a></li>
</ul>
</li>
<li><a href="#org00000d1">1.18. Trie</a>
<ul>
<li><a href="#org00000ce">1.18.1. Word Search II</a></li>
</ul>
</li>
<li><a href="#org00000da">1.19. Two Pointers</a>
<ul>
<li><a href="#org00000d4">1.19.1. Heaters</a></li>
<li><a href="#org00000d7">1.19.2. Remove Duplicates From Sorted Array II</a></li>
</ul>
</li>
<li><a href="#org00000e0">1.20. Rolling Hash</a>
<ul>
<li><a href="#org00000dd">1.20.1. Repeated DNA Sequences</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org00000e3" class="outline-2">
<h2 id="org00000e3"><span class="section-number-2">1.</span> leetcode</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org0000006" class="outline-3">
<h3 id="org0000006"><span class="section-number-3">1.1.</span> Backtracking</h3>
<div class="outline-text-3" id="text-1-1">
<p>
backtracking 的一般框架为:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">dfs</span>(curr, i):
     <span class="org-keyword">if</span> ending_cond:
        ans.append(curr)
        <span class="org-keyword">return</span>

    <span class="org-keyword">if</span> visited(i):
        <span class="org-keyword">return</span>
    visited.add(i)

    <span class="org-keyword">for</span> x <span class="org-keyword">in</span> branches:
        dfs(curr <span class="org-operator">+</span> x, ...)

    visited.remove(i)
</pre>
</div>

<p>
它与普通 dfs 的区别主要是需要 `visited.remove` 而 dfs 通常不需要
</p>
</div>

<div id="outline-container-org0000000" class="outline-4">
<h4 id="org0000000"><span class="section-number-4">1.1.1.</span> N-Queens</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
<a href="https://leetcode.com/problems/n-queens/">https://leetcode.com/problems/n-queens/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">solveNQueens</span>(<span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> List[List[<span class="org-builtin">str</span>]]:
        <span class="org-variable-name">rows</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">cols</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">left</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">right</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []

        <span class="org-keyword">def</span> <span class="org-function-name">put</span>(output, i, j):
            <span class="org-variable-name">rows</span>[i] <span class="org-operator">=</span> 1
            <span class="org-variable-name">cols</span>[j] <span class="org-operator">=</span> 1
            <span class="org-variable-name">left</span>[i <span class="org-operator">+</span> j] <span class="org-operator">=</span> 1
            <span class="org-variable-name">right</span>[i <span class="org-operator">-</span> j] <span class="org-operator">=</span> 1
            output[i][j] <span class="org-operator">=</span> <span class="org-string">"Q"</span>

        <span class="org-keyword">def</span> <span class="org-function-name">clear</span>(output, i, j):
            <span class="org-variable-name">rows</span>[i] <span class="org-operator">=</span> 0
            <span class="org-variable-name">cols</span>[j] <span class="org-operator">=</span> 0
            <span class="org-variable-name">left</span>[i <span class="org-operator">+</span> j] <span class="org-operator">=</span> 0
            <span class="org-variable-name">right</span>[i <span class="org-operator">-</span> j] <span class="org-operator">=</span> 0
            output[i][j] <span class="org-operator">=</span> <span class="org-string">"."</span>

        <span class="org-keyword">def</span> <span class="org-function-name">isValid</span>(i, j):
            <span class="org-keyword">return</span> (
                rows[i] <span class="org-operator">==</span> 0 <span class="org-keyword">and</span> cols[j] <span class="org-operator">==</span> 0 <span class="org-keyword">and</span> left[i <span class="org-operator">+</span> j] <span class="org-operator">==</span> 0 <span class="org-keyword">and</span> right[i <span class="org-operator">-</span> j] <span class="org-operator">==</span> 0
            )

        <span class="org-keyword">def</span> <span class="org-function-name">dfs</span>(output, i):
            <span class="org-keyword">if</span> i <span class="org-operator">==</span> n:
                ans.append([<span class="org-string">""</span>.join(x) <span class="org-keyword">for</span> x <span class="org-keyword">in</span> output])
                <span class="org-keyword">return</span>
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
                <span class="org-keyword">if</span> isValid(i, j):
                    put(output, i, j)
                    dfs(output, i <span class="org-operator">+</span> 1)
                    clear(output, i, j)

        <span class="org-variable-name">output</span> <span class="org-operator">=</span> [[<span class="org-string">"."</span> <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)]
        dfs(output, 0)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000003" class="outline-4">
<h4 id="org0000003"><span class="section-number-4">1.1.2.</span> Permutations II</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
<a href="https://leetcode.com/problems/permutations-ii/">https://leetcode.com/problems/permutations-ii/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">permuteUnique</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> List[List[<span class="org-builtin">int</span>]]:
        <span class="org-variable-name">visited</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []

        <span class="org-keyword">def</span> <span class="org-function-name">dfs</span>(curr):
            <span class="org-keyword">if</span> <span class="org-builtin">len</span>(curr) <span class="org-operator">==</span> <span class="org-builtin">len</span>(nums):
                ans.append(curr)
                <span class="org-keyword">return</span>
            <span class="org-variable-name">used</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
            <span class="org-keyword">for</span> i, x <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(nums):
                <span class="org-keyword">if</span> i <span class="org-keyword">in</span> visited:
                    <span class="org-keyword">continue</span>
                <span class="org-keyword">if</span> x <span class="org-keyword">in</span> used:
                    <span class="org-keyword">continue</span>
                used.add(x)
                visited.add(i)
                dfs(curr <span class="org-operator">+</span> [x])
                visited.remove(i)

        dfs([])
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org000001c" class="outline-3">
<h3 id="org000001c"><span class="section-number-3">1.2.</span> Binary Search</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org000000a" class="outline-4">
<h4 id="org000000a"><span class="section-number-4">1.2.1.</span> Search a 2D Matrix II</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
<a href="https://leetcode.com/problems/search-a-2d-matrix-ii/">https://leetcode.com/problems/search-a-2d-matrix-ii/</a>
</p>

<p>
关键问题在于确定二维的 lo, hi 的值, 例如下图中比 e 小的范围为 abc, adg, 比 e 大的范围为 cfk, ghk. c, g 与 e 的大小并不确定
</p>

<pre class="example" id="org0000009">
a b c
d e f
g h k
</pre>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">searchMatrix</span>(<span class="org-keyword">self</span>, matrix: List[List[<span class="org-builtin">int</span>]], target: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(matrix), <span class="org-builtin">len</span>(matrix[0])

        <span class="org-keyword">def</span> <span class="org-function-name">solve</span>(lo, hi, target):
            <span class="org-keyword">if</span> lo[0] <span class="org-operator">&gt;=</span> hi[0] <span class="org-keyword">or</span> lo[1] <span class="org-operator">&gt;=</span> hi[1]:
                <span class="org-keyword">return</span> <span class="org-constant">False</span>
            <span class="org-variable-name">midx</span>, <span class="org-variable-name">midy</span> <span class="org-operator">=</span> (lo[0] <span class="org-operator">+</span> hi[0]) <span class="org-operator">//</span> 2, (lo[1] <span class="org-operator">+</span> hi[1]) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> matrix[midx][midy] <span class="org-operator">==</span> target:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">if</span> matrix[midx][midy] <span class="org-operator">&gt;</span> target:
                <span class="org-keyword">return</span> solve(lo, (midx, hi[1]), target) <span class="org-keyword">or</span> solve(
                    lo, (hi[0], midy), target
                )
            <span class="org-keyword">return</span> solve((lo[0], midy <span class="org-operator">+</span> 1), hi, target) <span class="org-keyword">or</span> solve(
                (midx <span class="org-operator">+</span> 1, lo[1]), hi, target
            )

        <span class="org-keyword">return</span> solve((0, 0), (M, N), target)
</pre>
</div>

<p>
或者采用非 bisect 的算法 (O(m+n)):
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">searchMatrix</span>(<span class="org-keyword">self</span>, matrix: List[List[<span class="org-builtin">int</span>]], target: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(matrix), <span class="org-builtin">len</span>(matrix[0])
        <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> 0, N <span class="org-operator">-</span> 1
        <span class="org-keyword">while</span> x <span class="org-operator">&lt;</span> M <span class="org-keyword">and</span> y <span class="org-operator">&gt;=</span> 0:
            <span class="org-keyword">if</span> matrix[x][y] <span class="org-operator">==</span> target:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">if</span> matrix[x][y] <span class="org-operator">&gt;</span> target:
                <span class="org-variable-name">y</span> <span class="org-operator">-=</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">x</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">return</span> <span class="org-constant">False</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org000000d" class="outline-4">
<h4 id="org000000d"><span class="section-number-4">1.2.2.</span> Find Minimum in Rotated Sorted Array</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
<a href="https://leetcode.com/problems/find-minimum-in-rotated-sorted-array/">https://leetcode.com/problems/find-minimum-in-rotated-sorted-array/</a>
</p>

<p>
这里使用 hi 为 len(nums)-1 而不是 len(nums). 正常的二分查找并不关注这个值, 但这个问题中 mid 本身要参与到下一次迭代: (lo,mid)/(mid+1, hi), 导致 N=2 时出现死循环.
</p>

<p>
假设 nums 为 [0,1], 若迭代公式为 (lo,mid)/(mid+1,hi), 若 mid 选 1, 则会死循环,
若 mid 选 0, 则没有问题.
</p>

<p>
同理, 若迭代公式为 (lo,mid-1)/(mid,hi), 若 mid 选 0, 则死循环, 若 mid 选 1, 则没问题.
</p>

<p>
使用 N 还是 N-1 实际上代表剩余两个元素 [0,1] 时 mid 选 0 还是 1.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findMin</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> 0, <span class="org-builtin">len</span>(nums) <span class="org-operator">-</span> 1
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> nums[lo] <span class="org-operator">&gt;</span> nums[mid]:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
            <span class="org-keyword">elif</span> nums[mid] <span class="org-operator">&gt;</span> nums[hi]:
                <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
        <span class="org-keyword">return</span> nums[lo]
</pre>
</div>

<p>
如果不想考虑前面的问题, 也可以这样, 更简单一些:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findMin</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> 0, <span class="org-builtin">len</span>(nums)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 1 <span class="org-operator">&lt;&lt;</span> 31
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(ans, nums[mid])
            <span class="org-keyword">if</span> nums[lo] <span class="org-operator">&gt;</span> nums[mid]:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
            <span class="org-keyword">elif</span> nums[mid] <span class="org-operator">&gt;</span> nums[hi <span class="org-operator">-</span> 1]:
                <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000010" class="outline-4">
<h4 id="org0000010"><span class="section-number-4">1.2.3.</span> Search in Rotated Sorted Array</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
<a href="https://leetcode.com/problems/search-in-rotated-sorted-array/">https://leetcode.com/problems/search-in-rotated-sorted-array/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">search</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>], target: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> 0, <span class="org-builtin">len</span>(nums)
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> nums[mid] <span class="org-operator">==</span> target:
                <span class="org-keyword">return</span> mid
            <span class="org-keyword">if</span> nums[lo] <span class="org-operator">&lt;</span> nums[mid]:
                <span class="org-keyword">if</span> target <span class="org-operator">&gt;=</span> nums[lo] <span class="org-keyword">and</span> target <span class="org-operator">&lt;</span> nums[mid]:
                    <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
                <span class="org-keyword">else</span>:
                    <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-keyword">if</span> target <span class="org-operator">&gt;</span> nums[mid] <span class="org-keyword">and</span> target <span class="org-operator">&lt;=</span> nums[hi <span class="org-operator">-</span> 1]:
                    <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
                <span class="org-keyword">else</span>:
                    <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
        <span class="org-keyword">return</span> <span class="org-operator">-</span>1
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000013" class="outline-4">
<h4 id="org0000013"><span class="section-number-4">1.2.4.</span> Sqrt</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
<a href="https://leetcode.com/problems/sqrtx/">https://leetcode.com/problems/sqrtx/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">mySqrt</span>(<span class="org-keyword">self</span>, x: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 1
        <span class="org-variable-name">hi</span> <span class="org-operator">=</span> x
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;=</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> mid <span class="org-operator">*</span> mid <span class="org-operator">&lt;=</span> x <span class="org-keyword">and</span> (mid <span class="org-operator">+</span> 1) <span class="org-operator">*</span> (mid <span class="org-operator">+</span> 1) <span class="org-operator">&gt;</span> x:
                <span class="org-keyword">return</span> mid
            <span class="org-keyword">if</span> mid <span class="org-operator">*</span> mid <span class="org-operator">&gt;</span> x:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid <span class="org-operator">-</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
        <span class="org-keyword">return</span> 0
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000016" class="outline-4">
<h4 id="org0000016"><span class="section-number-4">1.2.5.</span> Minimize Maximum of Array</h4>
<div class="outline-text-4" id="text-1-2-5">
<p>
<a href="https://leetcode.com/problems/minimize-maximum-of-array/">https://leetcode.com/problems/minimize-maximum-of-array/</a>
</p>

<p>
与 Sqrt 问题类似, 需要在一个有限的解空间内寻找答案, 且寻找过程符合 bisect 的性质
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">minimizeArrayValue</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums)

        <span class="org-keyword">def</span> <span class="org-function-name">ok</span>(n):
            <span class="org-variable-name">t</span> <span class="org-operator">=</span> nums[::]
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">reversed</span>(<span class="org-builtin">range</span>(1, N)):
                <span class="org-keyword">if</span> t[i] <span class="org-operator">&gt;</span> n:
                    <span class="org-variable-name">t</span>[i <span class="org-operator">-</span> 1] <span class="org-operator">+=</span> t[i] <span class="org-operator">-</span> n
            <span class="org-keyword">return</span> t[0] <span class="org-operator">&lt;=</span> n

        <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(nums), <span class="org-builtin">max</span>(nums)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;=</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> ok(mid):
                <span class="org-variable-name">ans</span> <span class="org-operator">=</span> mid
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid <span class="org-operator">-</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000019" class="outline-4">
<h4 id="org0000019"><span class="section-number-4">1.2.6.</span> Single Element in a Sorted Array</h4>
<div class="outline-text-4" id="text-1-2-6">
<p>
<a href="https://leetcode.com/problems/single-element-in-a-sorted-array/">https://leetcode.com/problems/single-element-in-a-sorted-array/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">singleNonDuplicate</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">hi</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums)
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums)
        <span class="org-keyword">while</span> lo <span class="org-operator">&lt;</span> hi:
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
            <span class="org-keyword">if</span> (mid <span class="org-operator">==</span> 0 <span class="org-keyword">or</span> nums[mid] <span class="org-operator">!=</span> nums[mid <span class="org-operator">-</span> 1]) <span class="org-keyword">and</span> (
                mid <span class="org-operator">==</span> N <span class="org-operator">-</span> 1 <span class="org-keyword">or</span> nums[mid] <span class="org-operator">!=</span> nums[mid <span class="org-operator">+</span> 1]
            ):
                <span class="org-keyword">return</span> nums[mid]
            <span class="org-variable-name">pair</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1 <span class="org-keyword">if</span> mid <span class="org-operator">%</span> 2 <span class="org-operator">==</span> 0 <span class="org-keyword">else</span> mid <span class="org-operator">-</span> 1
            <span class="org-keyword">if</span> nums[mid] <span class="org-operator">==</span> nums[pair]:
                <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000030" class="outline-3">
<h3 id="org0000030"><span class="section-number-3">1.3.</span> knapsack</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org0000020" class="outline-4">
<h4 id="org0000020"><span class="section-number-4">1.3.1.</span> Partition Equal Subset Sum</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
<a href="https://leetcode.com/problems/partition-equal-subset-sum/">https://leetcode.com/problems/partition-equal-subset-sum/</a>
</p>

<p>
01 背包, sum 是背包, nums 是物品
</p>

<p>
其框架为:
</p>

<pre class="example" id="org000001f">
for i in range(N):
    for k,v in dp[i-1].items():
        dp[i][k+nums[i]]= ...
</pre>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">canPartition</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">total</span> <span class="org-operator">=</span> <span class="org-builtin">sum</span>(nums)
        <span class="org-keyword">if</span> total <span class="org-operator">%</span> 2 <span class="org-operator">!=</span> 0:
            <span class="org-keyword">return</span> <span class="org-constant">False</span>
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [{} <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(nums))]
        _dp[0][0] <span class="org-operator">=</span> 1
        _dp[0][nums[0]] <span class="org-operator">=</span> 1
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, <span class="org-builtin">len</span>(nums)):
            <span class="org-keyword">for</span> k, v <span class="org-keyword">in</span> _dp[i <span class="org-operator">-</span> 1].items():
                _dp[i][k <span class="org-operator">+</span> nums[i]] <span class="org-operator">=</span> 1
                _dp[i][k] <span class="org-operator">=</span> 1
        <span class="org-keyword">return</span> total <span class="org-operator">//</span> 2 <span class="org-keyword">in</span> _dp[<span class="org-operator">-</span>1]
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000024" class="outline-4">
<h4 id="org0000024"><span class="section-number-4">1.3.2.</span> Coin Change</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
<a href="https://leetcode.com/problems/coin-change/">https://leetcode.com/problems/coin-change/</a>
</p>

<p>
完全背包问题, 不限制 coins 的数量, amount 是背包, coins 是物品
</p>

<p>
其框架为:
</p>

<pre class="example" id="org0000023">
for i in range(amount):
    for x in range(N):
        dp[i]=f(x,dp[i-1])
</pre>

<p>
其中一般情况下外层循环是背包或物品并没有限制, 除非:
</p>

<ol class="org-ol">
<li>排列问题需要背包放在外层循环</li>
<li>组合问题需要背包放在内层循环</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">coinChange</span>(<span class="org-keyword">self</span>, coins: List[<span class="org-builtin">int</span>], amount: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(amount <span class="org-operator">+</span> 1)]
        <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> 1 <span class="org-operator">&lt;&lt;</span> 31

        <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i):
            <span class="org-keyword">if</span> i <span class="org-operator">&lt;</span> 0:
                <span class="org-keyword">return</span> MAX
            <span class="org-keyword">return</span> _dp[i]

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, amount <span class="org-operator">+</span> 1):
            <span class="org-variable-name">tmp</span> <span class="org-operator">=</span> MAX
            <span class="org-keyword">for</span> c <span class="org-keyword">in</span> coins:
                <span class="org-variable-name">tmp</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(tmp, dp(i <span class="org-operator">-</span> c) <span class="org-operator">+</span> 1)
            <span class="org-variable-name">_dp</span>[i] <span class="org-operator">=</span> tmp

        <span class="org-keyword">if</span> _dp[<span class="org-operator">-</span>1] <span class="org-operator">==</span> MAX:
            <span class="org-keyword">return</span> <span class="org-operator">-</span>1
        <span class="org-keyword">return</span> _dp[<span class="org-operator">-</span>1]
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000027" class="outline-4">
<h4 id="org0000027"><span class="section-number-4">1.3.3.</span> Coin Change II</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
<a href="https://leetcode.com/problems/coin-change-ii/">https://leetcode.com/problems/coin-change-ii/</a>
</p>

<p>
完全背包, 但是是一个组合问题 (而不是排列问题), 需要把背包放在内层循环
</p>

<p>
<a href="https://leetcode.com/problems/coin-change-ii/solutions/5023598/beginner-mistake-permutations-vs-combination/">https://leetcode.com/problems/coin-change-ii/solutions/5023598/beginner-mistake-permutations-vs-combination/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">change</span>(<span class="org-keyword">self</span>, amount: <span class="org-builtin">int</span>, coins: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(amount <span class="org-operator">+</span> 1)]
        <span class="org-variable-name">_dp</span>[0] <span class="org-operator">=</span> 1

        <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i):
            <span class="org-keyword">if</span> i <span class="org-operator">&lt;</span> 0:
                <span class="org-keyword">return</span> 0
            <span class="org-keyword">return</span> _dp[i]

        <span class="org-keyword">for</span> c <span class="org-keyword">in</span> coins:
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, amount <span class="org-operator">+</span> 1):
                <span class="org-variable-name">_dp</span>[i] <span class="org-operator">+=</span> dp(i <span class="org-operator">-</span> c)

        <span class="org-keyword">return</span> _dp[<span class="org-operator">-</span>1]
</pre>
</div>
</div>
</div>

<div id="outline-container-org000002a" class="outline-4">
<h4 id="org000002a"><span class="section-number-4">1.3.4.</span> Combination Sum IV</h4>
<div class="outline-text-4" id="text-1-3-4">
<p>
<a href="https://leetcode.com/problems/combination-sum-iv/">https://leetcode.com/problems/combination-sum-iv/</a>
</p>

<p>
与 Coin Change II 基本相同, 但是是一个排列问题, 需要把背包放在外层循环
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">combinationSum4</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>], target: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(target <span class="org-operator">+</span> 1)]
        <span class="org-variable-name">_dp</span>[0] <span class="org-operator">=</span> 1

        <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i):
            <span class="org-keyword">if</span> i <span class="org-operator">&lt;</span> 0:
                <span class="org-keyword">return</span> 0
            <span class="org-keyword">return</span> _dp[i]

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, target <span class="org-operator">+</span> 1):
            <span class="org-keyword">for</span> x <span class="org-keyword">in</span> nums:
                <span class="org-variable-name">_dp</span>[i] <span class="org-operator">+=</span> dp(i <span class="org-operator">-</span> x)
        <span class="org-keyword">return</span> _dp[<span class="org-operator">-</span>1]
</pre>
</div>
</div>
</div>

<div id="outline-container-org000002d" class="outline-4">
<h4 id="org000002d"><span class="section-number-4">1.3.5.</span> Word Break</h4>
<div class="outline-text-4" id="text-1-3-5">
<p>
<a href="https://leetcode.com/problems/word-break/">https://leetcode.com/problems/word-break/</a>
</p>

<p>
完全背包, 不限制 words 的数量, s 是背包, words 是物品
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">wordBreak</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>, wordDict: List[<span class="org-builtin">str</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(s)
        <span class="org-variable-name">wordDict</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>(wordDict)

        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [<span class="org-constant">False</span> <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]

        <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i):
            <span class="org-keyword">if</span> i <span class="org-operator">==</span> <span class="org-operator">-</span>1:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">return</span> _dp[i]

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i <span class="org-operator">+</span> 1):
                <span class="org-variable-name">x</span> <span class="org-operator">=</span> s[j : i <span class="org-operator">+</span> 1]
                <span class="org-variable-name">tmp</span> <span class="org-operator">=</span> <span class="org-constant">False</span>
                <span class="org-keyword">if</span> x <span class="org-keyword">in</span> wordDict:
                    <span class="org-variable-name">tmp</span> <span class="org-operator">|=</span> dp(j <span class="org-operator">-</span> 1)
                <span class="org-keyword">if</span> tmp:
                    <span class="org-variable-name">_dp</span>[i] <span class="org-operator">=</span> <span class="org-constant">True</span>
                    <span class="org-keyword">break</span>
        <span class="org-keyword">return</span> _dp[<span class="org-operator">-</span>1]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000040" class="outline-3">
<h3 id="org0000040"><span class="section-number-3">1.4.</span> DP</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org0000034" class="outline-4">
<h4 id="org0000034"><span class="section-number-4">1.4.1.</span> Stone Game</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
<a href="https://leetcode.com/problems/stone-game/description/">https://leetcode.com/problems/stone-game/description/</a>
</p>

<p>
这个问题的子问题对应中间一段子区间, 这种形式的 DP 需要使用从小的 subarray 扩展到大的 subarray 的形式, 二维 DP 需要使用 distance 来迭代, 即:
</p>

<pre class="example" id="org0000033">
for d in range(1,N):
    for i in range(N-d):
        ...
</pre>

<p>
且初始化条件为 d=0
</p>

<p>
类似的问题还有 <a href="https://leetcode.com/problems/palindromic-substrings/">https://leetcode.com/problems/palindromic-substrings/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">stoneGame</span>(<span class="org-keyword">self</span>, piles: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(piles)
        <span class="org-comment-delimiter"># </span><span class="org-comment">5 3 4 5</span>
        <span class="org-comment-delimiter">#   </span><span class="org-comment">i j</span>
        <span class="org-variable-name">dp</span> <span class="org-operator">=</span> [[0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            dp[i][i] <span class="org-operator">=</span> piles[i]
        <span class="org-keyword">for</span> d <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, N):
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N <span class="org-operator">-</span> d):
                dp[i][i <span class="org-operator">+</span> d] <span class="org-operator">=</span> <span class="org-builtin">max</span>(
                    piles[i] <span class="org-operator">-</span> dp[i <span class="org-operator">+</span> 1][i <span class="org-operator">+</span> d], piles[i <span class="org-operator">+</span> d] <span class="org-operator">-</span> dp[i][i <span class="org-operator">+</span> d <span class="org-operator">-</span> 1]
                )
        <span class="org-keyword">return</span> dp[0][<span class="org-operator">-</span>1] <span class="org-operator">&gt;</span> 0
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000037" class="outline-4">
<h4 id="org0000037"><span class="section-number-4">1.4.2.</span> Maximum Sum Circular Subarray</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
<a href="https://leetcode.com/problems/maximum-sum-circular-subarray/">https://leetcode.com/problems/maximum-sum-circular-subarray/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">maxSubarraySumCircular</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-comment-delimiter"># </span><span class="org-comment">5 -3 5</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">5 -3 5 5 -3 5</span>
        <span class="org-keyword">def</span> <span class="org-function-name">getMax</span>(nums):
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> nums[0]
            <span class="org-variable-name">dp</span> <span class="org-operator">=</span> nums[:]
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, <span class="org-builtin">len</span>(nums)):
                <span class="org-variable-name">dp</span>[i] <span class="org-operator">=</span> <span class="org-builtin">max</span>(dp[i <span class="org-operator">-</span> 1] <span class="org-operator">+</span> nums[i], nums[i])
                <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, dp[i])
            <span class="org-keyword">return</span> ans

        <span class="org-keyword">def</span> <span class="org-function-name">getMin</span>(nums):
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> nums[0]
            <span class="org-variable-name">dp</span> <span class="org-operator">=</span> nums[:]
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, <span class="org-builtin">len</span>(nums)):
                <span class="org-variable-name">dp</span>[i] <span class="org-operator">=</span> <span class="org-builtin">min</span>(dp[i <span class="org-operator">-</span> 1] <span class="org-operator">+</span> nums[i], nums[i])
                <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(ans, dp[i])
            <span class="org-keyword">return</span> ans

        <span class="org-variable-name">a</span> <span class="org-operator">=</span> getMax(nums)
        <span class="org-variable-name">b</span> <span class="org-operator">=</span> getMin(nums)
        <span class="org-keyword">if</span> b <span class="org-operator">==</span> <span class="org-builtin">sum</span>(nums):
            <span class="org-keyword">return</span> a
        <span class="org-keyword">return</span> <span class="org-builtin">max</span>(a, <span class="org-builtin">sum</span>(nums) <span class="org-operator">-</span> b)
</pre>
</div>
</div>
</div>

<div id="outline-container-org000003a" class="outline-4">
<h4 id="org000003a"><span class="section-number-4">1.4.3.</span> Champagne Tower</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
<a href="https://leetcode.com/problems/champagne-tower/">https://leetcode.com/problems/champagne-tower/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">champagneTower</span>(<span class="org-keyword">self</span>, poured: <span class="org-builtin">int</span>, query_row: <span class="org-builtin">int</span>, query_glass: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">float</span>:
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [[0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(query_row <span class="org-operator">+</span> 1)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(query_row <span class="org-operator">+</span> 1)]
        _dp[0][0] <span class="org-operator">=</span> poured

        <span class="org-keyword">def</span> <span class="org-function-name">get</span>(i, j):
            <span class="org-keyword">if</span> j <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> j <span class="org-operator">&gt;</span> i:
                <span class="org-keyword">return</span> 0
            <span class="org-keyword">return</span> (_dp[i][j] <span class="org-operator">-</span> 1) <span class="org-operator">/</span> 2 <span class="org-keyword">if</span> _dp[i][j] <span class="org-operator">&gt;=</span> 1 <span class="org-keyword">else</span> 0

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, query_row <span class="org-operator">+</span> 1):
            <span class="org-variable-name">goon</span> <span class="org-operator">=</span> <span class="org-constant">False</span>
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i <span class="org-operator">+</span> 1):
                _dp[i][j] <span class="org-operator">=</span> get(i <span class="org-operator">-</span> 1, j <span class="org-operator">-</span> 1) <span class="org-operator">+</span> get(i <span class="org-operator">-</span> 1, j)
                <span class="org-keyword">if</span> _dp[i][j] <span class="org-operator">&gt;</span> 1:
                    <span class="org-variable-name">goon</span> <span class="org-operator">=</span> <span class="org-constant">True</span>
            <span class="org-keyword">if</span> <span class="org-keyword">not</span> goon:
                <span class="org-keyword">break</span>
        <span class="org-keyword">return</span> <span class="org-builtin">min</span>(_dp[query_row][query_glass], 1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org000003d" class="outline-4">
<h4 id="org000003d"><span class="section-number-4">1.4.4.</span> Maximum Alternating Subsequence Sum</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
<a href="https://leetcode.com/problems/maximum-alternating-subsequence-sum/">https://leetcode.com/problems/maximum-alternating-subsequence-sum/</a>
</p>

<p>
类似的问题还有:
<a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/">https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/</a>
</p>

<p>
该问题和`最大的子数组`类似, 但元素如何 take 取决于当前子序列长度是奇数还是偶数,
因此需要维护 even 和 odd 两个 sum
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">maxAlternatingSum</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-comment-delimiter"># </span><span class="org-comment">4 2 5 3</span>
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums)
        <span class="org-comment-delimiter"># </span><span class="org-comment">subseq &#20013;&#20803;&#32032;&#20026;&#20598;&#25968;&#20010;</span>
        <span class="org-variable-name">_dpEven</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-comment-delimiter"># </span><span class="org-comment">subseq &#20013;&#20803;&#32032;&#20026;&#22855;&#25968;&#20010;</span>
        <span class="org-variable-name">_dpOdd</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]

        <span class="org-variable-name">_dpOdd</span>[0] <span class="org-operator">=</span> nums[0]

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, N):
            <span class="org-variable-name">_dpEven</span>[i] <span class="org-operator">=</span> <span class="org-builtin">max</span>(_dpEven[i <span class="org-operator">-</span> 1], _dpOdd[i <span class="org-operator">-</span> 1] <span class="org-operator">-</span> nums[i])
            <span class="org-variable-name">_dpOdd</span>[i] <span class="org-operator">=</span> <span class="org-builtin">max</span>(_dpOdd[i <span class="org-operator">-</span> 1], _dpEven[i <span class="org-operator">-</span> 1] <span class="org-operator">+</span> nums[i])
        <span class="org-keyword">return</span> <span class="org-builtin">max</span>(_dpEven[<span class="org-operator">-</span>1], _dpOdd[<span class="org-operator">-</span>1])
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000052" class="outline-3">
<h3 id="org0000052"><span class="section-number-3">1.5.</span> Graph</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org0000043" class="outline-4">
<h4 id="org0000043"><span class="section-number-4">1.5.1.</span> Find the City With the Smallest Number of Neighbors at a Threshold Distance</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
<a href="https://leetcode.com/problems/find-the-city-with-the-smallest-number-of-neighbors-at-a-threshold-distance/">https://leetcode.com/problems/find-the-city-with-the-smallest-number-of-neighbors-at-a-threshold-distance/</a>
</p>

<p>
floyd warshall
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findTheCity</span>(
        <span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, edges: List[List[<span class="org-builtin">int</span>]], distanceThreshold: <span class="org-builtin">int</span>
    ) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">dist</span> <span class="org-operator">=</span> [[1 <span class="org-operator">&lt;&lt;</span> 31 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)]
        <span class="org-keyword">for</span> x, y, d <span class="org-keyword">in</span> edges:
            dist[x][y] <span class="org-operator">=</span> d
            dist[y][x] <span class="org-operator">=</span> d
        <span class="org-keyword">for</span> k <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
                <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
                    <span class="org-keyword">if</span> i <span class="org-operator">==</span> j:
                        <span class="org-keyword">continue</span>
                    dist[i][j] <span class="org-operator">=</span> <span class="org-builtin">min</span>(dist[i][j], dist[i][k] <span class="org-operator">+</span> dist[k][j])

        <span class="org-variable-name">count</span> <span class="org-operator">=</span> [<span class="org-builtin">len</span>(<span class="org-builtin">list</span>(<span class="org-builtin">filter</span>(<span class="org-keyword">lambda</span> x: x <span class="org-operator">&lt;=</span> distanceThreshold, x))) <span class="org-keyword">for</span> x <span class="org-keyword">in</span> dist]
        <span class="org-variable-name">target</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(count)
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">reversed</span>(<span class="org-builtin">range</span>(n)):
            <span class="org-keyword">if</span> count[i] <span class="org-operator">==</span> target:
                <span class="org-keyword">return</span> i
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000046" class="outline-4">
<h4 id="org0000046"><span class="section-number-4">1.5.2.</span> Cheapest Flights Within K Stops</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
<a href="https://leetcode.com/problems/cheapest-flights-within-k-stops/">https://leetcode.com/problems/cheapest-flights-within-k-stops/</a>
</p>

<p>
dijkstra
</p>

<p>
和正常 bfs 的区别在于 bfs 使用 visited 标记已经遍历过的节点, 但如果边带权, 则无法使用. 这里使用 shortest 来代替 visited
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> deque


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findCheapestPrice</span>(
        <span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, flights: List[List[<span class="org-builtin">int</span>]], src: <span class="org-builtin">int</span>, dst: <span class="org-builtin">int</span>, k: <span class="org-builtin">int</span>
    ) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">q</span> <span class="org-operator">=</span> deque()
        q.append((src, 0))
        q.append(<span class="org-constant">None</span>)
        <span class="org-variable-name">stops</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">shortest</span> <span class="org-operator">=</span> {}
        <span class="org-variable-name">conn</span> <span class="org-operator">=</span> {}
        <span class="org-keyword">for</span> f, t, p <span class="org-keyword">in</span> flights:
            <span class="org-keyword">if</span> f <span class="org-keyword">not</span> <span class="org-keyword">in</span> conn:
                <span class="org-variable-name">conn</span>[f] <span class="org-operator">=</span> []
            conn[f].append([t, p])
        <span class="org-keyword">while</span> q:
            <span class="org-variable-name">top</span> <span class="org-operator">=</span> q.popleft()
            <span class="org-keyword">if</span> top <span class="org-keyword">is</span> <span class="org-constant">None</span>:
                <span class="org-keyword">if</span> q:
                    q.append(<span class="org-constant">None</span>)
                <span class="org-variable-name">stops</span> <span class="org-operator">+=</span> 1
                <span class="org-keyword">if</span> stops <span class="org-operator">==</span> k <span class="org-operator">+</span> 2:
                    <span class="org-keyword">break</span>
                <span class="org-keyword">continue</span>
            shortest[top[0]] <span class="org-operator">=</span> <span class="org-builtin">min</span>(shortest.get(top[0], 1 <span class="org-operator">&lt;&lt;</span> 31), top[1])
            <span class="org-keyword">for</span> t, p <span class="org-keyword">in</span> conn.get(top[0], []):
                <span class="org-keyword">if</span> t <span class="org-keyword">not</span> <span class="org-keyword">in</span> shortest <span class="org-keyword">or</span> shortest[t] <span class="org-operator">&gt;</span> p <span class="org-operator">+</span> top[1]:
                    q.append((t, top[1] <span class="org-operator">+</span> p))
        <span class="org-keyword">if</span> dst <span class="org-keyword">in</span> shortest:
            <span class="org-keyword">return</span> shortest[dst]
        <span class="org-keyword">return</span> <span class="org-operator">-</span>1
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000049" class="outline-4">
<h4 id="org0000049"><span class="section-number-4">1.5.3.</span> Course Schedule</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
<a href="https://leetcode.com/problems/course-schedule/">https://leetcode.com/problems/course-schedule/</a>
</p>

<p>
topo sort
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">canFinish</span>(<span class="org-keyword">self</span>, numCourses: <span class="org-builtin">int</span>, prerequisites: List[List[<span class="org-builtin">int</span>]]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">dep</span> <span class="org-operator">=</span> [[] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(numCourses)]
        <span class="org-variable-name">order</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(numCourses)]
        <span class="org-keyword">for</span> a, b <span class="org-keyword">in</span> prerequisites:
            dep[b].append(a)
            <span class="org-variable-name">order</span>[a] <span class="org-operator">+=</span> 1
        <span class="org-variable-name">q</span> <span class="org-operator">=</span> deque()
        <span class="org-variable-name">count</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(numCourses):
            <span class="org-keyword">if</span> order[i] <span class="org-operator">==</span> 0:
                <span class="org-variable-name">count</span> <span class="org-operator">+=</span> 1
                q.append(i)
        <span class="org-keyword">while</span> q:
            <span class="org-variable-name">top</span> <span class="org-operator">=</span> q.popleft()
            <span class="org-keyword">for</span> x <span class="org-keyword">in</span> dep[top]:
                <span class="org-variable-name">order</span>[x] <span class="org-operator">-=</span> 1
                <span class="org-keyword">if</span> order[x] <span class="org-operator">==</span> 0:
                    <span class="org-variable-name">count</span> <span class="org-operator">+=</span> 1
                    q.append(x)
        <span class="org-keyword">return</span> count <span class="org-operator">==</span> numCourses
</pre>
</div>
</div>
</div>

<div id="outline-container-org000004c" class="outline-4">
<h4 id="org000004c"><span class="section-number-4">1.5.4.</span> Surrounded Regions</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
<a href="https://leetcode.com/problems/surrounded-regions/">https://leetcode.com/problems/surrounded-regions/</a>
</p>

<p>
从边缘的 O 开始 dfs, 标记连通的点.
</p>

<p>
如果不从边缘开始 dfs 而是采用任意起点 dfs 然后判断是否与边缘连通则会 TLE
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">solve</span>(<span class="org-keyword">self</span>, board: List[List[<span class="org-builtin">str</span>]]) <span class="org-operator">-&gt;</span> <span class="org-constant">None</span>:
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(board), <span class="org-builtin">len</span>(board[0])

        <span class="org-variable-name">visited</span> <span class="org-operator">=</span> {}

        <span class="org-keyword">def</span> <span class="org-function-name">dfs</span>(x, y):
            <span class="org-keyword">if</span> x <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> y <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> x <span class="org-operator">&gt;=</span> M <span class="org-keyword">or</span> y <span class="org-operator">&gt;=</span> N:
                <span class="org-keyword">return</span>
            <span class="org-keyword">if</span> board[x][y] <span class="org-operator">!=</span> <span class="org-string">"O"</span>:
                <span class="org-keyword">return</span>
            <span class="org-keyword">if</span> (x, y) <span class="org-keyword">in</span> visited:
                <span class="org-keyword">return</span>
            <span class="org-variable-name">visited</span>[(x, y)] <span class="org-operator">=</span> 1
            board[x][y] <span class="org-operator">=</span> <span class="org-string">"Y"</span>
            <span class="org-builtin">dir</span> <span class="org-operator">=</span> [[0, 1], [0, <span class="org-operator">-</span>1], [1, 0], [<span class="org-operator">-</span>1, 0]]
            <span class="org-keyword">for</span> xx, yy <span class="org-keyword">in</span> <span class="org-builtin">dir</span>:
                dfs(x <span class="org-operator">+</span> xx, y <span class="org-operator">+</span> yy)

        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> [0, M <span class="org-operator">-</span> 1]:
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                dfs(x, y)
        <span class="org-keyword">for</span> y <span class="org-keyword">in</span> [0, N <span class="org-operator">-</span> 1]:
            <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M):
                dfs(x, y)

        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M):
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                <span class="org-keyword">if</span> board[x][y] <span class="org-operator">==</span> <span class="org-string">"O"</span>:
                    board[x][y] <span class="org-operator">=</span> <span class="org-string">"X"</span>
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M):
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                <span class="org-keyword">if</span> board[x][y] <span class="org-operator">==</span> <span class="org-string">"Y"</span>:
                    board[x][y] <span class="org-operator">=</span> <span class="org-string">"O"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org000004f" class="outline-4">
<h4 id="org000004f"><span class="section-number-4">1.5.5.</span> 01 Matrix</h4>
<div class="outline-text-4" id="text-1-5-5">
<p>
<a href="https://leetcode.com/problems/01-matrix/">https://leetcode.com/problems/01-matrix/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> deque


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">updateMatrix</span>(<span class="org-keyword">self</span>, mat: List[List[<span class="org-builtin">int</span>]]) <span class="org-operator">-&gt;</span> List[List[<span class="org-builtin">int</span>]]:
        <span class="org-comment-delimiter"># </span><span class="org-comment">000</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">010</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">111</span>
        <span class="org-variable-name">q</span> <span class="org-operator">=</span> deque()
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(mat), <span class="org-builtin">len</span>(mat[0])
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> [[<span class="org-operator">-</span>1 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M)]
        <span class="org-variable-name">visited</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M):
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                <span class="org-keyword">if</span> mat[i][j] <span class="org-operator">==</span> 0:
                    ans[i][j] <span class="org-operator">=</span> 0
                    q.append((i, j))
                    visited.add((i, j))

        q.append(<span class="org-constant">None</span>)
        <span class="org-variable-name">distance</span> <span class="org-operator">=</span> 1
        <span class="org-keyword">while</span> q:
            <span class="org-variable-name">top</span> <span class="org-operator">=</span> q.popleft()
            <span class="org-keyword">if</span> top <span class="org-keyword">is</span> <span class="org-constant">None</span>:
                <span class="org-keyword">if</span> q:
                    q.append(<span class="org-constant">None</span>)
                <span class="org-variable-name">distance</span> <span class="org-operator">+=</span> 1
                <span class="org-keyword">continue</span>
            <span class="org-keyword">for</span> d <span class="org-keyword">in</span> [[0, 1], [0, <span class="org-operator">-</span>1], [1, 0], [<span class="org-operator">-</span>1, 0]]:
                <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> top[0] <span class="org-operator">+</span> d[0], top[1] <span class="org-operator">+</span> d[1]
                <span class="org-keyword">if</span> x <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> x <span class="org-operator">&gt;=</span> M <span class="org-keyword">or</span> y <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> y <span class="org-operator">&gt;=</span> N:
                    <span class="org-keyword">continue</span>
                <span class="org-keyword">if</span> (x, y) <span class="org-keyword">in</span> visited:
                    <span class="org-keyword">continue</span>
                ans[x][y] <span class="org-operator">=</span> distance
                visited.add((x, y))
                q.append((x, y))
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000058" class="outline-3">
<h3 id="org0000058"><span class="section-number-3">1.6.</span> Hash Map</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org0000055" class="outline-4">
<h4 id="org0000055"><span class="section-number-4">1.6.1.</span> Two Sum</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
<a href="https://leetcode.com/problems/two-sum/">https://leetcode.com/problems/two-sum/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">twoSum</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>], target: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">int</span>]:
        <span class="org-variable-name">m</span> <span class="org-operator">=</span> {}
        <span class="org-keyword">for</span> i, v <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(nums):
            <span class="org-keyword">if</span> target <span class="org-operator">-</span> v <span class="org-keyword">in</span> m:
                <span class="org-keyword">return</span> [m[target <span class="org-operator">-</span> v], i]
            <span class="org-variable-name">m</span>[v] <span class="org-operator">=</span> i
        <span class="org-keyword">return</span> <span class="org-constant">None</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000061" class="outline-3">
<h3 id="org0000061"><span class="section-number-3">1.7.</span> Heap</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-org000005b" class="outline-4">
<h4 id="org000005b"><span class="section-number-4">1.7.1.</span> Find K Pairs with Smallest Sums</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
<a href="https://leetcode.com/problems/find-k-pairs-with-smallest-sums/">https://leetcode.com/problems/find-k-pairs-with-smallest-sums/</a>
</p>

<p>
无论用最小堆直接求解或者用大小为 k 的最大堆保留 k 个最小值的解法都会超时
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">kSmallestPairs</span>(<span class="org-keyword">self</span>, nums1, nums2, k):
        <span class="org-variable-name">q</span> <span class="org-operator">=</span> [(nums1[0] <span class="org-operator">+</span> nums2[0], [0, 0])]
        <span class="org-variable-name">visited</span> <span class="org-operator">=</span> {}
        <span class="org-variable-name">A</span>, <span class="org-variable-name">B</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums1), <span class="org-builtin">len</span>(nums2)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []
        <span class="org-keyword">while</span> k <span class="org-operator">&gt;</span> 0:
            <span class="org-variable-name">a</span>, <span class="org-variable-name">b</span> <span class="org-operator">=</span> heappop(q)[1]
            <span class="org-keyword">if</span> (a, b) <span class="org-keyword">in</span> visited:
                <span class="org-keyword">continue</span>
            <span class="org-variable-name">k</span> <span class="org-operator">-=</span> 1
            <span class="org-variable-name">visited</span>[(a, b)] <span class="org-operator">=</span> 1
            ans.append([nums1[a], nums2[b]])
            <span class="org-keyword">if</span> a <span class="org-operator">+</span> 1 <span class="org-operator">&lt;</span> A:
                heappush(q, (nums1[a <span class="org-operator">+</span> 1] <span class="org-operator">+</span> nums2[b], [a <span class="org-operator">+</span> 1, b]))
            <span class="org-keyword">if</span> b <span class="org-operator">+</span> 1 <span class="org-operator">&lt;</span> B:
                heappush(q, (nums1[a] <span class="org-operator">+</span> nums2[b <span class="org-operator">+</span> 1], [a, b <span class="org-operator">+</span> 1]))
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org000005e" class="outline-4">
<h4 id="org000005e"><span class="section-number-4">1.7.2.</span> Find Median from Data Stream</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
<a href="https://leetcode.com/problems/find-median-from-data-stream/">https://leetcode.com/problems/find-median-from-data-stream/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">MedianFinder</span>:

    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>):
        <span class="org-keyword">self</span>.<span class="org-variable-name">lq</span> <span class="org-operator">=</span> []  <span class="org-comment-delimiter"># </span><span class="org-comment">maxheap</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">rq</span> <span class="org-operator">=</span> []  <span class="org-comment-delimiter"># </span><span class="org-comment">minheap</span>

    <span class="org-keyword">def</span> <span class="org-function-name">addNum</span>(<span class="org-keyword">self</span>, num: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-constant">None</span>:
        <span class="org-keyword">if</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.lq) <span class="org-operator">==</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.rq):
            heappush(<span class="org-keyword">self</span>.lq, <span class="org-operator">-</span>heappushpop(<span class="org-keyword">self</span>.rq, num))
        <span class="org-keyword">else</span>:
            heappush(<span class="org-keyword">self</span>.rq, <span class="org-operator">-</span>heappushpop(<span class="org-keyword">self</span>.lq, <span class="org-operator">-</span>num))

    <span class="org-keyword">def</span> <span class="org-function-name">findMedian</span>(<span class="org-keyword">self</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">float</span>:
        <span class="org-keyword">if</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.lq) <span class="org-operator">==</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.rq):
            <span class="org-keyword">return</span> (<span class="org-operator">-</span><span class="org-keyword">self</span>.lq[0] <span class="org-operator">+</span> <span class="org-keyword">self</span>.rq[0]) <span class="org-operator">/</span> 2
        <span class="org-keyword">else</span>:
            <span class="org-keyword">return</span> <span class="org-operator">-</span><span class="org-keyword">self</span>.lq[0]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000067" class="outline-3">
<h3 id="org0000067"><span class="section-number-3">1.8.</span> Interval</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-org0000064" class="outline-4">
<h4 id="org0000064"><span class="section-number-4">1.8.1.</span> Insert Interval</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
<a href="https://leetcode.com/problems/insert-interval/">https://leetcode.com/problems/insert-interval/</a>
</p>

<p>
在一个循环中需要分段做不同的事, 可以把它变成多个循环
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">insert</span>(<span class="org-keyword">self</span>, intervals, newInterval):
        intervals.sort(key<span class="org-operator">=</span><span class="org-keyword">lambda</span> x: x[0])
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []
        <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> newInterval
        <span class="org-variable-name">i</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">while</span> i <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(intervals) <span class="org-keyword">and</span> intervals[i][1] <span class="org-operator">&lt;</span> lo:
            ans.append(intervals[i])
            <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">while</span> i <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(intervals) <span class="org-keyword">and</span> intervals[i][0] <span class="org-operator">&lt;=</span> hi:
            <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(lo, intervals[i][0]), <span class="org-builtin">max</span>(hi, intervals[i][1])
            <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
        ans.append([lo, hi])
        <span class="org-keyword">while</span> i <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(intervals):
            ans.append(intervals[i])
            <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000070" class="outline-3">
<h3 id="org0000070"><span class="section-number-3">1.9.</span> Linked List</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-org000006a" class="outline-4">
<h4 id="org000006a"><span class="section-number-4">1.9.1.</span> LRU Cache</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
<a href="https://leetcode.com/problems/lru-cache/">https://leetcode.com/problems/lru-cache/</a>
</p>

<p>
使用双向链表维护 LRU 信息
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Node</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>, k<span class="org-operator">=</span>0, v<span class="org-operator">=</span>0):
        <span class="org-keyword">self</span>.<span class="org-variable-name">prev</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>
        <span class="org-keyword">self</span>.<span class="org-builtin">next</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">val</span> <span class="org-operator">=</span> v
        <span class="org-keyword">self</span>.<span class="org-variable-name">key</span> <span class="org-operator">=</span> k

    <span class="org-keyword">def</span> <span class="org-function-name">insert</span>(<span class="org-keyword">self</span>, b):
        <span class="org-comment-delimiter"># </span><span class="org-comment">a b c</span>
        <span class="org-variable-name">a</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>
        <span class="org-variable-name">c</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.<span class="org-builtin">next</span>
        a.<span class="org-builtin">next</span>, b.<span class="org-builtin">next</span> <span class="org-operator">=</span> b, c
        c.<span class="org-variable-name">prev</span>, b.<span class="org-variable-name">prev</span> <span class="org-operator">=</span> b, a

    <span class="org-keyword">def</span> <span class="org-function-name">delete</span>(<span class="org-keyword">self</span>):
        <span class="org-comment-delimiter"># </span><span class="org-comment">a b c</span>
        <span class="org-variable-name">a</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.prev
        <span class="org-variable-name">c</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.<span class="org-builtin">next</span>
        a.<span class="org-builtin">next</span>, c.<span class="org-variable-name">prev</span> <span class="org-operator">=</span> c, a


<span class="org-keyword">class</span> <span class="org-type">LRUCache</span>:

    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>, capacity: <span class="org-builtin">int</span>):
        <span class="org-keyword">self</span>.<span class="org-variable-name">cap</span> <span class="org-operator">=</span> capacity
        <span class="org-keyword">self</span>.<span class="org-variable-name">m</span> <span class="org-operator">=</span> {}  <span class="org-comment-delimiter"># </span><span class="org-comment">map int to node</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">head</span> <span class="org-operator">=</span> Node()
        <span class="org-keyword">self</span>.<span class="org-variable-name">tail</span> <span class="org-operator">=</span> Node()
        <span class="org-keyword">self</span>.head.<span class="org-builtin">next</span>, <span class="org-keyword">self</span>.head.<span class="org-variable-name">prev</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.tail, <span class="org-keyword">self</span>.tail
        <span class="org-keyword">self</span>.tail.<span class="org-builtin">next</span>, <span class="org-keyword">self</span>.tail.<span class="org-variable-name">prev</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.head, <span class="org-keyword">self</span>.head

    <span class="org-keyword">def</span> <span class="org-function-name">get</span>(<span class="org-keyword">self</span>, key: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-keyword">if</span> key <span class="org-keyword">not</span> <span class="org-keyword">in</span> <span class="org-keyword">self</span>.m:
            <span class="org-keyword">return</span> <span class="org-operator">-</span>1
        <span class="org-variable-name">node</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.m[key]
        node.delete()
        <span class="org-keyword">self</span>.head.insert(node)
        <span class="org-keyword">return</span> node.val

    <span class="org-keyword">def</span> <span class="org-function-name">put</span>(<span class="org-keyword">self</span>, key: <span class="org-builtin">int</span>, value: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-constant">None</span>:
        <span class="org-keyword">if</span> key <span class="org-keyword">in</span> <span class="org-keyword">self</span>.m:
            <span class="org-variable-name">node</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.m[key]
            node.<span class="org-variable-name">val</span> <span class="org-operator">=</span> value
            node.delete()
            <span class="org-keyword">self</span>.head.insert(node)
            <span class="org-keyword">return</span>
        <span class="org-keyword">if</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.m) <span class="org-operator">==</span> <span class="org-keyword">self</span>.cap:
            <span class="org-variable-name">evict</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.tail.prev
            <span class="org-keyword">self</span>.m.pop(evict.key)
            evict.delete()
        <span class="org-variable-name">node</span> <span class="org-operator">=</span> Node(key, value)
        <span class="org-keyword">self</span>.<span class="org-variable-name">m</span>[key] <span class="org-operator">=</span> node
        <span class="org-keyword">self</span>.head.insert(node)
</pre>
</div>
</div>
</div>

<div id="outline-container-org000006d" class="outline-4">
<h4 id="org000006d"><span class="section-number-4">1.9.2.</span> Rotate List</h4>
<div class="outline-text-4" id="text-1-9-2">
<p>
<a href="https://leetcode.com/problems/rotate-list/">https://leetcode.com/problems/rotate-list/</a>
</p>

<p>
原链表首尾相接变成循环链表后再处理
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">rotateRight</span>(<span class="org-keyword">self</span>, head: Optional[ListNode], k: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> Optional[ListNode]:
        <span class="org-keyword">if</span> <span class="org-keyword">not</span> head:
            <span class="org-keyword">return</span> head

        <span class="org-variable-name">prev</span>, <span class="org-variable-name">curr</span> <span class="org-operator">=</span> head, head
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">while</span> curr:
            <span class="org-variable-name">prev</span>, <span class="org-variable-name">curr</span> <span class="org-operator">=</span> curr, curr.<span class="org-builtin">next</span>
            <span class="org-variable-name">N</span> <span class="org-operator">+=</span> 1
        <span class="org-variable-name">k</span> <span class="org-operator">%=</span> N
        prev.<span class="org-builtin">next</span> <span class="org-operator">=</span> head

        <span class="org-variable-name">prev</span> <span class="org-operator">=</span> head
        <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N <span class="org-operator">-</span> k):
            <span class="org-variable-name">prev</span>, <span class="org-variable-name">head</span> <span class="org-operator">=</span> head, head.<span class="org-builtin">next</span>
        prev.<span class="org-builtin">next</span> <span class="org-operator">=</span> <span class="org-constant">None</span>
        <span class="org-keyword">return</span> head
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org000007c" class="outline-3">
<h3 id="org000007c"><span class="section-number-3">1.10.</span> LIS</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-org0000073" class="outline-4">
<h4 id="org0000073"><span class="section-number-4">1.10.1.</span> Longest Increasing Subsequence</h4>
<div class="outline-text-4" id="text-1-10-1">
<p>
<a href="https://leetcode.com/problems/longest-increasing-subsequence/">https://leetcode.com/problems/longest-increasing-subsequence/</a>
</p>

<p>
标准的使用 DP 的算法是 O(n^2)
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">lengthOfLIS</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums)
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> [1 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 1
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i):
                <span class="org-keyword">if</span> nums[i] <span class="org-operator">&gt;</span> nums[j]:
                    <span class="org-variable-name">_dp</span>[i] <span class="org-operator">=</span> <span class="org-builtin">max</span>(_dp[i], _dp[j] <span class="org-operator">+</span> 1)
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, _dp[i])
        <span class="org-keyword">return</span> ans
</pre>
</div>

<p>
使用 bisect 的算法是 O(nlog(n))
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">lengthOfLIS</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-keyword">def</span> <span class="org-function-name">bisect_left</span>(nums, target):
            <span class="org-variable-name">lo</span>, <span class="org-variable-name">hi</span> <span class="org-operator">=</span> 0, <span class="org-builtin">len</span>(nums)
            <span class="org-keyword">while</span> lo <span class="org-operator">&lt;</span> hi:
                <span class="org-variable-name">mid</span> <span class="org-operator">=</span> (lo <span class="org-operator">+</span> hi) <span class="org-operator">//</span> 2
                <span class="org-keyword">if</span> target <span class="org-operator">&lt;=</span> nums[mid]:
                    <span class="org-variable-name">hi</span> <span class="org-operator">=</span> mid
                <span class="org-keyword">else</span>:
                    <span class="org-variable-name">lo</span> <span class="org-operator">=</span> mid <span class="org-operator">+</span> 1
            <span class="org-keyword">return</span> lo

        <span class="org-variable-name">lis</span> <span class="org-operator">=</span> []
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> nums:
            <span class="org-keyword">if</span> <span class="org-keyword">not</span> lis <span class="org-keyword">or</span> x <span class="org-operator">&gt;</span> lis[<span class="org-operator">-</span>1]:
                lis.append(x)
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">idx</span> <span class="org-operator">=</span> bisect_left(lis, x)
                <span class="org-variable-name">lis</span>[idx] <span class="org-operator">=</span> x
        <span class="org-keyword">return</span> <span class="org-builtin">len</span>(lis)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000076" class="outline-4">
<h4 id="org0000076"><span class="section-number-4">1.10.2.</span> Longest Ideal Subsequence</h4>
<div class="outline-text-4" id="text-1-10-2">
<p>
<a href="https://leetcode.com/problems/longest-ideal-subsequence/">https://leetcode.com/problems/longest-ideal-subsequence/</a>
</p>

<p>
本质上也是 LIS 问题, 但直接使用类似于 LIS 的 DP 算法会 LTE, 观察到 dp 实际只有
26 种不同的值, 转而对 26 个字母而不是针对 n 进行 dp
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">longestIdealString</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>, k: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 1
        <span class="org-variable-name">_dp</span> <span class="org-operator">=</span> {}
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> s:
            <span class="org-variable-name">t</span> <span class="org-operator">=</span> 1
            <span class="org-keyword">for</span> y, l <span class="org-keyword">in</span> _dp.items():
                <span class="org-keyword">if</span> <span class="org-builtin">abs</span>(<span class="org-builtin">ord</span>(x) <span class="org-operator">-</span> <span class="org-builtin">ord</span>(y)) <span class="org-operator">&lt;=</span> k:
                    <span class="org-variable-name">t</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(t, l <span class="org-operator">+</span> 1)
            <span class="org-variable-name">_dp</span>[x] <span class="org-operator">=</span> t
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, t)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000079" class="outline-4">
<h4 id="org0000079"><span class="section-number-4">1.10.3.</span> Flip String to Monotone Increasing</h4>
<div class="outline-text-4" id="text-1-10-3">
<p>
<a href="https://leetcode.com/problems/flip-string-to-monotone-increasing/">https://leetcode.com/problems/flip-string-to-monotone-increasing/</a>
</p>

<p>
与 Longest Ideal Subsequence 类似, dp 只有两种状态: 0/1, dp[0] 表示目前为止看到的以 0 结尾的非递减序列的最大长度
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">minFlipsMonoIncr</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">dp</span> <span class="org-operator">=</span> [0, 0]
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> s:
            <span class="org-keyword">if</span> x <span class="org-operator">==</span> <span class="org-string">"0"</span>:
                <span class="org-variable-name">dp</span>[0] <span class="org-operator">+=</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">dp</span>[1] <span class="org-operator">=</span> <span class="org-builtin">max</span>(dp[0], dp[1]) <span class="org-operator">+</span> 1
        <span class="org-keyword">return</span> <span class="org-builtin">len</span>(s) <span class="org-operator">-</span> <span class="org-builtin">max</span>(dp)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000082" class="outline-3">
<h3 id="org0000082"><span class="section-number-3">1.11.</span> Matrix</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-org000007f" class="outline-4">
<h4 id="org000007f"><span class="section-number-4">1.11.1.</span> Rotate Image</h4>
<div class="outline-text-4" id="text-1-11-1">
<p>
<a href="https://leetcode.com/problems/rotate-image/">https://leetcode.com/problems/rotate-image/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">rotate</span>(<span class="org-keyword">self</span>, matrix: List[List[<span class="org-builtin">int</span>]]) <span class="org-operator">-&gt;</span> <span class="org-constant">None</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Do not return anything, modify matrix in-place instead.</span>
<span class="org-doc">        """</span>

        <span class="org-keyword">def</span> <span class="org-function-name">transpose</span>(matrix):
            <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(matrix)
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                <span class="org-comment-delimiter"># </span><span class="org-comment">NOTE: inplace transpose &#26102;&#27880;&#24847; j &#30340;&#33539;&#22260;</span>
                <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i, N):
                    matrix[i][j], matrix[j][i] <span class="org-operator">=</span> matrix[j][i], matrix[i][j]

        <span class="org-keyword">def</span> <span class="org-function-name">reverse</span>(matrix):
            <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(matrix)
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N <span class="org-operator">//</span> 2):
                <span class="org-variable-name">matrix</span>[<span class="org-variable-name">i</span>], <span class="org-variable-name">matrix</span>[N <span class="org-operator">-</span> 1 <span class="org-operator">-</span> i] <span class="org-operator">=</span> matrix[N <span class="org-operator">-</span> 1 <span class="org-operator">-</span> i], matrix[i]

        reverse(matrix)
        transpose(matrix)

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org000008e" class="outline-3">
<h3 id="org000008e"><span class="section-number-3">1.12.</span> Monotonic Stack</h3>
<div class="outline-text-3" id="text-1-12">
<p>
mono stack 通常用来处理序列上的 first larger/smaller 的问题, 其代码框架为:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
    <span class="org-comment-delimiter"># </span><span class="org-comment">&gt; &#23545;&#24212; first larger &#31867;&#30340;&#38382;&#39064;</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">&lt; &#23545;&#24212; first smaller &#31867;&#30340;&#38382;&#39064;</span>
    <span class="org-keyword">while</span> stack <span class="org-keyword">and</span> nums[i] <span class="org-operator">&gt;</span> stack[<span class="org-operator">-</span>1]:
        stack.pop()
    stack.append(i)
</pre>
</div>
</div>

<div id="outline-container-org0000085" class="outline-4">
<h4 id="org0000085"><span class="section-number-4">1.12.1.</span> Daily Temperatures</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
<a href="https://leetcode.com/problems/daily-temperatures/">https://leetcode.com/problems/daily-temperatures/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">dailyTemperatures</span>(<span class="org-keyword">self</span>, temperatures: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">int</span>]:
        <span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(temperatures)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            <span class="org-keyword">while</span> stack <span class="org-keyword">and</span> temperatures[i] <span class="org-operator">&gt;</span> temperatures[stack[<span class="org-operator">-</span>1]]:
                <span class="org-variable-name">t</span> <span class="org-operator">=</span> stack.pop()
                <span class="org-variable-name">ans</span>[t] <span class="org-operator">=</span> i <span class="org-operator">-</span> t
            stack.append(i)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org0000088" class="outline-4">
<h4 id="org0000088"><span class="section-number-4">1.12.2.</span> Sum of Subarray Minimums</h4>
<div class="outline-text-4" id="text-1-12-2">
<p>
<a href="https://leetcode.com/problems/sum-of-subarray-minimums/">https://leetcode.com/problems/sum-of-subarray-minimums/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">sumSubarrayMins</span>(<span class="org-keyword">self</span>, arr: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-comment-delimiter"># </span><span class="org-comment">3 1 2 4</span>
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(arr)

        <span class="org-variable-name">left</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            <span class="org-keyword">while</span> stack <span class="org-keyword">and</span> arr[i] <span class="org-operator">&lt;=</span> arr[stack[<span class="org-operator">-</span>1]]:
                stack.pop()
            <span class="org-variable-name">left</span>[i] <span class="org-operator">=</span> stack[<span class="org-operator">-</span>1] <span class="org-keyword">if</span> stack <span class="org-keyword">else</span> <span class="org-operator">-</span>1
            stack.append(i)

        <span class="org-variable-name">right</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N)]
        <span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">reversed</span>(<span class="org-builtin">range</span>(N)):
            <span class="org-keyword">while</span> stack <span class="org-keyword">and</span> arr[i] <span class="org-operator">&lt;</span> arr[stack[<span class="org-operator">-</span>1]]:
                stack.pop()
            <span class="org-variable-name">right</span>[i] <span class="org-operator">=</span> stack[<span class="org-operator">-</span>1] <span class="org-keyword">if</span> stack <span class="org-keyword">else</span> N
            stack.append(i)

        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
            <span class="org-variable-name">ans</span> <span class="org-operator">+=</span> arr[i] <span class="org-operator">*</span> (i <span class="org-operator">-</span> left[i]) <span class="org-operator">*</span> (right[i] <span class="org-operator">-</span> i)
        <span class="org-keyword">return</span> ans <span class="org-operator">%</span> (10<span class="org-operator">**</span>9 <span class="org-operator">+</span> 7)
</pre>
</div>
</div>
</div>

<div id="outline-container-org000008b" class="outline-4">
<h4 id="org000008b"><span class="section-number-4">1.12.3.</span> 132 Pattern</h4>
<div class="outline-text-4" id="text-1-12-3">
<p>
<a href="https://leetcode.com/problems/132-pattern/">https://leetcode.com/problems/132-pattern/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">find132pattern</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
        <span class="org-variable-name">third</span> <span class="org-operator">=</span> <span class="org-operator">-</span>1 <span class="org-operator">&lt;&lt;</span> 31
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">reversed</span>(<span class="org-builtin">range</span>(<span class="org-builtin">len</span>(nums))):
            <span class="org-keyword">if</span> nums[i] <span class="org-operator">&lt;</span> third:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">while</span> stack <span class="org-keyword">and</span> nums[i] <span class="org-operator">&gt;</span> stack[<span class="org-operator">-</span>1]:
                <span class="org-variable-name">third</span> <span class="org-operator">=</span> stack.pop()
            stack.append(nums[i])
        <span class="org-keyword">return</span> <span class="org-constant">False</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0000094" class="outline-3">
<h3 id="org0000094"><span class="section-number-3">1.13.</span> Recursive</h3>
<div class="outline-text-3" id="text-1-13">
</div>
<div id="outline-container-org0000091" class="outline-4">
<h4 id="org0000091"><span class="section-number-4">1.13.1.</span> Minimum Cost For Tickets</h4>
<div class="outline-text-4" id="text-1-13-1">
<p>
<a href="https://leetcode.com/problems/minimum-cost-for-tickets/">https://leetcode.com/problems/minimum-cost-for-tickets/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">mincostTickets</span>(<span class="org-keyword">self</span>, days: List[<span class="org-builtin">int</span>], costs: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(days)

        <span class="org-type">@cache</span>
        <span class="org-keyword">def</span> <span class="org-function-name">solve</span>(start):
            <span class="org-keyword">if</span> start <span class="org-operator">&gt;=</span> N:
                <span class="org-keyword">return</span> 0

            <span class="org-variable-name">A</span> <span class="org-operator">=</span> costs[0] <span class="org-operator">+</span> solve(start <span class="org-operator">+</span> 1)

            <span class="org-variable-name">idx</span> <span class="org-operator">=</span> bisect_left(days, days[start] <span class="org-operator">+</span> 7)
            <span class="org-variable-name">B</span> <span class="org-operator">=</span> costs[1] <span class="org-operator">+</span> solve(idx)

            <span class="org-variable-name">idx</span> <span class="org-operator">=</span> bisect_left(days, days[start] <span class="org-operator">+</span> 30)
            <span class="org-variable-name">C</span> <span class="org-operator">=</span> costs[2] <span class="org-operator">+</span> solve(idx)

            <span class="org-keyword">return</span> <span class="org-builtin">min</span>(A, B, C)

        <span class="org-keyword">return</span> solve(0)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000a6" class="outline-3">
<h3 id="org00000a6"><span class="section-number-3">1.14.</span> Sliding Window</h3>
<div class="outline-text-3" id="text-1-14">
<p>
sliding window 的代码的一般框架为:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">lo</span><span class="org-operator">=</span>0
<span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>():
  <span class="org-comment-delimiter"># </span><span class="org-comment">update with nums[hi]</span>
  <span class="org-keyword">while</span> cond:
      <span class="org-comment-delimiter"># </span><span class="org-comment">update with nums[lo]</span>
      <span class="org-variable-name">lo</span><span class="org-operator">+=</span>1
</pre>
</div>
</div>

<div id="outline-container-org0000097" class="outline-4">
<h4 id="org0000097"><span class="section-number-4">1.14.1.</span> Substring with Concatenation of All Words</h4>
<div class="outline-text-4" id="text-1-14-1">
<p>
<a href="https://leetcode.com/problems/substring-with-concatenation-of-all-words/">https://leetcode.com/problems/substring-with-concatenation-of-all-words/</a>
</p>

<p>
如果 words 较少, 可以生成 words 的所有组合, 并使用 map 在 s 里查找, 这里的 words
很多, 无法使用该算法
</p>

<p>
为了应用 sliding window, 无法按字符来 slide, 只能按 word 来 slide
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> Counter
<span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findSubstring</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>, words: List[<span class="org-builtin">str</span>]) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">int</span>]:
        <span class="org-variable-name">c</span> <span class="org-operator">=</span> Counter(words)
        <span class="org-variable-name">width</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(words[0])

        <span class="org-keyword">def</span> <span class="org-function-name">solve</span>(s):
            <span class="org-variable-name">x</span> <span class="org-operator">=</span> []
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(0, <span class="org-builtin">len</span>(s), width):
                x.append(s[i : i <span class="org-operator">+</span> width])
            <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(x)
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []
            <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
            <span class="org-variable-name">window</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(words)
            <span class="org-variable-name">m</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
            <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                m[x[hi]] <span class="org-operator">+=</span> 1
                <span class="org-keyword">if</span> hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1 <span class="org-operator">==</span> window:
                    <span class="org-keyword">if</span> <span class="org-builtin">all</span>([m[x] <span class="org-operator">==</span> c[x] <span class="org-keyword">for</span> x <span class="org-keyword">in</span> c.keys()]):
                        ans.append(lo <span class="org-operator">*</span> width)
                    m[x[lo]] <span class="org-operator">-=</span> 1
                    <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
            <span class="org-keyword">return</span> ans

        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(width):
            ans.extend([x <span class="org-operator">+</span> i <span class="org-keyword">for</span> x <span class="org-keyword">in</span> solve(s[i:])])
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org000009a" class="outline-4">
<h4 id="org000009a"><span class="section-number-4">1.14.2.</span> Longest Repeating Character Replacement</h4>
<div class="outline-text-4" id="text-1-14-2">
<p>
<a href="https://leetcode.com/problems/longest-repeating-character-replacement/">https://leetcode.com/problems/longest-repeating-character-replacement/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">test</span>(<span class="org-keyword">self</span>, counter, k):
        <span class="org-variable-name">x</span> <span class="org-operator">=</span> <span class="org-builtin">list</span>(counter.values())
        <span class="org-keyword">return</span> <span class="org-builtin">sum</span>(x) <span class="org-operator">-</span> <span class="org-builtin">max</span>(x) <span class="org-operator">==</span> k <span class="org-operator">+</span> 1

    <span class="org-keyword">def</span> <span class="org-function-name">characterReplacement</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>, k: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">counter</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(s)):
            <span class="org-variable-name">x</span> <span class="org-operator">=</span> s[hi]
            <span class="org-variable-name">counter</span>[x] <span class="org-operator">+=</span> 1
            <span class="org-keyword">while</span> <span class="org-keyword">self</span>.test(counter, k):
                counter[s[lo]] <span class="org-operator">-=</span> 1
                <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1)
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org000009d" class="outline-4">
<h4 id="org000009d"><span class="section-number-4">1.14.3.</span> Longest Substring with At Least K Repeating Characters</h4>
<div class="outline-text-4" id="text-1-14-3">
<p>
<a href="https://leetcode.com/problems/longest-substring-with-at-least-k-repeating-characters/">https://leetcode.com/problems/longest-substring-with-at-least-k-repeating-characters/</a>
</p>

<p>
正常的 sliding window 无法工作: at most k 可以工作, 但 at least k 不可以. 通过添加一个额外的 max char 条件让 sliding windows 可以工作
</p>

<p>
<a href="https://leetcode.com/problems/longest-substring-with-at-least-k-repeating-characters/solutions/2821874/why-sliding-window-works-for-this-qustion-and-how-it-works-simple-analysis/">solution</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict
<span class="org-keyword">from</span> collections <span class="org-keyword">import</span> Counter


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">longestSubstring</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>, k: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">maxChar</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(Counter(s))
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, maxChar <span class="org-operator">+</span> 1):
            <span class="org-variable-name">uniqueCounter</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
            <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
            <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(s)):
                uniqueCounter[s[hi]] <span class="org-operator">+=</span> 1
                <span class="org-keyword">while</span> <span class="org-builtin">len</span>(uniqueCounter) <span class="org-operator">&gt;</span> i:
                    uniqueCounter[s[lo]] <span class="org-operator">-=</span> 1
                    <span class="org-keyword">if</span> uniqueCounter[s[lo]] <span class="org-operator">==</span> 0:
                        uniqueCounter.pop(s[lo])
                    <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
                <span class="org-keyword">if</span> <span class="org-builtin">all</span>([x <span class="org-operator">&gt;=</span> k <span class="org-keyword">for</span> x <span class="org-keyword">in</span> uniqueCounter.values()]):
                    <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1)
            <span class="org-keyword">if</span> <span class="org-builtin">all</span>([x <span class="org-operator">&gt;=</span> k <span class="org-keyword">for</span> x <span class="org-keyword">in</span> uniqueCounter.values()]):
                <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000a0" class="outline-4">
<h4 id="org00000a0"><span class="section-number-4">1.14.4.</span> Longest Nice Subarray</h4>
<div class="outline-text-4" id="text-1-14-4">
<p>
<a href="https://leetcode.com/problems/longest-nice-subarray/">https://leetcode.com/problems/longest-nice-subarray/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">longestNiceSubarray</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">used</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(nums)):
            <span class="org-keyword">while</span> used <span class="org-operator">&amp;</span> nums[hi] <span class="org-operator">!=</span> 0:
                <span class="org-variable-name">used</span> <span class="org-operator">^=</span> nums[lo]
                <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
            <span class="org-variable-name">used</span> <span class="org-operator">|=</span> nums[hi]
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000a3" class="outline-4">
<h4 id="org00000a3"><span class="section-number-4">1.14.5.</span> Count Complete Subarrays in an Array</h4>
<div class="outline-text-4" id="text-1-14-5">
<p>
<a href="https://leetcode.com/problems/count-complete-subarrays-in-an-array/">https://leetcode.com/problems/count-complete-subarrays-in-an-array/</a>
</p>

<p>
当 window 中不同的元素个数达到 b 时, 感觉并不能开始 shrink, 因为 hi 还能增长. 但实际上后续 N-hi 个位置不需要判断, 因为它们肯定是符合条件的
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">countCompleteSubarrays</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">b</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>(nums)
        <span class="org-variable-name">a</span> <span class="org-operator">=</span> defaultdict(<span class="org-builtin">int</span>)
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(nums)):
            a[nums[hi]] <span class="org-operator">+=</span> 1
            <span class="org-keyword">while</span> <span class="org-builtin">set</span>(a.keys()) <span class="org-operator">==</span> b:
                <span class="org-variable-name">ans</span> <span class="org-operator">+=</span> <span class="org-builtin">len</span>(nums) <span class="org-operator">-</span> hi
                a[nums[lo]] <span class="org-operator">-=</span> 1
                <span class="org-keyword">if</span> a[nums[lo]] <span class="org-operator">==</span> 0:
                    a.pop(nums[lo])
                <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000ad" class="outline-3">
<h3 id="org00000ad"><span class="section-number-3">1.15.</span> Stack</h3>
<div class="outline-text-3" id="text-1-15">
</div>
<div id="outline-container-org00000aa" class="outline-4">
<h4 id="org00000aa"><span class="section-number-4">1.15.1.</span> Basic Calculator</h4>
<div class="outline-text-4" id="text-1-15-1">
<p>
<a href="https://leetcode.com/problems/basic-calculator">https://leetcode.com/problems/basic-calculator</a>
</p>

<p>
简单的计算器不需要使用 stack, 例如 1+2-3, 其代码大约是:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">solve</span>(tokens):
    <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
    <span class="org-variable-name">sign</span> <span class="org-operator">=</span> 1
    <span class="org-keyword">for</span> x <span class="org-keyword">in</span> tokens:
        <span class="org-keyword">if</span> x <span class="org-operator">==</span> <span class="org-string">"+"</span>:
            <span class="org-variable-name">sign</span> <span class="org-operator">=</span> 1
        <span class="org-keyword">elif</span> x <span class="org-operator">==</span> <span class="org-string">"-"</span>:
            <span class="org-variable-name">sign</span> <span class="org-operator">=</span> <span class="org-operator">-</span>1
        <span class="org-keyword">else</span>:
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">int</span>(x) <span class="org-operator">*</span> sign
    <span class="org-keyword">return</span> ans
</pre>
</div>

<ol class="org-ol">
<li><p>
使用 stack 来处理乘除法的优化级:
</p>

<p>
例如针对 1+2*3, stack 的情况为:
</p>

<pre class="example" id="org00000a9">
[1] -&gt; [1,2] -&gt; [1, 2, 3] -&gt; [1, 6]
</pre></li>

<li>使用 stack 找到对应的括号</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">calculate</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-keyword">def</span> <span class="org-function-name">getTokens</span>(s):
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []
            <span class="org-variable-name">i</span> <span class="org-operator">=</span> 0
            <span class="org-variable-name">digit</span> <span class="org-operator">=</span> <span class="org-string">""</span>
            <span class="org-keyword">while</span> i <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(s):
                <span class="org-keyword">if</span> s[i] <span class="org-operator">==</span> <span class="org-string">" "</span>:
                    <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
                    <span class="org-keyword">continue</span>
                <span class="org-keyword">if</span> s[i].isdigit():
                    <span class="org-keyword">while</span> i <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(s) <span class="org-keyword">and</span> s[i].isdigit():
                        <span class="org-variable-name">digit</span> <span class="org-operator">+=</span> s[i]
                        <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
                    ans.append(digit)
                    <span class="org-variable-name">digit</span> <span class="org-operator">=</span> <span class="org-string">""</span>
                <span class="org-keyword">elif</span> s[i] <span class="org-keyword">in</span> <span class="org-string">"+-*/"</span>:
                    ans.append(s[i])
                    <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
                <span class="org-keyword">else</span>:
                    <span class="org-variable-name">balance</span> <span class="org-operator">=</span> 0
                    <span class="org-variable-name">tmp</span> <span class="org-operator">=</span> <span class="org-string">""</span>
                    <span class="org-keyword">while</span> <span class="org-constant">True</span>:
                        <span class="org-keyword">if</span> s[i] <span class="org-operator">==</span> <span class="org-string">"("</span>:
                            <span class="org-variable-name">balance</span> <span class="org-operator">+=</span> 1
                        <span class="org-keyword">elif</span> s[i] <span class="org-operator">==</span> <span class="org-string">")"</span>:
                            <span class="org-variable-name">balance</span> <span class="org-operator">-=</span> 1
                        <span class="org-variable-name">tmp</span> <span class="org-operator">+=</span> s[i]
                        <span class="org-variable-name">i</span> <span class="org-operator">+=</span> 1
                        <span class="org-keyword">if</span> balance <span class="org-operator">==</span> 0:
                            ans.append(getTokens(tmp[1:<span class="org-operator">-</span>1]))
                            <span class="org-keyword">break</span>
            <span class="org-keyword">return</span> ans

        <span class="org-keyword">def</span> <span class="org-function-name">solve</span>(tokens):
            <span class="org-variable-name">sign</span> <span class="org-operator">=</span> 1
            <span class="org-variable-name">times</span> <span class="org-operator">=</span> 0
            <span class="org-variable-name">divid</span> <span class="org-operator">=</span> 0
            <span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
            <span class="org-keyword">for</span> x <span class="org-keyword">in</span> tokens:
                <span class="org-keyword">if</span> x <span class="org-operator">==</span> <span class="org-string">"+"</span>:
                    <span class="org-variable-name">sign</span> <span class="org-operator">=</span> 1
                <span class="org-keyword">elif</span> x <span class="org-operator">==</span> <span class="org-string">"-"</span>:
                    <span class="org-variable-name">sign</span> <span class="org-operator">=</span> <span class="org-operator">-</span>1
                <span class="org-keyword">elif</span> x <span class="org-operator">==</span> <span class="org-string">"*"</span>:
                    <span class="org-variable-name">times</span> <span class="org-operator">=</span> 1
                <span class="org-keyword">elif</span> x <span class="org-operator">==</span> <span class="org-string">"-"</span>:
                    <span class="org-variable-name">divid</span> <span class="org-operator">=</span> 1
                <span class="org-keyword">else</span>:
                    <span class="org-keyword">if</span> <span class="org-builtin">isinstance</span>(x, <span class="org-builtin">list</span>):
                        stack.append(solve(x) <span class="org-operator">*</span> sign)
                    <span class="org-keyword">elif</span> x.isdigit():
                        stack.append(<span class="org-builtin">int</span>(x) <span class="org-operator">*</span> sign)
                    <span class="org-keyword">if</span> times <span class="org-operator">==</span> 1:
                        stack.append(stack.pop() <span class="org-operator">*</span> stack.pop())
                        <span class="org-variable-name">times</span> <span class="org-operator">=</span> 0
                    <span class="org-keyword">if</span> divid <span class="org-operator">==</span> 1:
                        <span class="org-variable-name">b</span>, <span class="org-variable-name">a</span> <span class="org-operator">=</span> stack.pop(), stack.pop()
                        stack.append(a <span class="org-operator">/</span> b)
                        <span class="org-variable-name">divid</span> <span class="org-operator">=</span> 0
            <span class="org-keyword">return</span> <span class="org-builtin">sum</span>(stack)

        <span class="org-keyword">return</span> solve(getTokens(s))


<span class="org-keyword">if</span> <span class="org-builtin">__name__</span> <span class="org-operator">==</span> <span class="org-string">"__main__"</span>:
    <span class="org-variable-name">S</span> <span class="org-operator">=</span> Solution()
    <span class="org-builtin">print</span>(S.calculate(<span class="org-string">"1+2*2*(1+1*2)+3+(-1)*(-1-1)*(-2)"</span>))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000b9" class="outline-3">
<h3 id="org00000b9"><span class="section-number-3">1.16.</span> Tree</h3>
<div class="outline-text-3" id="text-1-16">
</div>
<div id="outline-container-org00000b0" class="outline-4">
<h4 id="org00000b0"><span class="section-number-4">1.16.1.</span> BST Iterator</h4>
<div class="outline-text-4" id="text-1-16-1">
<p>
<a href="https://leetcode.com/problems/binary-search-tree-iterator/">https://leetcode.com/problems/binary-search-tree-iterator/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">BSTIterator</span>:

    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>, root: Optional[TreeNode]):
        <span class="org-keyword">self</span>.<span class="org-variable-name">stack</span> <span class="org-operator">=</span> []
        <span class="org-variable-name">curr</span> <span class="org-operator">=</span> root
        <span class="org-keyword">while</span> curr:
            <span class="org-keyword">self</span>.stack.append(curr)
            <span class="org-variable-name">curr</span> <span class="org-operator">=</span> curr.left

    <span class="org-keyword">def</span> <span class="org-function-name">next</span>(<span class="org-keyword">self</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">top</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.stack.pop()
        <span class="org-variable-name">curr</span> <span class="org-operator">=</span> top.right
        <span class="org-keyword">while</span> curr:
            <span class="org-keyword">self</span>.stack.append(curr)
            <span class="org-variable-name">curr</span> <span class="org-operator">=</span> curr.left
        <span class="org-keyword">return</span> top.val

    <span class="org-keyword">def</span> <span class="org-function-name">hasNext</span>(<span class="org-keyword">self</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-keyword">return</span> <span class="org-builtin">len</span>(<span class="org-keyword">self</span>.stack) <span class="org-operator">!=</span> 0
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000b3" class="outline-4">
<h4 id="org00000b3"><span class="section-number-4">1.16.2.</span> Symmetric Tree</h4>
<div class="outline-text-4" id="text-1-16-2">
<p>
<a href="https://leetcode.com/problems/symmetric-tree/">https://leetcode.com/problems/symmetric-tree/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">isSymmetric</span>(<span class="org-keyword">self</span>, root: Optional[TreeNode]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-keyword">def</span> <span class="org-function-name">same</span>(a, b):
            <span class="org-keyword">if</span> <span class="org-keyword">not</span> a <span class="org-keyword">and</span> <span class="org-keyword">not</span> b:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">if</span> <span class="org-keyword">not</span> a <span class="org-keyword">or</span> <span class="org-keyword">not</span> b:
                <span class="org-keyword">return</span> <span class="org-constant">False</span>
            <span class="org-keyword">return</span> a.val <span class="org-operator">==</span> b.val <span class="org-keyword">and</span> same(a.left, b.right) <span class="org-keyword">and</span> same(a.right, b.left)

        <span class="org-keyword">return</span> same(root.left, root.right)
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000b6" class="outline-4">
<h4 id="org00000b6"><span class="section-number-4">1.16.3.</span> Validate BST</h4>
<div class="outline-text-4" id="text-1-16-3">
<p>
<a href="https://leetcode.com/problems/validate-binary-search-tree/">https://leetcode.com/problems/validate-binary-search-tree/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">isValidBST</span>(<span class="org-keyword">self</span>, root: Optional[TreeNode]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-keyword">def</span> <span class="org-function-name">check</span>(root):
            <span class="org-variable-name">MIN</span>, <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> root.val, root.val
            <span class="org-keyword">if</span> root.left:
                <span class="org-variable-name">ans</span>, <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> check(root.left)
                <span class="org-keyword">if</span> <span class="org-keyword">not</span> ans:
                    <span class="org-keyword">return</span> <span class="org-constant">False</span>, 0, 0
                <span class="org-keyword">if</span> root.val <span class="org-operator">&lt;=</span> y:
                    <span class="org-keyword">return</span> <span class="org-constant">False</span>, 0, 0
                <span class="org-variable-name">MIN</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(MIN, x)
                <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(MAX, y)
            <span class="org-keyword">if</span> root.right:
                <span class="org-variable-name">ans</span>, <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> check(root.right)
                <span class="org-keyword">if</span> <span class="org-keyword">not</span> ans:
                    <span class="org-keyword">return</span> <span class="org-constant">False</span>, 0, 0
                <span class="org-keyword">if</span> root.val <span class="org-operator">&gt;=</span> x:
                    <span class="org-keyword">return</span> <span class="org-constant">False</span>, 0, 0
                <span class="org-variable-name">MIN</span> <span class="org-operator">=</span> <span class="org-builtin">min</span>(MIN, x)
                <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(MAX, y)
            <span class="org-keyword">return</span> <span class="org-constant">True</span>, MIN, MAX

        <span class="org-keyword">if</span> <span class="org-keyword">not</span> root:
            <span class="org-keyword">return</span> <span class="org-constant">True</span>
        <span class="org-variable-name">ans</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span> <span class="org-operator">=</span> check(root)
        <span class="org-keyword">return</span> ans
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">isValidBST</span>(<span class="org-keyword">self</span>, root: Optional[TreeNode]) <span class="org-operator">-&gt;</span> <span class="org-builtin">bool</span>:
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> []

        <span class="org-keyword">def</span> <span class="org-function-name">inorder</span>(root):
            <span class="org-keyword">if</span> <span class="org-keyword">not</span> root:
                <span class="org-keyword">return</span>
            inorder(root.left)
            ans.append(root.val)
            inorder(root.right)

        <span class="org-keyword">def</span> <span class="org-function-name">isSorted</span>(nums):
            <span class="org-keyword">if</span> <span class="org-builtin">len</span>(nums) <span class="org-operator">&lt;=</span> 1:
                <span class="org-keyword">return</span> <span class="org-constant">True</span>
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1, <span class="org-builtin">len</span>(nums)):
                <span class="org-keyword">if</span> nums[i] <span class="org-operator">&lt;=</span> nums[i <span class="org-operator">-</span> 1]:
                    <span class="org-keyword">return</span> <span class="org-constant">False</span>
            <span class="org-keyword">return</span> <span class="org-constant">True</span>

        inorder(root)
        <span class="org-keyword">return</span> isSorted(ans)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000cb" class="outline-3">
<h3 id="org00000cb"><span class="section-number-3">1.17.</span> Trick</h3>
<div class="outline-text-3" id="text-1-17">
</div>
<div id="outline-container-org00000bc" class="outline-4">
<h4 id="org00000bc"><span class="section-number-4">1.17.1.</span> Pow</h4>
<div class="outline-text-4" id="text-1-17-1">
<p>
<a href="https://leetcode.com/problems/powx-n/">https://leetcode.com/problems/powx-n/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">myPow</span>(<span class="org-keyword">self</span>, x: <span class="org-builtin">float</span>, n: <span class="org-builtin">int</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">float</span>:
        <span class="org-keyword">if</span> n <span class="org-operator">&lt;</span> 0:
            <span class="org-variable-name">n</span> <span class="org-operator">=</span> <span class="org-operator">-</span>n
            <span class="org-variable-name">x</span> <span class="org-operator">=</span> 1 <span class="org-operator">/</span> x
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 1
        <span class="org-keyword">while</span> n <span class="org-operator">&gt;</span> 1:
            <span class="org-keyword">if</span> n <span class="org-operator">%</span> 2 <span class="org-operator">==</span> 1:
                <span class="org-variable-name">ans</span> <span class="org-operator">*=</span> x
                <span class="org-variable-name">n</span> <span class="org-operator">-=</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">x</span> <span class="org-operator">*=</span> x
                <span class="org-variable-name">n</span> <span class="org-operator">/=</span> 2
        <span class="org-keyword">return</span> ans <span class="org-operator">*</span> x
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000bf" class="outline-4">
<h4 id="org00000bf"><span class="section-number-4">1.17.2.</span> Roman To Integer</h4>
<div class="outline-text-4" id="text-1-17-2">
<p>
<a href="https://leetcode.com/problems/roman-to-integer/">https://leetcode.com/problems/roman-to-integer/</a>
</p>

<p>
假定输入是合法的. IIV 的值是是 V-I-I = 3, 因为较小的 I 出现在较大的 V 的左边
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">romanToInt</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">m</span> <span class="org-operator">=</span> {<span class="org-string">"I"</span>: 1, <span class="org-string">"V"</span>: 5, <span class="org-string">"X"</span>: 10, <span class="org-string">"L"</span>: 50, <span class="org-string">"C"</span>: 100, <span class="org-string">"D"</span>: 500, <span class="org-string">"M"</span>: 1000}
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> 1
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> s[::<span class="org-operator">-</span>1]:
            <span class="org-variable-name">v</span> <span class="org-operator">=</span> m[x]
            <span class="org-keyword">if</span> v <span class="org-operator">&gt;=</span> MAX:
                <span class="org-variable-name">ans</span> <span class="org-operator">+=</span> v
                <span class="org-variable-name">MAX</span> <span class="org-operator">=</span> v
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">ans</span> <span class="org-operator">-=</span> v
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000c2" class="outline-4">
<h4 id="org00000c2"><span class="section-number-4">1.17.3.</span> Minimize Maximum of Array</h4>
<div class="outline-text-4" id="text-1-17-3">
<p>
<a href="https://leetcode.com/problems/minimize-maximum-of-array/">https://leetcode.com/problems/minimize-maximum-of-array/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">minimizeArrayValue</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">total</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> i, v <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(nums):
            <span class="org-variable-name">total</span> <span class="org-operator">+=</span> v
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, math.ceil(total <span class="org-operator">/</span> (i <span class="org-operator">+</span> 1)))
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000c5" class="outline-4">
<h4 id="org00000c5"><span class="section-number-4">1.17.4.</span> Count Negative Numbers in a Sorted Matrix</h4>
<div class="outline-text-4" id="text-1-17-4">
<p>
<a href="https://leetcode.com/problems/count-negative-numbers-in-a-sorted-matrix/">https://leetcode.com/problems/count-negative-numbers-in-a-sorted-matrix/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">countNegatives</span>(<span class="org-keyword">self</span>, grid: List[List[<span class="org-builtin">int</span>]]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(grid), <span class="org-builtin">len</span>(grid[0])
        <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span> <span class="org-operator">=</span> 0, N <span class="org-operator">-</span> 1
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">while</span> x <span class="org-operator">&lt;</span> M <span class="org-keyword">and</span> y <span class="org-operator">&gt;=</span> 0:
            <span class="org-keyword">if</span> grid[x][y] <span class="org-operator">&gt;=</span> 0:
                <span class="org-variable-name">x</span> <span class="org-operator">+=</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-variable-name">ans</span> <span class="org-operator">+=</span> M <span class="org-operator">-</span> x
                <span class="org-variable-name">y</span> <span class="org-operator">-=</span> 1
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000c8" class="outline-4">
<h4 id="org00000c8"><span class="section-number-4">1.17.5.</span> Count of Smaller Numbers After Self</h4>
<div class="outline-text-4" id="text-1-17-5">
<p>
<a href="https://leetcode.com/problems/count-of-smaller-numbers-after-self/">https://leetcode.com/problems/count-of-smaller-numbers-after-self/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">countSmaller</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">int</span>]:
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> [0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(nums))]

        <span class="org-keyword">def</span> <span class="org-function-name">mergeSort</span>(nums):
            <span class="org-comment-delimiter"># </span><span class="org-comment">5 2 6 1</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">2 5 | 1 6</span>
            <span class="org-keyword">if</span> <span class="org-builtin">len</span>(nums) <span class="org-operator">&lt;=</span> 1:
                <span class="org-keyword">return</span> nums
            <span class="org-variable-name">mid</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(nums) <span class="org-operator">//</span> 2
            <span class="org-variable-name">a</span> <span class="org-operator">=</span> mergeSort(nums[:mid])
            <span class="org-variable-name">b</span> <span class="org-operator">=</span> mergeSort(nums[mid:])

            <span class="org-variable-name">hi</span> <span class="org-operator">=</span> 0
            <span class="org-keyword">for</span> lo <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(a)):
                <span class="org-keyword">while</span> hi <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(b) <span class="org-keyword">and</span> a[lo][1] <span class="org-operator">&gt;</span> b[hi][1]:
                    <span class="org-variable-name">hi</span> <span class="org-operator">+=</span> 1
                ans[a[lo][0]] <span class="org-operator">+=</span> hi

            <span class="org-variable-name">ret</span> <span class="org-operator">=</span> []
            <span class="org-variable-name">ai</span>, <span class="org-variable-name">bi</span> <span class="org-operator">=</span> 0, 0
            <span class="org-keyword">while</span> ai <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(a) <span class="org-keyword">or</span> bi <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(b):
                <span class="org-variable-name">x</span> <span class="org-operator">=</span> a[ai][1] <span class="org-keyword">if</span> ai <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(a) <span class="org-keyword">else</span> 1 <span class="org-operator">&lt;&lt;</span> 31
                <span class="org-variable-name">y</span> <span class="org-operator">=</span> b[bi][1] <span class="org-keyword">if</span> bi <span class="org-operator">&lt;</span> <span class="org-builtin">len</span>(b) <span class="org-keyword">else</span> 1 <span class="org-operator">&lt;&lt;</span> 31
                <span class="org-keyword">if</span> x <span class="org-operator">&lt;=</span> y:
                    ret.append(a[ai])
                    <span class="org-variable-name">ai</span> <span class="org-operator">+=</span> 1
                <span class="org-keyword">else</span>:
                    ret.append(b[bi])
                    <span class="org-variable-name">bi</span> <span class="org-operator">+=</span> 1
            <span class="org-keyword">return</span> ret

        mergeSort([(i, a) <span class="org-keyword">for</span> i, a <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(nums)])
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000d1" class="outline-3">
<h3 id="org00000d1"><span class="section-number-3">1.18.</span> Trie</h3>
<div class="outline-text-3" id="text-1-18">
</div>
<div id="outline-container-org00000ce" class="outline-4">
<h4 id="org00000ce"><span class="section-number-4">1.18.1.</span> Word Search II</h4>
<div class="outline-text-4" id="text-1-18-1">
<p>
<a href="https://leetcode.com/problems/word-search-ii/">https://leetcode.com/problems/word-search-ii/</a>
</p>

<p>
若直接使用 backtracking, 需要针对每个 word 都做一遍 backtracking, 或者
backtracking 时判断当前 prefix 是否是某些 word 的前缀. 通过 trie 树可以快速完成这个判断
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Node</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>):
        <span class="org-keyword">self</span>.<span class="org-variable-name">children</span> <span class="org-operator">=</span> {}
        <span class="org-keyword">self</span>.<span class="org-variable-name">word</span> <span class="org-operator">=</span> <span class="org-constant">None</span>


<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findWords</span>(<span class="org-keyword">self</span>, board: List[List[<span class="org-builtin">str</span>]], words: List[<span class="org-builtin">str</span>]) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">str</span>]:
        <span class="org-keyword">def</span> <span class="org-function-name">addWord</span>(root, word):
            <span class="org-keyword">for</span> w <span class="org-keyword">in</span> word:
                <span class="org-keyword">if</span> w <span class="org-keyword">not</span> <span class="org-keyword">in</span> root.children:
                    root.<span class="org-variable-name">children</span>[w] <span class="org-operator">=</span> Node()
                <span class="org-variable-name">root</span> <span class="org-operator">=</span> root.children[w]
            root.<span class="org-variable-name">word</span> <span class="org-operator">=</span> word

        <span class="org-variable-name">trie</span> <span class="org-operator">=</span> Node()
        <span class="org-keyword">for</span> word <span class="org-keyword">in</span> words:
            addWord(trie, word)

        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-variable-name">visited</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-variable-name">M</span>, <span class="org-variable-name">N</span> <span class="org-operator">=</span> <span class="org-builtin">len</span>(board), <span class="org-builtin">len</span>(board[0])

        <span class="org-keyword">def</span> <span class="org-function-name">dfs</span>(x, y, root):
            <span class="org-keyword">if</span> x <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> x <span class="org-operator">&gt;=</span> M <span class="org-keyword">or</span> y <span class="org-operator">&lt;</span> 0 <span class="org-keyword">or</span> y <span class="org-operator">&gt;=</span> N:
                <span class="org-keyword">return</span>
            <span class="org-keyword">if</span> board[x][y] <span class="org-keyword">not</span> <span class="org-keyword">in</span> root.children:
                <span class="org-keyword">return</span>
            <span class="org-keyword">if</span> (x, y) <span class="org-keyword">in</span> visited:
                <span class="org-keyword">return</span>
            visited.add((x, y))
            <span class="org-variable-name">root</span> <span class="org-operator">=</span> root.children[board[x][y]]
            <span class="org-keyword">if</span> root.word:
                ans.add(root.word)
            <span class="org-keyword">for</span> xx, yy <span class="org-keyword">in</span> [[0, 1], [0, <span class="org-operator">-</span>1], [1, 0], [<span class="org-operator">-</span>1, 0]]:
                dfs(x <span class="org-operator">+</span> xx, y <span class="org-operator">+</span> yy, root)
            visited.remove((x, y))

        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(M):
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N):
                dfs(x, y, trie)

        <span class="org-keyword">return</span> <span class="org-builtin">list</span>(ans)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000da" class="outline-3">
<h3 id="org00000da"><span class="section-number-3">1.19.</span> Two Pointers</h3>
<div class="outline-text-3" id="text-1-19">
</div>
<div id="outline-container-org00000d4" class="outline-4">
<h4 id="org00000d4"><span class="section-number-4">1.19.1.</span> Heaters</h4>
<div class="outline-text-4" id="text-1-19-1">
<p>
<a href="https://leetcode.com/problems/heaters/">https://leetcode.com/problems/heaters/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findRadius</span>(<span class="org-keyword">self</span>, houses: List[<span class="org-builtin">int</span>], heaters: List[<span class="org-builtin">int</span>]) <span class="org-operator">-&gt;</span> <span class="org-builtin">int</span>:
        houses.sort()
        heaters.sort()
        <span class="org-comment-delimiter"># </span><span class="org-comment">1 2 3 4</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">1     4</span>
        <span class="org-variable-name">hidx</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> 0
        <span class="org-keyword">for</span> h <span class="org-keyword">in</span> houses:
            <span class="org-keyword">while</span> hidx <span class="org-operator">!=</span> <span class="org-builtin">len</span>(heaters) <span class="org-operator">-</span> 1 <span class="org-keyword">and</span> <span class="org-builtin">abs</span>(h <span class="org-operator">-</span> heaters[hidx]) <span class="org-operator">&gt;=</span> <span class="org-builtin">abs</span>(
                h <span class="org-operator">-</span> heaters[hidx <span class="org-operator">+</span> 1]
            ):
                <span class="org-variable-name">hidx</span> <span class="org-operator">+=</span> 1
            <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">max</span>(ans, <span class="org-builtin">abs</span>(h <span class="org-operator">-</span> heaters[hidx]))
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
</div>

<div id="outline-container-org00000d7" class="outline-4">
<h4 id="org00000d7"><span class="section-number-4">1.19.2.</span> Remove Duplicates From Sorted Array II</h4>
<div class="outline-text-4" id="text-1-19-2">
<p>
<a href="https://leetcode.com/problems/remove-duplicates-from-sorted-array-ii/">https://leetcode.com/problems/remove-duplicates-from-sorted-array-ii/</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">removeDuplicates</span>(<span class="org-keyword">self</span>, nums):
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 2
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> nums[2:]:
            <span class="org-comment-delimiter"># </span><span class="org-comment">nums[lo - 1] != x &#20195;&#34920; lo &#35774;&#20026; x &#21518; lo-1 &#21644; lo &#19981;&#37325;&#22797;</span>
            <span class="org-comment-delimiter">#</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">nums[lo - 2] != x &#20195;&#34920; lo &#35774;&#20026; x &#21518; lo-1 &#21644; lo &#37325;&#22797;, &#20294; lo-2,</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">lo-1, lo &#19981;&#37325;&#22797;</span>
            <span class="org-comment-delimiter">#</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">&#23454;&#38469;&#19978; nums[lo - 1] != x or nums[lo - 2] != x &#21487;&#20197;&#31616;&#21270;&#20026; nums[lo -</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">2] != x</span>
            <span class="org-comment-delimiter">#</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">&#22240;&#20026; nums &#26159;&#38750;&#36882;&#20943;&#24207;&#21015;, lo-1!=x &lt;=&gt; lo-1!=x and lo-2!=x, &#25152;&#20197;</span>
            <span class="org-comment-delimiter">#</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">lo-1 !=x or lo-2!=x</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">&lt;=&gt; (lo-1!=x and lo-2!=x) or (lo-1==x and lo-2!=x)</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">&lt;=&gt; lo-2!=x and 1</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">&lt;=&gt; lo-2!=x</span>
            <span class="org-keyword">if</span> nums[lo <span class="org-operator">-</span> 1] <span class="org-operator">!=</span> x <span class="org-keyword">or</span> nums[lo <span class="org-operator">-</span> 2] <span class="org-operator">!=</span> x:
                <span class="org-variable-name">nums</span>[lo] <span class="org-operator">=</span> x
                <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">return</span> lo


<span class="org-keyword">if</span> <span class="org-builtin">__name__</span> <span class="org-operator">==</span> <span class="org-string">"__main__"</span>:
    <span class="org-variable-name">S</span> <span class="org-operator">=</span> Solution()
    <span class="org-variable-name">nums</span> <span class="org-operator">=</span> [0, 0, 1, 1, 1, 1, 2, 3, 3]
    <span class="org-keyword">assert</span> nums[: S.removeDuplicates(nums)] <span class="org-operator">==</span> [0, 0, 1, 1, 2, 3, 3]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org00000e0" class="outline-3">
<h3 id="org00000e0"><span class="section-number-3">1.20.</span> Rolling Hash</h3>
<div class="outline-text-3" id="text-1-20">
</div>
<div id="outline-container-org00000dd" class="outline-4">
<h4 id="org00000dd"><span class="section-number-4">1.20.1.</span> Repeated DNA Sequences</h4>
<div class="outline-text-4" id="text-1-20-1">
<p>
<a href="https://leetcode.com/problems/repeated-dna-sequences/">https://leetcode.com/problems/repeated-dna-sequences/</a>
</p>

<p>
robin karp
</p>

<p>
\(hash=x_0*power^(k-1)+x_1*power^(k-2)....+x_k-1*power^0\)
</p>

<p>
k 为序列的长度, power 为字符的种类. 这个公式实现是在求 `k 位 power 进制的十进制数值`, 例如这里求的是 10 位 4 进制转换为十进制
</p>

<p>
如果 hash 结果不大, 不需要进行模运算, 则不会有 hash 冲突
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
    <span class="org-keyword">def</span> <span class="org-function-name">findRepeatedDnaSequences</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>) <span class="org-operator">-&gt;</span> List[<span class="org-builtin">str</span>]:
        <span class="org-variable-name">power</span> <span class="org-operator">=</span> 4
        <span class="org-variable-name">k</span> <span class="org-operator">=</span> 10
        <span class="org-variable-name">mul</span> <span class="org-operator">=</span> power <span class="org-operator">**</span> (k <span class="org-operator">-</span> 1)

        <span class="org-variable-name">ans</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-variable-name">hashes</span> <span class="org-operator">=</span> <span class="org-builtin">set</span>()
        <span class="org-variable-name">currHash</span> <span class="org-operator">=</span> 0
        <span class="org-variable-name">lo</span> <span class="org-operator">=</span> 0

        <span class="org-variable-name">value</span> <span class="org-operator">=</span> {<span class="org-string">"A"</span>: 1, <span class="org-string">"T"</span>: 2, <span class="org-string">"C"</span>: 3, <span class="org-string">"G"</span>: 4}
        <span class="org-keyword">for</span> hi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(s)):
            <span class="org-variable-name">currHash</span> <span class="org-operator">=</span> currHash <span class="org-operator">*</span> power <span class="org-operator">+</span> value[s[hi]]
            <span class="org-keyword">if</span> hi <span class="org-operator">-</span> lo <span class="org-operator">+</span> 1 <span class="org-operator">==</span> k:
                <span class="org-keyword">if</span> currHash <span class="org-keyword">in</span> hashes:
                    ans.add(s[lo : hi <span class="org-operator">+</span> 1])
                hashes.add(currHash)
                <span class="org-variable-name">currHash</span> <span class="org-operator">-=</span> value[s[lo]] <span class="org-operator">*</span> mul
                <span class="org-variable-name">lo</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">return</span> <span class="org-builtin">list</span>(ans)
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<p class="author">Author: sunway@dogdog.run<br />
Date: 2024-04-12 Fri 16:14<br />
Last updated: 2024-05-21 Tue 16:43</p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
</div>
</body>
</html>
