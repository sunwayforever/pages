<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-01-26 Wed 11:42 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tensorflow API</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wei Sun (孙伟)" />
<link rel="stylesheet" type="text/css" href="/main.css" media="screen" />
<link rel = "icon" href = "/icon.png"  type = "image/x-icon">
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Tensorflow API</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orged4ccd7">1. Tensorflow API</a>
<ul>
<li><a href="#org10f022c">1.1. 低阶 API</a>
<ul>
<li><a href="#org13f605a">1.1.1. 生成 Tensor</a></li>
<li><a href="#orgedd57cc">1.1.2. 类型转换</a></li>
<li><a href="#org22f94f4">1.1.3. 操作大小</a></li>
<li><a href="#org43af797">1.1.4. 运算</a></li>
</ul>
</li>
<li><a href="#org2cffb57">1.2. 高阶 API</a>
<ul>
<li><a href="#orga6fd71a">1.2.1. tf.summary</a></li>
<li><a href="#org5ccf6c2">1.2.2. tf.feature_column</a></li>
<li><a href="#orgd0215cf">1.2.3. tf.keras.losses</a></li>
<li><a href="#orgaec2982">1.2.4. tf.keras.metrics</a></li>
<li><a href="#org0246425">1.2.5. tf.keras.callbacks</a></li>
<li><a href="#org0aa5ed2">1.2.6. tf.keras.models</a></li>
<li><a href="#org94b7489">1.2.7. tf.keras.optimizers</a></li>
<li><a href="#org4d7a3d2">1.2.8. tf.keras.initializers</a></li>
<li><a href="#org65565ef">1.2.9. tf.keras.regularizers</a></li>
<li><a href="#orga42e232">1.2.10. tf.nn</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orged4ccd7" class="outline-2">
<h2 id="orged4ccd7"><span class="section-number-2">1</span> Tensorflow API</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org10f022c" class="outline-3">
<h3 id="org10f022c"><span class="section-number-3">1.1</span> 低阶 API</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org13f605a" class="outline-4">
<h4 id="org13f605a"><span class="section-number-4">1.1.1</span> 生成 Tensor</h4>
<div class="outline-text-4" id="text-1-1-1">
</div>
<div id="outline-container-orge3bb08a" class="outline-5">
<h5 id="orge3bb08a"><span class="section-number-5">1.1.1.1</span> constant</h5>
<div class="outline-text-5" id="text-1-1-1-1">
<div class="org-src-container">
<pre class="src src-ipython">import tensorflow as tf
import numpy as np

print(tf.constant(1))
print(tf.constant(1, dtype=tf.int64))
print(tf.constant(1.0))
print(tf.constant(1.0, dtype=tf.float64))
print(tf.constant(1.0, dtype=tf.double))
print(tf.constant("hello world"))
print(tf.constant(True))
print(tf.constant([1,2,3]))
print(tf.constant([1,2,3],dtype=tf.float32))
print(tf.constant([1,2,3,4],shape=(2,2),dtype=tf.float32))
print(tf.constant([[1,2],[3,4]]))
</pre>
</div>

<p>
tf.Tensor(1, shape=(), dtype=int32)
tf.Tensor(1, shape=(), dtype=int64)
tf.Tensor(1.0, shape=(), dtype=float32)
tf.Tensor(1.0, shape=(), dtype=float64)
tf.Tensor(1.0, shape=(), dtype=float64)
tf.Tensor(b'hello world', shape=(), dtype=string)
tf.Tensor(True, shape=(), dtype=bool)
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
tf.Tensor([1. 2. 3.], shape=(3,), dtype=float32)
tf.Tensor(
[[1. 2.]
 [3. 4.]], shape=(2, 2), dtype=float32)
tf.Tensor(
[[1 2]
 [3 4]], shape=(2, 2), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org43877bd" class="outline-5">
<h5 id="org43877bd"><span class="section-number-5">1.1.1.2</span> eye</h5>
<div class="outline-text-5" id="text-1-1-1-2">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.eye(3))
print(tf.eye(2, 3))
print(tf.eye(2, batch_shape=[1,2]))
</pre>
</div>

<p>
tf.Tensor(
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]], shape=(3, 3), dtype=float32)
tf.Tensor(
[[1. 0. 0.]
 [0. 1. 0.]], shape=(2, 3), dtype=float32)
tf.Tensor(
[[[[1. 0.]
   [0. 1.]]
</p>

<p>
[[1. 0.]
 [0. 1.]]]], shape=(1, 2, 2, 2), dtype=float32)
</p>
</div>
</div>

<div id="outline-container-org9d76516" class="outline-5">
<h5 id="org9d76516"><span class="section-number-5">1.1.1.3</span> fill/ones</h5>
<div class="outline-text-5" id="text-1-1-1-3">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.fill([2, 3], 9))
print(tf.ones([2, 3]))
print(tf.constant(9, shape=(2, 3)))
print(tf.convert_to_tensor(np.full([2,3], 9)))
</pre>
</div>

<p>
tf.Tensor(
[[9 9 9]
 [9 9 9]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[9 9 9]
 [9 9 9]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[9 9 9]
 [9 9 9]], shape=(2, 3), dtype=int64)
tf.Tensor(
[[1. 1. 1.]
 [1. 1. 1.]], shape=(2, 3), dtype=float32)
</p>
</div>
</div>

<div id="outline-container-orgceb5daf" class="outline-5">
<h5 id="orgceb5daf"><span class="section-number-5">1.1.1.4</span> gather</h5>
<div class="outline-text-5" id="text-1-1-1-4">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.gather(a, [0, 1]))

a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.gather(a, [0, 1], axis=1))
print(tf.gather(a, [1, 0], axis=0))
</pre>
</div>

<p>
tf.Tensor([1 2], shape=(2,), dtype=int32)
tf.Tensor(
[[1 2]
 [4 5]], shape=(2, 2), dtype=int32)
tf.Tensor(
[[4 5 6]
 [1 2 3]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgf56cb98" class="outline-5">
<h5 id="orgf56cb98"><span class="section-number-5">1.1.1.5</span> gather_nd</h5>
</div>

<div id="outline-container-orgc197511" class="outline-5">
<h5 id="orgc197511"><span class="section-number-5">1.1.1.6</span> identity/ones_like/zeros_like</h5>
<div class="outline-text-5" id="text-1-1-1-6">
<div class="org-src-container">
<pre class="src src-ipython"># 相当于 obj.clone
print(tf.identity([1, 2, 3]))
print(tf.ones_like([1, 2, 3]))
print(tf.zeros_like([1, 2, 3]))
</pre>
</div>

<p>
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
tf.Tensor([1 1 1], shape=(3,), dtype=int32)
tf.Tensor([0 0 0], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgd4f29d6" class="outline-5">
<h5 id="orgd4f29d6"><span class="section-number-5">1.1.1.7</span> linspace/range</h5>
<div class="outline-text-5" id="text-1-1-1-7">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.linspace(0., 9., 10))
print(tf.range(0, 10, 3))
</pre>
</div>

<p>
tf.Tensor([0. 1. 2. 3. 4. 5. 6. 7. 8. 9.], shape=(10,), dtype=float32)
tf.Tensor([0 3 6 9], shape=(4,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org9618e1b" class="outline-5">
<h5 id="org9618e1b"><span class="section-number-5">1.1.1.8</span> one_hot</h5>
<div class="outline-text-5" id="text-1-1-1-8">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 3, 2])
print(tf.one_hot(a, depth=4))
print(tf.one_hot(a, depth=4, on_value=10, off_value=1))
</pre>
</div>

<p>
tf.Tensor(
[[0. 1. 0. 0.]
 [0. 0. 0. 1.]
 [0. 0. 1. 0.]], shape=(3, 4), dtype=float32)
tf.Tensor(
[[ 1 10  1  1]
 [ 1  1  1 10]
 [ 1  1 10  1]], shape=(3, 4), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgc635486" class="outline-5">
<h5 id="orgc635486"><span class="section-number-5">1.1.1.9</span> repeat</h5>
<div class="outline-text-5" id="text-1-1-1-9">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.repeat(1, 3))
print(tf.repeat([1, 2, 3], [2, 2, 1]))
</pre>
</div>

<p>
tf.Tensor([1 1 1], shape=(3,), dtype=int32)
tf.Tensor([1 1 2 2 3], shape=(5,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org280bd6b" class="outline-5">
<h5 id="org280bd6b"><span class="section-number-5">1.1.1.10</span> random.{normal,uniform}</h5>
<div class="outline-text-5" id="text-1-1-1-10">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.random.normal([2, 2], mean = 0., stddev = 1.))
print(tf.random.uniform([2, 2], minval = 0., maxval = 1.))
print(tf.random.uniform([2, 2], minval = 0, maxval = 5, dtype = tf.int32))
</pre>
</div>

<p>
tf.Tensor(
[[ 0.51556325  0.5145032 ]
 [ 0.68966556 -0.48734504]], shape=(2, 2), dtype=float32)
tf.Tensor(
[[0.23802471 0.08910394]
 [0.7946955  0.00612378]], shape=(2, 2), dtype=float32)
tf.Tensor(
[[2 3]
 [0 4]], shape=(2, 2), dtype=int32)
</p>
</div>
</div>
</div>

<div id="outline-container-orgedd57cc" class="outline-4">
<h4 id="orgedd57cc"><span class="section-number-4">1.1.2</span> 类型转换</h4>
<div class="outline-text-4" id="text-1-1-2">
</div>
<div id="outline-container-orgdf05ffc" class="outline-5">
<h5 id="orgdf05ffc"><span class="section-number-5">1.1.2.1</span> cast</h5>
<div class="outline-text-5" id="text-1-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([0, 2, 3])
print(a)
print(tf.cast(a,tf.float32))
print(tf.cast(a,tf.bool))

a=tf.constant([0., 1., 2.])
print(tf.cast(a, tf.int32))
</pre>
</div>

<p>
tf.Tensor([0 2 3], shape=(3,), dtype=int32)
tf.Tensor([0. 2. 3.], shape=(3,), dtype=float32)
tf.Tensor([False  True  True], shape=(3,), dtype=bool)
tf.Tensor([0 1 2], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org14987b5" class="outline-5">
<h5 id="org14987b5"><span class="section-number-5">1.1.2.2</span> bitcast</h5>
<div class="outline-text-5" id="text-1-1-2-2">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([0, 1, 2], dtype=tf.int32)
print(a)
# 每个 int32 被转换为 [byte_0, byte_1, byte_2, byte_3]
print(tf.bitcast(a, tf.int8))
# int8 转换为 int32, 则 shape[-1] 需要等于 4, 因为 4 个 int8 才能当作一个 int32
a = tf.constant([0, 1, 0, 0], dtype=tf.int8)
print(tf.bitcast(a, tf.int32))
</pre>
</div>

<p>
tf.Tensor([0 1 2], shape=(3,), dtype=int32)
tf.Tensor(
[[0 0 0 0]
 [1 0 0 0]
 [2 0 0 0]], shape=(3, 4), dtype=int8)
tf.Tensor(256, shape=(), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org8def659" class="outline-5">
<h5 id="org8def659"><span class="section-number-5">1.1.2.3</span> convert_to_tensor</h5>
<div class="outline-text-5" id="text-1-1-2-3">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.convert_to_tensor(1))
print(tf.convert_to_tensor([1,2,3]))
print(tf.convert_to_tensor(np.array([1,2,3])))
print(tf.convert_to_tensor(tf.constant([1, 2, 3]).numpy()))
</pre>
</div>

<p>
tf.Tensor(1, shape=(), dtype=int32)
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
tf.Tensor([1 2 3], shape=(3,), dtype=int64)
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgc052074" class="outline-5">
<h5 id="orgc052074"><span class="section-number-5">1.1.2.4</span> is_tensor</h5>
<div class="outline-text-5" id="text-1-1-2-4">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.is_tensor(1))
print(tf.is_tensor("hello"))
print(tf.is_tensor([1, 2, 3]))
print(tf.is_tensor(np.array([1, 2, 3])))
print(tf.is_tensor(tf.convert_to_tensor([1, 2, 3])))
print(tf.is_tensor(tf.constant(1)))
</pre>
</div>

<p>
False
False
False
False
True
True
</p>
</div>
</div>
</div>

<div id="outline-container-org22f94f4" class="outline-4">
<h4 id="org22f94f4"><span class="section-number-4">1.1.3</span> 操作大小</h4>
<div class="outline-text-4" id="text-1-1-3">
</div>
<div id="outline-container-orge13b753" class="outline-5">
<h5 id="orge13b753"><span class="section-number-5">1.1.3.1</span> broadcast_to</h5>
<div class="outline-text-5" id="text-1-1-3-1">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.broadcast_to(a, (2, 3)))

# (x0,x1,x2) 能 broadcast_to (y0,y1,y2) 的条件是 x[i] == 1 或 x[i] == y[i]
# 所以下面的函数会失败, (2,3) 无法 broadcast_to (4,3)
# a = tf.constant([[1, 2, 3], [4, 5, 6]])
# print(tf.broadcast_to(a, (4, 3)))
</pre>
</div>

<p>
tf.Tensor(
[[1 2 3]
 [1 2 3]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org7f519d0" class="outline-5">
<h5 id="org7f519d0"><span class="section-number-5">1.1.3.2</span> concat</h5>
<div class="outline-text-5" id="text-1-1-3-2">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3]])
b = tf.constant([[4, 5, 6]])
# concat 没有默认的 axis
print(tf.concat([a, b],axis=0))
print(tf.concat([a, b],axis=1))
</pre>
</div>

<p>
tf.Tensor(
[[1 2 3]
 [4 5 6]], shape=(2, 3), dtype=int32)
tf.Tensor(, shape=(1, 6), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org2ff4951" class="outline-5">
<h5 id="org2ff4951"><span class="section-number-5">1.1.3.3</span> ensure_shape</h5>
<div class="outline-text-5" id="text-1-1-3-3">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.ensure_shape(tf.constant([1, 2, 3, 4]), (4,)))
print(tf.ensure_shape(tf.constant([[1, 2, 3, 4],[1, 2, 3, 4]]), (None, 4)))
</pre>
</div>

<p>
tf.Tensor([1 2 3 4], shape=(4,), dtype=int32)
tf.Tensor(
[[1 2 3 4]
 [1 2 3 4]], shape=(2, 4), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org3970957" class="outline-5">
<h5 id="org3970957"><span class="section-number-5">1.1.3.4</span> expand_dims</h5>
<div class="outline-text-5" id="text-1-1-3-4">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(a.shape)
b = tf.expand_dims(a, 0)
print(b.shape)
b = tf.expand_dims(b, -1)
print(b.shape)
</pre>
</div>

<p>
(3,)
(1, 3)
(1, 3, 1)
</p>
</div>
</div>

<div id="outline-container-org9639837" class="outline-5">
<h5 id="org9639837"><span class="section-number-5">1.1.3.5</span> squeeze</h5>
<div class="outline-text-5" id="text-1-1-3-5">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3]])
print(tf.squeeze(a).shape)

# squeeze 默认会删掉所有 size=1 的 dimension
a = tf.expand_dims(tf.expand_dims([1, 2, 3],0), 2)
print(a.shape)
print(tf.squeeze(a).shape)

# 通过一个 list 参数可以指定去掉哪个 size=1 的 dimension
a = tf.expand_dims(tf.expand_dims([1, 2, 3],0), 2)
print(a.shape)
print(tf.squeeze(a, [0]).shape)
</pre>
</div>

<p>
(3,)
(1, 3, 1)
(3,)
(1, 3, 1)
(3, 1)
</p>
</div>
</div>

<div id="outline-container-orge8b6fe8" class="outline-5">
<h5 id="orge8b6fe8"><span class="section-number-5">1.1.3.6</span> reshape</h5>
</div>

<div id="outline-container-orga770d0e" class="outline-5">
<h5 id="orga770d0e"><span class="section-number-5">1.1.3.7</span> shape/size/rank</h5>
<div class="outline-text-5" id="text-1-1-3-7">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(a.shape)
print(tf.shape(a))
print(tf.size(a))
print(tf.rank(a))
</pre>
</div>

<p>
(2, 3)
tf.Tensor([2 3], shape=(2,), dtype=int32)
tf.Tensor(6, shape=(), dtype=int32)
tf.Tensor(2, shape=(), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgc3a18d2" class="outline-5">
<h5 id="orgc3a18d2"><span class="section-number-5">1.1.3.8</span> slice</h5>
<div class="outline-text-5" id="text-1-1-3-8">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
# tf.sliace(a,[f0,f1],[s0,s1]) == a[f0:f0+s0, f1:f1+s1]
print(tf.slice(a, [0, 1], [1, 2]))
print(a[0:1, 1:3])
</pre>
</div>

<p>
tf.Tensor(, shape=(1, 2), dtype=int32)
tf.Tensor(, shape=(1, 2), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgc5053c0" class="outline-5">
<h5 id="orgc5053c0"><span class="section-number-5">1.1.3.9</span> pad</h5>
<div class="outline-text-5" id="text-1-1-3-9">
<p>
paddings 是一个 (N,2) 的矩阵, 原矩阵的的第 n 维会被扩展为 P[n,0]+ ORIGIN + P[n,1]
</p>

<div class="org-src-container">
<pre class="src src-ipython">a = tf.ones((2, 3))
print(a)
print(tf.pad(a, paddings=[[1, 2], [1, 1]]))
</pre>
</div>

<p>
tf.Tensor(
[[1. 1. 1.]
 [1. 1. 1.]], shape=(2, 3), dtype=float32)
tf.Tensor(
[[0. 0. 0. 0. 0.]
 [0. 1. 1. 1. 0.]
 [0. 1. 1. 1. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]], shape=(5, 5), dtype=float32)
</p>
</div>
</div>

<div id="outline-container-orgc4f04e5" class="outline-5">
<h5 id="orgc4f04e5"><span class="section-number-5">1.1.3.10</span> split</h5>
<div class="outline-text-5" id="text-1-1-3-10">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3, 4], [5, 6, 7, 8]])
print(tf.split(a, 2, axis=1))

# a 的 shape 不能被平均的 split 时会失败
# a = tf.constant([1, 2, 3])
# print(tf.split(a, 2))
</pre>
</div>

<p>
[&lt;tf.Tensor: shape=(2, 2), dtype=int32, numpy=
array([[1, 2],
       [5, 6]], dtype=int32)&gt;, &lt;tf.Tensor: shape=(2, 2), dtype=int32, numpy=
array([[3, 4],
       [7, 8]], dtype=int32)&gt;]
</p>
</div>
</div>

<div id="outline-container-org4902f61" class="outline-5">
<h5 id="org4902f61"><span class="section-number-5">1.1.3.11</span> stack/unstack</h5>
<div class="outline-text-5" id="text-1-1-3-11">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
b = tf.constant([4, 5, 6])
print(tf.stack([a,b]))

# stack 与 concat 有显著的区别:
# stack 会创造新的一维, 而 concat 会在某一维上合并数据
a = tf.constant([[1, 2, 3]])
b = tf.constant([[4, 5, 6]])
print(tf.stack([a,b], axis=0))
print(tf.stack([a,b], axis=1))
print(tf.concat([a, b], axis=0))
print(tf.concat([a, b], axis=1))
</pre>
</div>

<p>
tf.Tensor(
[[1 2 3]
 [4 5 6]], shape=(2, 3), dtype=int32)
tf.Tensor(
[
</p>

<p>
 ], shape=(2, 1, 3), dtype=int32)
tf.Tensor(
[[[1 2 3]
  [4 5 6]]], shape=(1, 2, 3), dtype=int32)
tf.Tensor(
[[1 2 3]
 [4 5 6]], shape=(2, 3), dtype=int32)
tf.Tensor(, shape=(1, 6), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org423c6fe" class="outline-5">
<h5 id="org423c6fe"><span class="section-number-5">1.1.3.12</span> tile</h5>
<div class="outline-text-5" id="text-1-1-3-12">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.tile(a, [2, 2]))
</pre>
</div>

<p>
tf.Tensor(
[[1 2 3 1 2 3]
 [4 5 6 4 5 6]
 [1 2 3 1 2 3]
 [4 5 6 4 5 6]], shape=(4, 6), dtype=int32)
</p>
</div>
</div>
</div>

<div id="outline-container-org43af797" class="outline-4">
<h4 id="org43af797"><span class="section-number-4">1.1.4</span> 运算</h4>
<div class="outline-text-4" id="text-1-1-4">
</div>
<div id="outline-container-org2623b80" class="outline-5">
<h5 id="org2623b80"><span class="section-number-5">1.1.4.1</span> equal/greater/less/greater_equal/less_equal</h5>
<div class="outline-text-5" id="text-1-1-4-1">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.equal(
    tf.constant([[1, 2, 3], [1, 2, 3]]),
    tf.constant([[1, 2, 3], [1, 2, 3]])))
# broadcast
print(tf.equal(
    tf.constant([[1, 2, 3], [1, 2, 3]]),
    tf.constant([[1, 2, 3]])))
</pre>
</div>

<p>
tf.Tensor(
[[ True  True  True]
 [ True  True  True]], shape=(2, 3), dtype=bool)
tf.Tensor(
[[ True  True  True]
 [ True  True  True]], shape=(2, 3), dtype=bool)
</p>
</div>
</div>

<div id="outline-container-orgfa8d164" class="outline-5">
<h5 id="orgfa8d164"><span class="section-number-5">1.1.4.2</span> abs/negative</h5>
<div class="outline-text-5" id="text-1-1-4-2">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.abs(tf.constant([-1,0,1])))
</pre>
</div>

<p>
tf.Tensor([1 0 1], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org03f5c6a" class="outline-5">
<h5 id="org03f5c6a"><span class="section-number-5">1.1.4.3</span> add/substract/multiply/divide/pow</h5>
<div class="outline-text-5" id="text-1-1-4-3">
<div class="org-src-container">
<pre class="src src-ipython">print("=== add")
a = tf.constant([1, 2])
print(tf.add(a, a))
print(a + a)
print(a + 1)
print(tf.add_n([a, a, a]))

# broadcast
print(tf.add(tf.constant([1, 2, 3]), tf.constant([[1, 1, 1], [1, 1, 1]])))

print("=== subtract")
a = tf.constant([1,2,3])
b = tf.constant([0, 1, 2])
print(tf.subtract(a, b))
print(a - b)

print("=== divide")
a = tf.constant([1, 2, 3])
b = tf.constant([1, 2, 3])
print(tf.divide(a, b))
print(a / b)
print(a / 2)
# broadcast
print(tf.constant([[1, 2, 3], [4, 5, 6]]) / tf.constant([1, 2, 3]))
</pre>
</div>

<p>
<code>=</code> add
tf.Tensor([2 4], shape=(2,), dtype=int32)
tf.Tensor([2 4], shape=(2,), dtype=int32)
tf.Tensor([2 3], shape=(2,), dtype=int32)
tf.Tensor([3 6], shape=(2,), dtype=int32)
tf.Tensor(
[[2 3 4]
 [2 3 4]], shape=(2, 3), dtype=int32)
<code>=</code> subtract
tf.Tensor([1 1 1], shape=(3,), dtype=int32)
tf.Tensor([1 1 1], shape=(3,), dtype=int32)
<code>=</code> divide
tf.Tensor([1. 1. 1.], shape=(3,), dtype=float64)
tf.Tensor([1. 1. 1.], shape=(3,), dtype=float64)
tf.Tensor([0.5 1.  1.5], shape=(3,), dtype=float64)
tf.Tensor(
[[1.  1.  1. ]
 [4.  2.5 2. ]], shape=(2, 3), dtype=float64)
</p>
</div>
</div>

<div id="outline-container-org8949bb4" class="outline-5">
<h5 id="org8949bb4"><span class="section-number-5">1.1.4.4</span> argmin/argmax</h5>
<div class="outline-text-5" id="text-1-1-4-4">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.argmax([1, 2, 3]))
a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(a.shape)
print(tf.argmax(a))
print(tf.argmax(a,axis=0))
print(tf.argmax(a,axis=1))
</pre>
</div>

<p>
tf.Tensor(2, shape=(), dtype=int64)
(2, 3)
tf.Tensor([1 1 1], shape=(3,), dtype=int64)
tf.Tensor([1 1 1], shape=(3,), dtype=int64)
tf.Tensor([2 2], shape=(2,), dtype=int64)
</p>
</div>
</div>

<div id="outline-container-org398dd57" class="outline-5">
<h5 id="org398dd57"><span class="section-number-5">1.1.4.5</span> clip_by_value</h5>
<div class="outline-text-5" id="text-1-1-4-5">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.clip_by_value(a, 1, 2))
# min, max 可以是一个 shape 为 a.shape 的 tensor
print(tf.clip_by_value(a, [1, 2, 3], 3))
#或者可以 broadcast_to (a) 
print(tf.clip_by_value(a, [1], 3))
</pre>
</div>

<p>
tf.Tensor([1 2 2], shape=(3,), dtype=int32)
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
tf.Tensor([1 2 3], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org83e35da" class="outline-5">
<h5 id="org83e35da"><span class="section-number-5">1.1.4.6</span> argsort/sort</h5>
<div class="outline-text-5" id="text-1-1-4-6">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([3, 2, 1])
print(tf.argsort (a))
print(tf.argsort(a, direction="DESCENDING"))

a = tf.constant([[3, 2, 1], [1, 2, 3]])
print(tf.argsort (a))
# argsort 默认的 axis 是 -1 而不是 0
print(tf.argsort (a, axis=-1))
print(tf.argsort (a, axis=0))


a = tf.constant([[3, 2, 1], [1, 2, 3]])
print(tf.sort(a))
</pre>
</div>

<p>
tf.Tensor([2 1 0], shape=(3,), dtype=int32)
tf.Tensor([0 1 2], shape=(3,), dtype=int32)
tf.Tensor(
[[2 1 0]
 [0 1 2]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[2 1 0]
 [0 1 2]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[1 0 0]
 [0 1 1]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[1 2 3]
 [1 2 3]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org73c6d41" class="outline-5">
<h5 id="org73c6d41"><span class="section-number-5">1.1.4.7</span> cumsum</h5>
<div class="outline-text-5" id="text-1-1-4-7">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.cumsum(a))
print(tf.cumsum(a, axis=1))
</pre>
</div>

<p>
tf.Tensor(
[[1 2 3]
 [5 7 9]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[ 1  3  6]
 [ 4  9 15]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org7ae74de" class="outline-5">
<h5 id="org7ae74de"><span class="section-number-5">1.1.4.8</span> floor/round</h5>
<div class="outline-text-5" id="text-1-1-4-8">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.floor([1.1, 2.1, 3.1]))
</pre>
</div>

<p>
tf.Tensor([1. 2. 3.], shape=(3,), dtype=float32)
</p>
</div>
</div>

<div id="outline-container-org2140d83" class="outline-5">
<h5 id="org2140d83"><span class="section-number-5">1.1.4.9</span> dynamic_partition</h5>
<div class="outline-text-5" id="text-1-1-4-9">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3, 4])
p = tf.constant([0, 1, 0, 1])
print(tf.dynamic_partition(a, p, 2))

# dynamic_partition 返回 n 个向量, 不论 a 在 shape 是什么
a = tf.constant([[1, 2, 3, 4], [5, 6, 7, 8]])
p = tf.constant([[0, 1, 0, 1], [0, 1, 0, 1]])
print(tf.dynamic_partition(a, p, 2))
</pre>
</div>

<p>
[&lt;tf.Tensor: shape=(2,), dtype=int32, numpy=array([1, 3], dtype=int32)&gt;, &lt;tf.Tensor: shape=(2,), dtype=int32, numpy=array([2, 4], dtype=int32)&gt;]
[&lt;tf.Tensor: shape=(4,), dtype=int32, numpy=array([1, 3, 5, 7], dtype=int32)&gt;, &lt;tf.Tensor: shape=(4,), dtype=int32, numpy=array([2, 4, 6, 8], dtype=int32)&gt;]
</p>
</div>
</div>

<div id="outline-container-orgd359386" class="outline-5">
<h5 id="orgd359386"><span class="section-number-5">1.1.4.10</span> dynamic_stitch</h5>
<div class="outline-text-5" id="text-1-1-4-10">
</div>
</div>

<div id="outline-container-org5e7e6c8" class="outline-5">
<h5 id="org5e7e6c8"><span class="section-number-5">1.1.4.11</span> logical_and/logical_or/logical_not</h5>
</div>

<div id="outline-container-orgde0a8c2" class="outline-5">
<h5 id="orgde0a8c2"><span class="section-number-5">1.1.4.12</span> matmul</h5>
<div class="outline-text-5" id="text-1-1-4-12">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3]])
b = tf.constant([[1, 2, 3]])
print(tf.matmul(a, b, transpose_b=True))

# broadcast
a = tf.constant([[1, 2, 3], [1, 2, 3]])
b = tf.constant([[1], [2], [3]])
print(tf.matmul(a, b))

print(a @ b)
</pre>
</div>

<p>
tf.Tensor(, shape=(1, 1), dtype=int32)
tf.Tensor(
[[14]
 [14]], shape=(2, 1), dtype=int32)
tf.Tensor(
[[14]
 [14]], shape=(2, 1), dtype=int32)
</p>
</div>
</div>


<div id="outline-container-org4bd36f1" class="outline-5">
<h5 id="org4bd36f1"><span class="section-number-5">1.1.4.13</span> maximum/minimum</h5>
</div>

<div id="outline-container-orgf416427" class="outline-5">
<h5 id="orgf416427"><span class="section-number-5">1.1.4.14</span> norm</h5>
</div>

<div id="outline-container-orgd8a69d9" class="outline-5">
<h5 id="orgd8a69d9"><span class="section-number-5">1.1.4.15</span> reduce<sub>all,any,max,min,mean,prod,sum</sub></h5>
<div class="outline-text-5" id="text-1-1-4-15">
<div class="org-src-container">
<pre class="src src-ipython">print("=== reduce_all")
print(tf.reduce_all(tf.constant([True, True, False])))
a = tf.constant([[True, True], [False, False]])
print(tf.reduce_all(a))
print(tf.reduce_all(a, axis=0))
print(tf.reduce_all(a, axis=1))
print("=== reduce_sum")
print(tf.reduce_sum(tf.constant([1, 2, 3])))
</pre>
</div>

<p>
<code>=</code> reduce_all
tf.Tensor(False, shape=(), dtype=bool)
tf.Tensor(False, shape=(), dtype=bool)
tf.Tensor([False False], shape=(2,), dtype=bool)
tf.Tensor([ True False], shape=(2,), dtype=bool)
<code>=</code> reduce_sum
tf.Tensor(6, shape=(), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgd552f5a" class="outline-5">
<h5 id="orgd552f5a"><span class="section-number-5">1.1.4.16</span> reverse</h5>
<div class="outline-text-5" id="text-1-1-4-16">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.reverse(a, axis=[0]))
print(tf.reverse(a, axis=[0, 1]))
</pre>
</div>

<p>
tf.Tensor(
[[4 5 6]
 [1 2 3]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[6 5 4]
 [3 2 1]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-org993e793" class="outline-5">
<h5 id="org993e793"><span class="section-number-5">1.1.4.17</span> roll</h5>
<div class="outline-text-5" id="text-1-1-4-17">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.roll(a, shift=2, axis=0))

a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.roll(a, shift=[1, 2], axis=[0, 1]))
</pre>
</div>

<p>
tf.Tensor([2 3 1], shape=(3,), dtype=int32)
tf.Tensor(
[[5 6 4]
 [2 3 1]], shape=(2, 3), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orga1e619c" class="outline-5">
<h5 id="orga1e619c"><span class="section-number-5">1.1.4.18</span> sigmoid</h5>
</div>

<div id="outline-container-orgc14d31f" class="outline-5">
<h5 id="orgc14d31f"><span class="section-number-5">1.1.4.19</span> transpose</h5>
<div class="outline-text-5" id="text-1-1-4-19">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([[1, 2, 3], [4, 5, 6]])
print(tf.transpose(a))
print(tf.transpose(a, [1, 0]))
print(tf.transpose(a, [0, 1]))

a = tf.constant([[[ 1,  2,  3],
                  [ 4,  5,  6]],
                 [[ 7,  8,  9],
                  [10, 11, 12]]])

print(tf.transpose(a, [0, 2, 1]))
</pre>
</div>

<p>
tf.Tensor(
[[1 4]
 [2 5]
 [3 6]], shape=(3, 2), dtype=int32)
tf.Tensor(
[[1 4]
 [2 5]
 [3 6]], shape=(3, 2), dtype=int32)
tf.Tensor(
[[1 2 3]
 [4 5 6]], shape=(2, 3), dtype=int32)
tf.Tensor(
[[[ 1  4]
  [ 2  5]
  [ 3  6]]
</p>

<p>
[[ 7 10]
 [ 8 11]
 [ 9 12]]], shape=(2, 3, 2), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgcd04414" class="outline-5">
<h5 id="orgcd04414"><span class="section-number-5">1.1.4.20</span> truncatemod/truncatediv</h5>
<div class="outline-text-5" id="text-1-1-4-20">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.truncatemod(a, 3))
</pre>
</div>

<p>
tf.Tensor([1 2 0], shape=(3,), dtype=int32)
</p>
</div>
</div>

<div id="outline-container-orgbc98492" class="outline-5">
<h5 id="orgbc98492"><span class="section-number-5">1.1.4.21</span> unique/unique_with_counts</h5>
<div class="outline-text-5" id="text-1-1-4-21">
<div class="org-src-container">
<pre class="src src-ipython">print(tf.unique([1, 2, 3, 1]))
# unique 只能用于 1-d tensor
# print(tf.unique([[1, 2, 3, 1]]))
</pre>
</div>

<p>
Unique(y=&lt;tf.Tensor: shape=(3,), dtype=int32, numpy=array([1, 2, 3], dtype=int32)&gt;, idx=&lt;tf.Tensor: shape=(4,), dtype=int32, numpy=array([0, 1, 2, 0], dtype=int32)&gt;)
</p>
</div>
</div>


<div id="outline-container-org5b40097" class="outline-5">
<h5 id="org5b40097"><span class="section-number-5">1.1.4.22</span> map_fn</h5>
<div class="outline-text-5" id="text-1-1-4-22">
<div class="org-src-container">
<pre class="src src-ipython">a = tf.constant([1, 2, 3])
print(tf.map_fn(lambda x: x + 1, a))
</pre>
</div>

<p>
tf.Tensor([2 3 4], shape=(3,), dtype=int32)
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org2cffb57" class="outline-3">
<h3 id="org2cffb57"><span class="section-number-3">1.2</span> 高阶 API</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orga6fd71a" class="outline-4">
<h4 id="orga6fd71a"><span class="section-number-4">1.2.1</span> tf.summary</h4>
</div>

<div id="outline-container-org5ccf6c2" class="outline-4">
<h4 id="org5ccf6c2"><span class="section-number-4">1.2.2</span> tf.feature_column</h4>
</div>

<div id="outline-container-orgd0215cf" class="outline-4">
<h4 id="orgd0215cf"><span class="section-number-4">1.2.3</span> tf.keras.losses</h4>
</div>

<div id="outline-container-orgaec2982" class="outline-4">
<h4 id="orgaec2982"><span class="section-number-4">1.2.4</span> tf.keras.metrics</h4>
</div>

<div id="outline-container-org0246425" class="outline-4">
<h4 id="org0246425"><span class="section-number-4">1.2.5</span> tf.keras.callbacks</h4>
</div>

<div id="outline-container-org0aa5ed2" class="outline-4">
<h4 id="org0aa5ed2"><span class="section-number-4">1.2.6</span> tf.keras.models</h4>
</div>

<div id="outline-container-org94b7489" class="outline-4">
<h4 id="org94b7489"><span class="section-number-4">1.2.7</span> tf.keras.optimizers</h4>
</div>

<div id="outline-container-org4d7a3d2" class="outline-4">
<h4 id="org4d7a3d2"><span class="section-number-4">1.2.8</span> tf.keras.initializers</h4>
</div>

<div id="outline-container-org65565ef" class="outline-4">
<h4 id="org65565ef"><span class="section-number-4">1.2.9</span> tf.keras.regularizers</h4>
</div>

<div id="outline-container-orga42e232" class="outline-4">
<h4 id="orga42e232"><span class="section-number-4">1.2.10</span> tf.nn</h4>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<p class="author">Author: sunway (sunwayforever@gmail.com)<br />
Date: 2020-07-21 Tue 00:00<br />
Last updated: 2021-10-09 Sat 12:48</p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
<br />

<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
         var d = document, s = d.createElement('script');
         s.src = '//sunwayforever-github-io.disqus.com/embed.js';
         s.setAttribute('data-timestamp', +new Date());
         (d.head || d.body).appendChild(s);
         })();
</script>
</div>
</body>
</html>
